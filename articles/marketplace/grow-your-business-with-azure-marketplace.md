---
title: 市场的市场推广权益 | Azure
description: 适用于应用和服务发布者的 Azure 市场和 AppSource 的 GTM 权益
services: Azure, Marketplace, Compute, Storage, Networking, Blockchain, Security
documentationcenter: ''
author: ellacroi
manager: nunoc
editor: ''
ms.assetid: ''
ms.service: marketplace
ms.workload: ''
ms.tgt_pltfrm: ''
ms.devlang: ''
ms.topic: article
ms.date: 07/05/2018
ms.author: ellacroi
ms.openlocfilehash: f1616f7a20fdd55b98b3bfb37973a783997e2eb0
ms.sourcegitcommit: 727a0d5b3301fe20f20b7de698e5225633191b06
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/19/2018
ms.locfileid: "39145234"
---
# <a name="grow-your-business-on-marketplace"></a>在市场中扩展业务 
在 AppSource 或 Azure 市场中发布产品/服务后，可将列表用作与 Microsoft 联合开展市场推广 (GTM) 活动的启动平台。 例如，把流量引向自己的市场产品/服务及培养市场潜在顾客就是加速业务增长的好方法。 在本文中，我们将分享许多帮助在市场中扩展业务的市场营销最佳做法。

## <a name="app-listing-best-practices"></a>应用列表最佳做法

下表提供有关打造具有吸引力的市场产品/服务的建议。 你将使用[云合作伙伴门户](https://cloudpartner.azure.com/#insights)编写和配置这些市场营销材料。 


### <a name="offer-identity"></a>产品/服务标识

### <a name="storefront-details--offer-details"></a>店面详细信息 > 产品/服务详细信息
| 店面设置 | 最佳实践 |
|:--- |:--- |  
| 产品名称 | 提供强有力的标题：<br />应用名称应传达客户可收获的核心价值。 此外，在应用标题中包含搜索关键字可帮助应用在搜索引擎结果中获得更高排名。<br /> <br />咨询服务列表应遵循固定的标题格式：[产品/服务名称]：[持续时间][产品/服务类型]，例如，“Contoso：2 周实施”<br /> <br />遵循品牌指南：<br />引用 Microsoft 商标以及 Microsoft 软件、产品和服务的名称时，请遵循《Microsoft 商标和品牌指南》以及相关的产品特定指南。<br />有关 Microsoft 商标和品牌的详细信息，请访问 [Microsoft 商标和品牌指南页面](https://www.microsoft.com/legal/intellectualproperty/trademarks/usage/general.aspx)。 |
| 产品/服务描述 | 提供适当的产品/服务描述<br />在前几句描述中清晰描述产品/服务的价值主张。 请牢记，前几句话可能在搜索引擎结果中显示。 不要依赖于特性和功能来销售产品。 而应该强调提供的价值。 尽可能多使用行业特定用语或基于优势的措辞。<br />核心价值主张应包含以下信息：<br /> - 产品的描述<br /> - 将受益的用户的类型<br /> - 产品可满足的客户需求或解决的难题 |

### <a name="storefront-details--listing-details"></a>店面详细信息 > 列表详细信息
| 店面设置 | 最佳实践 |
|:--- |:--- |  
| 行业：仅限 AppSource 应用和咨询服务 | 如果产品/服务可满足行业特定需求，请选择相关行业。 确保在产品/服务描述中突出强调这些行业特定功能。<br /> <br />注意：最大选项数因产品/服务类型而异并会在云合作伙伴门户中指明。 |
| 类别 | 选择与产品/服务最相关的类别。 请认真选择类别，因为客户会使用这些类别搜索相关应用。 确保在产品/服务描述中突出强调你的产品/服务如何满足特定类别的需求。<br /> <br /> 注意：最大选项数因产品/服务类型而异并会在云合作伙伴门户中指明。 |
| 可与应用配合使用的产品（最多 3 个）：仅限 AppSource 应用 | 列出解决方案使用或扩展的其他产品和技术，例如 Azure IoT 中心、Azure 机器学习工作室等。 |
| 搜索关键字（最多 3 个） | 搜索关键字可帮助业务用户在 Azure 市场和 AppSource 中搜索或使用搜索引擎时找到你的产品/服务。 确定产品/服务的 3 个首要搜索关键字；将搜索关键字包含在产品/服务摘要和描述中；并在此处列出搜索关键字。 |

### <a name="storefront-details--marketing-artifacts"></a>店面详细信息 > 市场营销项目
| 店面设置 | 最佳实践 |
|:--- |:--- |  
| 产品/服务徽标（.png 格式，48 x 48） | 徽标应面向数字媒体进行设计和优化。 在产品/服务的搜索页面以 PNG 格式上传徽标。 |
| 产品/服务徽标（.png 格式， 216 x 216） | 徽标应面向数字媒体进行设计和优化。 在产品/服务的应用详细信息列表页面以 PNG 格式上传徽标。 |
| 了解详细信息/文档 | 在“了解详细信息”下包含用于提供支持的销售和市场营销资产，例如，白皮书、手册、清单和 PowerPoint 文档等。所有文件都应采用 PDF 格式。 这些文档的目标应该是教育客户，而不是销售产品/服务。<br /> <br />将应用登陆页面的链接添加到所有文档，并添加 URL 参数来跟踪访问量和试用量。 |
| 视频：仅限 AppSource、咨询服务和 SaaS 产品/服务 | 最强大的视频能够以叙事形式传达产品/服务的价值。 让客户成为故事的主角，而不是你的公司。 视频应提到目标客户所面临的主要挑战及其目标。<br /> <br />建议长度：60-90 秒。<br /> <br />在视频名称中包含搜索关键字。<br /> <br />请考虑添加其他视频，例如操作说明视频、入门视频或客户褒奖视频。 |
| 屏幕截图 (1280 x 720) | 最多添加 5 张屏幕截图；在名称中包含搜索关键字。 |

## <a name="marketing-best-practices"></a>市场营销最佳做法 

为了让你最大限度地享受加入市场列表的好处，我们收集了以下在 AppSource 和 Azure 市场中营销产品/服务的最佳做法。 首先，请务必查看 Microsoft 合作伙伴网络 (MPN) 上的市场营销最佳做法和资源。 这是获取与 Microsoft 合作相关的所有市场营销和编程资源的通道。<br /> <br />此外，提高市场中产品/服务的质量以及在发掘需求时坚持以客户为中心都有助于推动业务增长。 参与这些活动可帮助 Microsoft 强化市场推广工作的效果，并在众多市场店面力推关键解决方案。<br /> <br />创建出色的列表后，以下市场营销计划可帮助扩展业务：

*   形成强有力的价值主张。<br />确定潜在客户是谁以及解决方案的主要差异化因素是什么。

*   在网站上打造独特的登陆页面，让你的应用列表脱颖而出。<br />从这里把流量引向产品/服务，留下良好的第一印象。 客户将基于产品/服务列表决定是否要深入了解并试用你的解决方案。

*   启用体验版或提供其他试用体验。<br />用户希望直接体验你的应用。 从过往经验来看，发布者可从提供体验版或试用版的列表获得更高的潜在顾客转换率。

*   优化列表以帮助提升搜索引擎排名。<br />在应用名称、摘要和列表中包含搜索关键字，并在 3 个首要搜索关键字中包含这些搜索关键字。 

*   启用潜在顾客共享。<br />客户试用你的应用时，可直接在 CRM 系统中接收用户的联系信息。 请确保具备适当流程来跟进潜在顾客。

*   制定需求发掘计划。<br />使用市场产品/服务列表作为市场营销行动号召的登陆页面。 在启用了潜在顾客共享的情况下，只要客户通过产品/服务的市场列表试用、体验或部署你的产品/服务，你就会收到他们的姓名和联系信息。

*   在 AppSource 和/或 Azure 市场中推广你的应用。<br />链接到应用列表，并在每次链接到应用时使用 URL 标记。

*   创建市场营销活动和推广营销活动。<br />借助将流量引向市场列表的明确行动号召，计划并构建提高认知度和参与度的营销活动。

*   获取客户反馈。<br />提醒客户提交评分和评论。 开始试用后，客户将收到提示分享试用体验的电子邮件。

*   获取可操作的见解。<br />查看[云合作伙伴门户](https://cloudpartner.azure.com/#insights)中的“见解”仪表板。 跟踪应用列表的访问量和试用量。 了解营销活动效果和哪些内容效果最佳的相关详细信息。

*   使用市场推广服务权益。<br />充分利用我们的市场推广服务。 [详细了解](https://partner.microsoft.com/reach-customers/gtm) Microsoft 合作伙伴网络 (MPN) 提供的权益。

## <a name="build-an-effective-marketing-campaign"></a>构建有效的市场营销活动

市场营销活动是一系列促销活动或市场营销策略，旨在促使目标受众的行为达到预期目标和效果。 在设计营销活动前，请考虑以下最佳做法：

### <a name="know-your-audience"></a>了解受众
首先，确定实际购买者与购买影响者。 他们可能是组织内的不同人群，针对每个群体的策略和行动号召可能会有所不同。 思考以下评估问题，帮助自己更好地了解目标受众：

*   购买者对购买决策有多少控制力？
*   影响者具备多大影响力？
*   影响者影响什么？
*   他们是否影响预算或解决方案的选择？

弄清楚这些问题的答案有助于制定有关销售和市场营销资源分配的决策。

### <a name="define-where-your-audience-learns"></a>定义受众获取信息的位置
如今的典型客户在访问市场时就已经完成了大部分的购买旅程。 购买者通过提前了解解决方案的内容并评估相关选项，走到了制定决策这一步。 设计营销活动时，应将目标设为让购买者和影响者在考虑购买前了解解决方案的内容。<br /> <br />每个行业、纵向市场或类别中的目标受众都是不同的。 你的目标受众是通过在线资源、电子邮件、展览会、社交媒体还是通过受信任的顾问了解产品？ 应根据受众的了解途径来设计活动，并合理分配自己的市场营销资金。 这些策略的组合会成为你最终的活动策略。

### <a name="create-clear-campaign-goals"></a>创建清晰的活动目标
应定义市场营销活动的目标，并创建明晰的关键绩效指标 (KPI)。 当然，可能会开展最终目标不同的多个营销活动。 终极最终目标通常是增加收入或获取客户；但是，可以在购买周期的其他阶段中将市场营销活动与目标挂钩。 以下是一些示例： 

*   你刚刚在市场上推出了你的产品。 在这种情况下，你可能会发现最值得将市场营销资源投在目标受众教育和潜在顾客生成方面。 是否成功实现目标可以通过从市场商品信息产生的潜在顾客数量来衡量。 在这种情况下，市场营销策略（和登陆页面）应侧重于吸引客户访问市场列表。
*   你在市场中提供试用版，并且你的产品要求拥有一定的参与度和经验才能购买。 请思考营销活动的试用版下载次数目标。 在这种情况下，营销策略的行动号召会专注于鼓励市场中的试用行为。
*   你的产品或类别众所周知，并且你在市场中设置了购买功能。 考虑跳过试用行动号召并将目标受众引至你在市场中的“立即获取”链接。
*   你的产品/服务已成规模并已成熟。 考虑将营销工作的重点放在对客户群进行追加销售并推动提升市场购买量的行动上。 你传达的讯息将专注于鼓励客户通过市场购买。 KPI 可以是通过市场产生的收入。

不管产品/服务的成熟度以及组织的目标如何，若要最大程度地提高营销活动有效性，下面这些因素都很关键：
*   保持对目标的专注
*   根据此目标制定一组综合的市场营销策略

作为面向市场中新发布者提供的支持的一部分，Microsoft 会提供一些免费的市场推广权益。 应谨慎思考如何在活动策略中利用这些优势。 将你的市场活动目标和期望的受众行为告诉我们的营销团队。 Microsoft 可以自定义这些结果，让其服务于你的计划。

请务必参与[智能合作伙伴营销计划](https://partner.microsoft.com/smart-partner-marketing)，这是加入 Microsoft 合作伙伴网络的一项权益，可用于获取有关构建营销活动和市场营销实践的其他内容

### <a name="invest-in-merchandising"></a>投入促销活动
发布期间应已想好要创建的产品/服务类型，并能够在 AppSource 或 Azure 市场中为产品/服务选择一个类别。 请确保为解决方案选择的类别是准确的，这样它才能准确出现在潜在客户面前。<br /> <br />市场特色产品/服务是从提供最佳客户体验和利用高质量合作伙伴营销的产品/服务中选出的。 以下条件可提高解决方案成为市场特色产品/服务的几率：
*   列表内容的清晰程度
*   解决方案的质量
*   技术的可靠程度
*   客户为平台带来的用量增长
*   你在创作高质量营销材料方面的参与度

若要最大程度地增加产品/服务被推选为特色产品/服务的机会，应尽力确保市场产品/服务取得成功。 可以考虑使用以下方法，确保客户获得极佳的产品/服务体验：
*   确保营销项目已上传且显示正确。
*   通过创建高质量的需求激励活动，在市场中激发高质量的访问流量。
*   通过刺激需求，推动 AppSource 或 Azure 市场产品/服务的消费，同时提供高品质的客户服务，并及时更新产品/服务。

有关特色产品/服务如何适应推广权益上下文的详细信息，请访问市场页面中的 [GTM 权益](https://review.docs.microsoft.com/azure/marketplace/gtm-benefits)。

#### <a name="merchandising-badge"></a>促销徽章
AppSource 或 Azure 市场中列出产品/服务后，你便获得了在网站中显示_在 AppSource 中上市_或_在 Azure 市场中上市_徽章的权益。<br /> <br />AppSource 徽章提供三种尺寸。 可从[针对 Microsoft AppSource 中上市的应用进行推广](https://appsource.microsoft.com/blogs/promote-your-app-s-availability-on-microsoft-appsource)下载徽章和相关使用指南。<br /> <br />Azure 市场徽章作为免费[市场推广权益](https://review.docs.microsoft.com/azure/marketplace/gtm-benefits?branch=master)的一部分提供。

### <a name="linking-to-your-app-listing-page-on-marketplace-from-your-website"></a>从你的网站链接到市场中的应用列表页
从网站中的 AppSource 或 Azure 市场徽章链接到市场列表时，请在 URL 末尾包含以下查询参数，以便为强大的分析和报告功能提供支持：
*   src<br />包括路由到 AppSource 的流量的来源，例如 网站、LinkedIn、Facebook 等。
*   mktcmpid<br />你的市场营销活动 ID，使用字母、数字、下划线和连字符的任意组合，最多可包含 16 个字符，例如 blogpost_12。以下示例显示包含两个查询参数的 URL。 通过在 AppSource URL 中添加参数，可以在[云合作伙伴门户](http://cloudpartner.azure.com/#insights)的分析仪表板中查看营销活动的效果：<https://appsource.microsoft.com/product/dynamics-365/mscrm.04931187-431c-415d-8777-f7f482ba8095?src=website&mktcmpid=blogpost_12>

## <a name="analytics-and-reporting"></a>分析和报告

在[云合作伙伴门户](http://cloudpartner.azure.com/#insights)的“见解”部分，可查看产品/服务的高级别性能概述。 对于这些报表中的信息，最佳做法是将其与内部数据进行比较， 并使用这些数据确定营销活动的优先级。

[云合作伙伴门户](http://cloudpartner.azure.com/#insights)的“分析”部分（当前为预览版且仅面向 AppSource 产品/服务提供）提供内容丰富的 Power BI 仪表板。 可使用此仪表板查看产品/服务详细信息页上的流量。 当前正在推出此仪表板的新功能。

[云合作伙伴门户](http://cloudpartner.azure.com/#insights)中还有 Microsoft 营销活动的相关文档。 可使用 Microsoft 营销活动文档来设置和跟踪营销活动。

高级性能概述部分包含以下报告：
*   订单的摘要快照
*   使用情况
*   部署
*   “见解”主页上的客户趋势
*   详细订单、用途和客户数据
*   以每月摘要或六个月趋势视图形式显示的订单和用途
*   按多个条件划分的使用情况和订单。

详细报告会显示客户信息，例如公司名称和地理位置（邮政编码级别）。 考虑使用该信息与客户进行比较或对销售人员的信息进行补充。 Microsoft 提供以下有关客户的特定属性：
*   Reseller
*   名字
*   姓氏
*   Email
*   公司名称
*   事务日期
*   订阅名称
*   Azure 订阅 ID（仅适用于即用即付客户）
*   云实例名称
*   订单计数
*   客户所在国家和地区
*   客户所在城市
*   客户通信区域性
*   客户邮政编码

## <a name="enable-lead-sharing"></a>启用潜在顾客共享 
通过市场培养潜在顾客是与市场用户成功互动的关键促成因素。 首先请确保已经为列表启用了潜在顾客管理且潜在顾客管理已经在选择的公司 CRM 系统中正确配置，这样一来，当用户与你的列表交互并排队等待资格授予处理时，你会收到信号以及用户的联系信息。 针对潜在顾客使用以下方法：
*   利用市场营销和销售数据库中的其他数据扩充市场潜在顾客群体。 市场客户可能已经存在于你的某个潜在顾客培养系统中，这是因为他们之前参加过市场营销活动或他们是你的现有客户。 
*   对潜在顾客进行评分并根据市场中的不同行为使用不同的培养路径。 例如，测试应用程序的客户与发起购买的客户处于不同的阶段。
*   频繁处理潜在顾客数据。 与客户之间互动的时效性是取得成功的关键驱动因素。 
*   通过电子邮件或内部销售/预售培养潜在顾客，确保在进入销售管道前进行适当的资格授予。
*   根据整体市场营销活动策略开展工作。
若要详细了解如何加入联合销售计划，请访问[通过 Microsoft 促进业务发展](https://docs.microsoft.com/azure/marketplace/promote-your-business-with-microsoft)页面。

## <a name="gtm-benefits-on-the-marketplace"></a>市场的 GTM 权益

市场店面中的新商品将有资格获得免费的市场 GTM 权益。 推出新商品后，Microsoft 的市场营销专家将与你或你的市场营销联系人联系，以启动活动。 除了在 Microsoft 联系你时和我们一起沟通，你不需要做任何其他事情。

根据市场中解决方案的状态，Microsoft 提供的活动会有所不同。 针对商品所提供的权益显著增加。

| 店面 | 提供的其他权益 |
|:--- |:--- |   
| AppSource | <table> <tr><td>Microsoft 金牌合作伙伴</td></tr> <tr><td>试用版应用</td></tr> </table> |  
| Azure 市场 | <table> <tr><td>事务处理产品/服务</td></tr> <tr><td>试用版产品/服务</td></tr> </table> | 


为了最大限度地增加这些活动的影响力度，Microsoft 鼓励制定产品上市计划。 许多上市策略可能都需要使用登陆页面。

你的市场推广支持包括模板、Web 内容、培训以及用于推广业务的工具。
*   有关市场推广支持的详细信息，请访问 [Microsoft 市场推广服务](https://partner.microsoft.com/reach-customers/gtm)。

## <a name="promote-your-business-with-microsoft"></a>通过 Microsoft 促进业务发展
Microsoft 旨在支持像你这样的发布者，并简化在市场店面中销售应用或产品/服务的流程。 通过加入市场列表，你可以获得其他免费的市场营销和销售计划及资源。

如果还未注册 Microsoft 合作伙伴网络 (MPN)，必须先注册，然后才能继续。
*   有关 MPN 的详细信息，请访问“Microsoft 合作伙伴网络”页面 (partner.microsoft.com)。

MPN 提供了以下主题的指导。
*   新的业务机会
*   与团队或合作伙伴联系
*   有助于培养技能组合的解决方案和培训

若要推广产品/服务或应用，请根据下表利用更多权益和资源：

| 优点 | 资源 |
|:--- |:--- |
| 利用核心权益 | 作为 Microsoft 合作伙伴网络的成员，可获得一系列可能有助于节省时间和资金的核心权益。 这些权益可能还有助于加强你的能力，让你更好地为客户服务，并建立各种联系，充分发挥你的业务潜能。<br /> 有关核心权益的详细信息，请访问[核心权益和要求](http://partner.microsoft.com/membership/core-benefits)。 |
| 赢得云平台资格 | 赢得有助于让你在其他 Microsoft 合作伙伴中脱颖而出的资格。 获得某种 Competency 还表明你在市场方面的技术专长和所获得的客户成功。 资格是加入许多关键合作伙伴计划（如联合销售）的先决条件。<br /> 有关云平台资格的详细信息，请访问[云平台资格](https://partner.microsoft.com/membership/cloud-platform-competency)。 |
| 做好 IP 联合销售准备 | 你可能有资格参加 IP 联合销售就绪计划，这让你能够与 Microsoft 销售人员和其他合作伙伴直接协作，共同发展目标客户及完成客户策划。 Microsoft 销售人员可以在销售人员解决方案目录中看到你的解决方案。 Microsoft 销售人员会竭诚与你协作，开创双赢局面。<br /> 有关联合销售就绪情况的详细信息（包括资格要求），请访问[促进业务发展](https://partner.microsoft.com/reach-customers/promote-your-business)。 |


## <a name="azure-partner-customer-usage-attribution"></a>Azure 合作伙伴客户使用情况属性

作为 Azure 软件合作伙伴，你的解决方案要么需要使用 Azure 组件，要么直接部署在 Azure 基础结构上。  目前，当合作伙伴解决方案由客户部署并使用客户预配的 Azure 资源时，合作伙伴不仅难以掌握这些部署的状态，而且难以了解其对 Azure 增长的影响，因而无法与 Microsoft 销售团队和 Microsoft 合作伙伴计划额度保持一致。   

Microsoft 正在创建一种新方法，帮助合作伙伴更好地跟踪与客户在 Azure 上部署软件相关的 Azure 使用情况。 此新方法以使用 Azure 资源管理器编排 Azure 服务部署为前提。

作为 Microsoft 合作伙伴，你可以将 Azure 使用情况与你代表客户预配的任何 Azure 资源关联。  这可以通过 Azure 市场、QuickStart 存储库、私有 GitHub 存储库甚或一对一客户互动来实现。  为此，可使用两种方法：

 1. Azure 资源管理器模板：Azure 资源管理器模板或解决方案模板，用于部署 Azure 服务以运行合作伙伴软件。 合作伙伴可以创建 Azure 资源管理器模板，其中定义 Azure 解决方案的基础结构和配置。 通过创建 Azure 资源管理器模板，你和你的客户可以在解决方案的整个生命周期内重复部署该解决方案，确保以一致的状态部署资源。 

 2. Azure 资源管理器 API：合作伙伴可以直接调用 Azure 资源管理器 API 来部署 Azure 资源管理器模板，或生成 API 调用用于直接预配 Azure 服务。 

## <a name="method-1-azure-resource-manager-templates"></a>方法 1：Azure 资源管理器模板 
现在，许多合作伙伴解决方案都是使用 Azure 资源管理器模板部署在客户订阅中的。  如果在 Azure 市场、GitHub 或 QuickStart 中已经拥有 Azure 资源管理器模板，则应该可以直接修改模板以启用这一新跟踪方法。  如果当前没有使用 Azure 资源管理器模板，以下链接可帮助更好地了解 Azure 资源管理器模板及创建方式： 

*   [创建和部署第一个 Azure 资源管理器模板](https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-manager-create-first-template)
*   [为 Azure 市场创建解决方案模板指南](https://docs.microsoft.com/en-us/azure/marketplace-publishing/marketplace-publishing-solution-template-creation)

## <a name="instructions-add-a-guid-to-your-existing-azure-resource-manager-template"></a>说明：向现有 Azure 资源管理器模板添加 GUID

添加 GUID 是对主模板文件的单一修改：
 1. 创建一个 GUID，假设生成的值为 eb7927c8-dd66-43e1-b0cf-c346a422063
 2. 打开 Azure 资源管理器模板
 3. 在主模板文件中添加新资源。 资源只需位于 mainTemplate.json 或 azuredeploy.json 中，而不需要位于任何嵌套的或链接的模板中。
 4. 在“pid-”之后输入如上所示的 GUID。

   应该会看到类似示例的屏幕：`pid-eb7927c8-dd66-43e1-b0cf-c346a422063`

 5. 检查模板是否存在任何错误
 6. 在相应存储库中重新发布模板

## <a name="sample-template-code"></a>示例模板代码

```

{ // add this resource to the mainTemplate.json (do not add the entire file)
      "apiVersion": "2018-02-01",
      "name": "pid-XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX", // use your GUID here
      "type": "Microsoft.Resources/deployments",
      "properties": {
        "mode": "Incremental",
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
          "contentVersion": "1.0.0.0",
          "resources": []
        }
      }
    } // remove all comments from the file when done

```

## <a name="method-2-azure-resource-manager-apis"></a>方法 2：Azure 资源管理器 API

在某些情况下，合作伙伴希望直接调用 Azure 资源管理器 REST API 来部署 Azure 服务。 [Azure 为此支持多个 SDK](https://docs.microsoft.com/en-us/azure/#pivot=sdkstools)。  你可以使用其中一个 SDK，也可以直接调用 REST API 来部署资源。

如果使用 Azure 资源管理器模板，则应按照上述说明标记解决方案。  如果未使用 Azure 资源管理器模板并直接发出 API 调用，则仍可标记部署以关联 Azure 资源的使用情况。 

**如何使用 Azure 资源管理器 API 标记部署：** 对于此方法，在设计 API 调用时，需要在请求的用户代理标头中包含 GUID。 应为每个产品/服务或 SKU 添加 GUID。  字符串需要使用前缀为“pid-”的格式，然后包含合作伙伴生成的 GUID。   

>[!Note] 
>用于插入用户代理的 GUID 格式：pid-eb7927c8-dd66-43e1-b0cf-c346a422063     //在“pid-”之后输入 GUID

字符串的格式很重要。 如果未包含前缀“pid-”，我们将无法查询数据。 不同的 SDK 有不同的方式。  若要实现此方法，需要查看适用于首选 Azure SDK 的支持和方法。 

**使用 Python SDK 的示例：** 对于 Python，需要使用“config”属性。 仅可添加到 UserAgent（我们仍然需要一定形式的控制）。 将会如下所示：

```python

client = azure.mgmt.servicebus.ServiceBusManagementClient(**parameters)
        client.config.add_user_agent("pid-eb7927c8-dd66-43e1-b0cf-c346a422063")


```

>必须为每个客户端执行此操作，没有全局静态配置（可以选择通过客户端工厂来确保每个客户端都执行此操作）。 
>[其他参考信息](https://github.com/Azure/azure-cli/blob/7402fb2c20be2cdbcaa7bdb2eeb72b7461fbcc30/src/azure-cli-core/azure/cli/core/commands/client_factory.py#L70-L79)

如何使用 Azure PowerShell 或 Azure CLI 标记部署：如果通过 Azure PowerShell 部署资源，则可以使用以下方法附加 GUID：

```

[Microsoft.Azure.Common.Authentication.AzureSession]::ClientFactory.AddUserAgent("pid-eb7927c8-dd66-43e1-b0cf-c346a422063")


```

若要在使用 Azure CLI 时附加 GUID，请设置 AZURE_HTTP_USER_AGENT 环境变量。  可在脚本范围内设置或进行全局设置，以便在 shell 范围内使用：

```

export AZURE_HTTP_USER_AGENT='pid-eb7927c8-dd66-43e1-b0cf-c346a422063'


```

## <a name="registering-guidsoffers"></a>注册 GUID/产品/服务

必须注册 GUID 才能将其纳入跟踪范围。  

模板 GUID 的所有注册都将通过 Azure 市场云合作伙伴门户 (CPP) 完成。 

立即向 [Azure 市场](http://aka.ms/listonazuremarketplace)提出申请，获取云合作伙伴门户的访问权限。

*   要求合作伙伴[在 CPP 中拥有个人资料](https://docs.microsoft.com/en-us/azure/marketplace/become-publisher)，并鼓励他们在 Azure 市场或 AppSource 中列出产品/服务 
*   合作伙伴将能够注册多个 GUID 
*   合作伙伴还能够为非市场解决方案模板/产品/服务注册 GUID

将 GUID 添加到模板或用户代理并在 CPP 中注册 GUID 后，系统将跟踪所有部署。 

## <a name="verification-of-guid-deployment"></a>验证 GUID 部署 

修改模板并执行测试部署后，可使用以下 PowerShell 脚本检索已部署和标记的资源。 

可使用它来验证 GUID 是否已成功添加到 Azure 资源管理器模板。 它不适用于 Azure 资源管理器 API 部署。

登录 Azure 并选择包含想要在运行脚本前验证的部署的订阅。 必须在部署的订阅上下文中运行。

部署的 GUID 和 resourceGroup 名称是必需的参数。

可在[此处](https://gist.github.com/bmoore-msft/ae6b8226311014d6e7177c5127c7eba1#file-verify-deploymentguid-ps1)找到原始脚本。

```

Param(
    [GUID][Parameter(Mandatory=$true)]$guid,
    [string][Parameter(Mandatory=$true)]$resourceGroupName'
)

#get the correlationId of the pid deployment

$correlationId = (Get-AzureRmResourceGroupDeployment -ResourceGroupName 
$resourceGroupName -Name "pid-$guid").correlationId

#find all deployments with that correlationId

$deployments = Get-AzureRmResourceGroupDeployment -ResourceGroupName $resourceGroupName | Where-Object{$_.correlationId -eq $correlationId}

#find all deploymentOperations in a deployment by name (since PowerShell does not surface outputResources on the deployment or correlationId on the deploymentOperation)

foreach ($deployment in $deployments){

#get deploymentOperations by deploymentName and then the resourceId for any create operation

($deployment | Get-AzureRmResourceGroupDeploymentOperation | Where-Object{$_.properties.provisioningOperation -eq "Create" -and $_.properties.targetResource.resourceType -ne "Microsoft.Resources/deployments"}).properties.targetResource.id

}


```

## <a name="guidance-on-creating-guids"></a>GUID 创建指南

GUID（全局唯一标识符）是由 32 位十六进制数字组成的唯一参考编号。 若要创建 GUID，合作伙伴应使用 GUID 生成器来创建用于跟踪的 GUID。  可使用多个[在线 GUID 生成器](https://www.bing.com/search?q=guid%20generator&qs=n&form=QBRE&sp=-1&ghc=2&pq=guid%20g&sc=8-6&sk=&cvid=0BAFAFCD70B34E4296BB97FBFA3E1B4E)。

鼓励合作伙伴为每个产品/服务和分销渠道创建唯一的 GUID。  例如，一位合作伙伴拥有两个解决方案且两者都通过模板部署并在 Azure 市场和 GitHub 中提供。  合作伙伴应创建 4 个 GUID：

*   Azure 市场中的产品/服务 A 
*   GitHub 中的产品/服务 A
*   Azure 市场中的产品/服务 B 
*   GitHub 中的产品/服务 B

报告将由合作伙伴（Microsoft 合作伙伴 ID）和 GUID 完成。 

还可以选择在更加精细的级别跟踪 GUID，即 SKU（其中 SKU 是产品/服务的变体）。

## <a name="guidance-on-privacy-and-data-collection"></a>隐私和数据收集指南

合作伙伴应提供消息，告知其客户包含 Azure 资源管理器 GUID 跟踪功能的部署将允许 Microsoft 向合作伙伴报告与这些部署关联的 Azure 使用情况。  下面是一些示例语言。 此外，合作伙伴应确保这与其自己的数据隐私和收集政策保持一致，包括供客户选择将自己从跟踪中排除的选项： 

**对于 Azure 资源管理器模板部署**

部署此模板时，Microsoft 将能够根据部署的 Azure 资源识别[插入合作伙伴软件名称]软件的安装。  Microsoft 将能够关联用于支持该软件的 Azure 资源。  Microsoft 收集此信息的目的在于提供其产品的最佳体验及运营其业务。 此数据将根据 Microsoft 的隐私政策进行收集和管理，隐私政策可在 https://www.microsoft.com/en-us/trustcenter 找到。 

**对于 SDK 或 API 部署**

部署我们的软件时，Microsoft 将能够根据部署的 Azure 资源识别[插入合作伙伴软件名称]软件的安装。  Microsoft 将能够关联用于支持该软件的 Azure 资源。  Microsoft 收集此信息的目的在于提供其产品的最佳体验及运营其业务。 此数据将根据 Microsoft 的隐私政策进行收集和管理，隐私政策可在 https://www.microsoft.com/en-us/trustcenter 找到。

## <a name="support"></a>支持

如需获取帮助，请执行以下步骤：
 1. 访问位于 [go.microsoft.com/fwlink/?linkid=844975](https://go.microsoft.com/fwlink/?linkid=844975) 的支持页面
 2. 对于有关使用情况关联的问题 — 选择问题类型“市场入门”和类别“其他”，然后单击“启动请求”。 
>[!Note]
>对于有关访问 Azure 市场云合作伙伴门户的问题 — 选择问题类型“市场入门”和类别“访问问题”，然后单击“启动请求”。
 3. 填写下一页中的必填字段，然后单击“继续”。
 4. 填写下一页中的自定义文本字段。  
 


 
>[!Important] 
>在事件标题中填写“ISV 使用情况跟踪”，然后在大型自定义文本字段中详细说明你的问题。  填写表格的其余部分，然后单击“提交”。

## <a name="faqs"></a>常见问题

**向模板添加 GUID 有何好处？**

Microsoft 将为合作伙伴提供其模板的客户部署情况以及有关受其影响的使用情况的见解。  Microsoft 和合作伙伴还可以使用此信息来促进合作伙伴与 Microsoft 销售团队进行更密切地合作，并就单个合作伙伴对 Azure 增长的影响有更加一致的了解。 

**谁可以向模板添加 GUID？**

跟踪资源旨在将合作伙伴的解决方案与客户的 Azure 使用情况关联。  使用情况数据与合作伙伴的 Microsoft 合作伙伴网络身份 (MPN ID) 关联，并且报告通过云合作伙伴门户 (CPP) 向合作伙伴提供。  

**添加 GUID 后是否可对其进行更改？**
 
是，客户或实现合作伙伴可以自定义模板，并且可以更改或删除 GUID。 我们建议合作伙伴主动向其客户和合作伙伴介绍资源和 GUID 的角色，以防止删除或编辑跟踪 GUID。  请注意，更改 GUID 只会影响新的部署和资源，而不会影响现有部署和资源。

**报告何时可用？**

报告的 beta 版本应该很快就会上线。  报告将集成到云合作伙伴门户 (CPP) 中。

**我是否可以跟踪通过非 Microsoft 存储库（如 GitHub）部署的模板？**

是，只要部署模板时存在 GUID，就会跟踪使用情况。  
合作伙伴需要在云合作伙伴门户中拥有配置文件才能注册在 Azure 市场外部发布的相关模板。 

**通过 Azure 市场部署模板与通过 GitHub 等其他存储库部署模板是否存在差异？**

是，在 Azure 市场中发布产品/服务的合作伙伴可能会从 Azure 市场收到有关部署的更加详细的数据。  合作伙伴将从在 Azure 市场门户和 Azure 管理门户中向客户公开其产品/服务获益。 Azure 市场中的产品/服务也会为合作伙伴带来潜在顾客。

**如果我为单独的客户参与创建自定义模板，会怎样？**

你仍然可以向模板添加 GUID。  如果使用已注册的现有 GUID，它将包含在报告中。  如果创建新的 GUID，则需要注册新的 GUID 才能将其包含在跟踪中。

**客户是否也会收到报告？**

客户目前能够在 Azure 管理门户内跟踪各个资源或客户定义资源组的使用情况。   

**这是否类似于数字记录合作伙伴 (DPOR)？**

这种将部署和使用情况与合作伙伴解决方案关联的新方法旨在提供将合作伙伴解决方案与 Azure 使用情况连接的机制。  DPOR 旨在将咨询（系统集成商）或管理（托管服务提供商）合作伙伴与客户的 Azure 订阅关联。   


## <a name="next-steps"></a>后续步骤
访问[市场推广服务](https://partner.microsoft.com/reach-customers/gtm)，详细了解市场服务。 

---
