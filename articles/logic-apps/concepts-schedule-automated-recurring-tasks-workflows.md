---
title: 计划定期任务和 Azure 逻辑应用中的工作流
description: 有关计划定期自动化的任务、 进程和使用 Azure 逻辑应用工作流的概述
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: ecfan
ms.author: estfan
ms.reviewer: deli, klam, LADocs
ms.topic: conceptual
ms.date: 05/25/2019
ms.openlocfilehash: 7f15dc5b28a44dc8405e2f0524913e6012ebe380
ms.sourcegitcommit: 8e76be591034b618f5c11f4e66668f48c090ddfd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/29/2019
ms.locfileid: "66356050"
---
# <a name="schedule-and-run-recurring-automated-tasks-processes-and-workflows-with-azure-logic-apps"></a>计划和与 Azure 逻辑应用运行定期的自动化的任务、 流程和工作流

逻辑应用可帮助你创建并按计划运行自动定期任务和流程。 通过创建逻辑应用工作流开头的内置重复或滑动窗口触发器，该值是计划类型触发器，你可以立即在更高版本的时间，或按重复时间间隔运行任务。 可以调用服务内部和外部 Azure，如 HTTP 或 HTTPS 终结点、 将消息发布到 Azure 存储和 Azure 服务总线等 Azure 服务或获取上传到文件共享的文件。 使用重复触发器，您还可以设置复杂的计划和高级重复周期为正在运行的任务。 有关内置的计划触发器和操作的详细信息，请参阅[计划和定期自动运行、 任务和使用 Azure 逻辑应用工作流](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md)。

下面是一些示例，显示的可以运行的任务类型：

* 获取内部数据，例如运行 SQL 存储过程每一天。

* 获取外部数据，例如拉取天气报告从 NOAA 每隔 15 分钟。

* 将报表数据，例如大于在过去一周中特定量的所有订单的摘要的电子邮件发送。

* 处理数据，如压缩今天已上传图像的每个工作日的非高峰时间。

* 清理早于三个月内的所有推文数据，例如删除。

* 存档数据，例如到 1:00 AM 的下一步的 9 个月内每一天的备份服务推送发票。

计划内置操作还可用于下一步操作运行，例如之前暂停工作流：

* 等到工作日通过电子邮件发送状态更新。

* 在恢复和检索结果前，延迟工作流直到 HTTP 调用有时间完成。

本文介绍计划内置触发器和操作的功能。

## <a name="schedule-triggers"></a>计划触发器

可以在逻辑应用工作流启动通过使用重复触发器或滑动窗口触发器不是与任何特定服务或系统，例如，Office 365 Outlook 或 SQL Server 相关联。 这些触发器启动并运行基于指定的定期计划工作流在其中选择时间间隔和频率，例如秒、 分钟和同时触发器的小时数或数天、 周或几个月的定期触发器。 此外可以设置开始日期和时间以及时区。 每当触发器触发时，逻辑应用创建并运行逻辑应用的新工作流实例。

下面是这些触发器之间的差异：

* **重复周期**:在固定的时间间隔根据指定的计划运行工作流。 如果错过定期计划，重复触发器不会处理丢失的定期计划，但重启与下一步计划的时间间隔的重复周期。 您可以指定开始日期和时间以及时区。 如果选择"Day"时，可以指定的日期的小时和分钟数小时，例如，每天凌晨 2:30。 如果选择了"周"，您还可以选择的星期日期，例如星期三和星期六。 有关详细信息，请参阅[创建、 计划和运行重复任务和工作流分别具有重复触发器](../connectors/connectors-native-recurrence.md)。

* **滑动窗口**:在处理连续区块中的数据的固定的时间间隔运行您的工作流。 如果重复发生会丢失，滑动窗口触发器将恢复并处理丢失的重复周期。 您可以指定开始日期和时间、 时区和持续时间延迟在工作流中的每个定期计划。 此触发器不一定要指定天、 周和月、 日期的小时、 小时、 分钟和每周天数的选项。 有关详细信息，请参阅[创建、 计划和运行重复任务和工作流的滑动窗口触发器与](../connectors/connectors-native-sliding-window.md)。

## <a name="schedule-actions"></a>计划操作

在逻辑应用工作流中的任何操作之后, 可以使用的延迟和延迟直到操作可使在下一步操作运行之前等待工作流。

* **延迟**:等待指定的时间单位，例如秒、 分钟、 小时、 天、 周或月数运行下一步操作。 有关详细信息，请参阅[延迟的工作流中的下一步操作](../connectors/connectors-native-delay.md)。

* **延迟截止时间**:若要运行的下一步操作，直到指定的日期和时间的等待。 有关详细信息，请参阅[延迟的工作流中的下一步操作](../connectors/connectors-native-delay.md)。

## <a name="patterns-for-start-date-and-time"></a>开始日期和时间模式

<a name="start-time"></a>

下面是演示如何控制循环的开始日期和时间，以及逻辑应用服务如何运行这些定期计划的一些模式：

| 开始时间 | 不按计划循环 | （仅重复触发器） 按计划循环 |
|------------|-----------------------------|----------------------------------------------------|
| {无} | 即时运行第一个工作负荷。 <p>基于上次运行时间运行将来的工作负荷。 | 即时运行第一个工作负荷。 <p>基于指定的计划运行将来的工作负荷。 |
| 开始时间在过去 | **重复周期**触发器：基于指定的开始时间计算运行时间，并丢弃过去的运行时间。 在下一个将来运行时间运行第一个工作负荷。 <p>基于上次运行时间的计算结果运行将来的工作负荷。 <p><p>**滑动窗口**触发器：计算运行的时间根据指定的开始时间和执行过去运行时间。 <p>运行基于从指定的开始时间计算将来的工作负荷。 <p><p>有关详细说明，请参阅此表格后面的示例。 | 基于从开始时间计算的计划，在不早于开始时间的时间运行第一个工作负荷。  <p>基于指定的计划运行将来的工作负荷。 <p>**注意：** 如果针对计划指定了定期模式，但没有为该计划指定小时或分钟，则将来的运行时间会分别使用小时或分钟来计算（从首次运行时间开始算起）。 |
| 开始时间在当前或将来 | 在指定的开始时间运行第一个工作负荷。 <p>基于上次运行时间的计算结果运行将来的工作负荷。 | 基于从开始时间计算的计划，在不早于开始时间的时间运行第一个工作负荷。  <p>基于指定的计划运行将来的工作负荷。 <p>**注意：** 如果针对计划指定了定期模式，但没有为该计划指定小时或分钟，则将来的运行时间会分别使用小时或分钟来计算（从首次运行时间开始算起）。 |
||||

*在过去的开始时间和重复周期但没有计划的示例*

假设当前日期和时间为 2017 年 9 月 8 日下午 1:00。 您指定的开始日期和时间为 2017 年 9 月 7 日下午 2:00，这是在过去，并每隔 2 天运行一次的重复周期。

| 开始时间 | 当前时间 | 定期 | 计划 |
|------------|--------------|------------|----------|
| 2017-09-**07**T14:00:00Z <br>(2017年-09-**07**下午 2:00) | 2017-09-**08**T13:00:00Z <br>(2017年-09-**08**下午 1:00) | 每 2 天 | {无} |
|||||

对于重复触发器，则逻辑应用引擎计算运行时间基于开始时间，丢弃过去的运行时间，使用下一个将来开始时间的第一个运行，并计算最后一个运行时中基于未来运行。

下面是此重复周期的大致形式：

| 开始时间 | 首次运行时间 | 将来的运行时间 |
|------------|----------------|------------------|
| 2017-09-**07** 的 2:00 PM | 2017-09-**09** 的 2:00 PM | 2017-09-**11** 的 2:00 PM </br>2017-09-**13** 的 2:00 PM </br>2017-09-**15** 的 2:00 PM </br>依此类推... |
||||

因此，不管距离在指定的开始时间，例如，过去 2017年-09-**05**下午 2:00 或 2017年-09-**01**下午 2:00，你的第一个始终运行下一个将来开始时间的使用。

对于滑动窗口触发器，则逻辑应用引擎计算运行时间基于开始时间，过去的执行运行时间、 用于首次运行开始时间和计算将来的运行基于开始时间。

下面是此重复周期的大致形式：

| 开始时间 | 首次运行时间 | 将来的运行时间 |
|------------|----------------|------------------|
| 2017-09-**07** 的 2:00 PM | 2017-09-**07** 的 2:00 PM | 2017-09-**09** 的 2:00 PM </br>2017-09-**11** 的 2:00 PM </br>2017-09-**13** 的 2:00 PM </br>2017-09-**15** 的 2:00 PM </br>依此类推... |
||||

因此，不管距离在指定的开始时间，例如，过去 2017年-09-**05**下午 2:00 或 2017年-09-**01**下午 2:00，你的第一个运行始终使用指定开始时间。

<a name="example-recurrences"></a>

## <a name="example-recurrences"></a>示例中的重复周期

下面是你可以为支持选项的触发器设置的各种示例重复周期：

| 触发器 | 定期 | Interval | 频率 | 开始时间 | 在这些日期 | 在这些小时 | 在这些分钟 | 注意 |
|---------|------------|----------|-----------|------------|---------------|----------------|------------------|------|
| 重复执行， <br>滑动窗口 | 每隔 15 分钟运行（没有开始日期和时间） | 15 | Minute | {无} | {不可用} | {无} | {无} | 此计划立即启动，然后根据上次运行时间计算将来的重复周期。 |
| 重复执行， <br>滑动窗口 | 每隔 15 分钟运行（有开始日期和时间） | 15 | Minute | *startDate*T*startTime*Z | {不可用} | {无} | {无} | 此计划不会在指定的开始日期和时间之前启动，将根据上次运行时间计算将来的重复周期。  |
| 重复执行， <br>滑动窗口 | 每隔一小时整点运行（有开始日期和时间） | 第 | Hour | *startDate*Thh:00:00Z | {不可用} | {无} | {无} | 此计划不会在指定的开始日期和时间之前启动。  将来的重复周期"00"分钟标记，开始时间通过计算在运行每隔一小时。 <p>如果频率为“周”或“月”，则此计划只会分别在每周的一个星期日期或每月的一个日期运行。 |
| 重复执行， <br>滑动窗口 | 每天每隔一小时运行（没有开始日期和时间） | 第 | Hour | {无} | {不可用} | {无} | {无} | 此计划立即启动，并根据上次运行时间计算将来的重复周期。 <p>如果频率为“周”或“月”，则此计划只会分别在每周的一个星期日期或每月的一个日期运行。 |
| 重复执行， <br>滑动窗口 | 每天每隔一小时运行（有开始日期和时间） | 第 | Hour | *startDate*T*startTime*Z | {不可用} | {无} | {无} | 此计划不会在指定的开始日期和时间之前启动，将根据上次运行时间计算将来的重复周期。  <p>如果频率为“周”或“月”，则此计划只会分别在每周的一个星期日期或每月的一个日期运行。 |
| 重复执行， <br>滑动窗口 | 每隔一小时在整点过后的第 15 分钟运行（有开始日期和时间） | 第 | Hour | *startDate*T00:15:00Z | {不可用} | {无} | {无} | 此计划不会在指定的开始日期和时间之前启动。  将来的重复周期"15"分钟标记，开始通过计算在运行时间，这样在 00:15、 凌晨 1:15、 凌晨 2:15、 凌晨等等。 |
| 定期 | 每隔一小时在整点过后的第 15 分钟运行（没有开始日期和时间） | 第 | 日期 | {无} | {不可用} | 0、1、2、3、4、5、6、7、8、9、10、11、12、13、14、15、16、17、18、19、20、21、22、23 | 15 | 此计划在 00:15 AM、1:15 AM、2:15 AM 等有规律的时间运行。 此外，此计划相当于频率为“小时”且开始时间为“15”分钟。 |
| 定期 | 运行 （没有开始日期和时间） 指定的分钟标记每隔 15 分钟。 | 第 | 日期 | {无} | {不可用} | 0、1、2、3、4、5、6、7、8、9、10、11、12、13、14、15、16、17、18、19、20、21、22、23 | 0、15、30、45 | 此计划在下一个指定的 15 分钟标记之前不会启动。 |
| 定期 | 每天的 8:00 AM 运行（没有开始日期和时间） | 第 | 日期 | {无} | {不可用} | 8 | {无} | 此计划基于指定的计划在每天的 8:00 AM 运行。 |
| 定期 | 每天的 8:00 AM 运行（有开始日期和时间） | 第 | 日期 | *startDate*T08:00:00Z | {不可用} | {无} | {无} | 此计划基于指定的开始时间在每天的 8:00 AM 运行。 | 
| 定期 | 每天的 8:30 AM 运行（没有开始日期和时间） | 第 | 日期 | {无} | {不可用} | 8 | 30 | 此计划基于指定的计划在每天的 8:30 AM 运行。 |
| 定期 | 每天的 8:30 AM 运行（有开始日期和时间） | 第 | 日期 | *startDate*T08:30:00Z | {不可用} | {无} | {无} | 此计划在指定的开始日期的 8:30 AM 启动。 |
| 定期 | 在每天的 8:30 AM 和 4:30 PM 运行 | 第 | 日期 | {无} | {不可用} | 8, 16 | 30 | |
| 定期 | 在每天的上午 8:30、8:45 和下午 4:30、4:45 运行 | 第 | 日期 | {无} | {不可用} | 8, 16 | 30, 45 | |
| 定期 | 在每个星期六的 5:00 PM 运行（没有开始日期和时间） | 第 | 周次 | {无} | “星期六” | 17 | 00 | 此计划在每个星期六的 5:00 PM 运行。 |
| 定期 | 在每个星期六的 5:00 PM 运行（有开始日期和时间） | 第 | 周次 | *startDate*T17:00:00Z | “星期六” | {无} | {无} | 此计划不会在指定的开始日期和时间（在本例中为 2017 年 9 月 9 日 5:00 PM）之前启动。  将来的定期计划在每个星期六的 5:00 PM 运行。 |
| 定期 | 在每个星期二和星期四的 5:00 PM 运行 | 第 | 周次 | {无} | “星期二”、“星期四” | 17 | {无} | 此计划在每个星期二和星期四的 5:00 PM 运行。 |
| 定期 | 在工作时间每隔一小时运行 | 第 | 周次 | {无} | 选择除星期六和星期日以外的所有星期日期。 | 选择所需的日期小时。 | 选择所需的任何小时分钟。 | 例如，如果工作时间为 8:00 AM 到 5:00 PM，则选择“8、9、10、11、12、13、14、15、16、17”作为日期小时。 <p>如果工作时间为 8:30 AM 到 5:30 PM，则选择前面的日期小时加上“30”作为小时分钟。 |
| 定期 | 在周末每隔一个星期日期运行一次 | 第 | 周次 | {无} | “星期六”、“星期日” | 选择所需的日期小时。 | 选择适当的任何小时分钟。 | 此计划根据指定的计划在每个星期六和星期日运行。 |
| 定期 | 仅每两周在星期一每隔 15 分钟运行 | 2 | 周次 | {无} | “星期一” | 0、1、2、3、4、5、6、7、8、9、10、11、12、13、14、15、16、17、18、19、20、21、22、23 | 0、15、30、45 | 此计划按每个 15 分钟标记每隔两周在星期一运行。 |
| 定期 | 运行每个月 | 第 | 月份 | *startDate*T*startTime*Z | {不可用} | {不可用} | {不可用} | 此计划不会启动*得更快*比指定的开始日期和时间和开始日期和时间计算将来的重复周期。 如果未指定开始日期和时间，则此计划使用创建日期和时间。 |
| 定期 | 在每个月每隔一小时运行一天 | 第 | 月份 | {参阅备注} | {不可用} | 0、1、2、3、4、5、6、7、8、9、10、11、12、13、14、15、16、17、18、19、20、21、22、23 | {参阅备注} | 如果未指定开始日期和时间，则此计划使用创建日期和时间。 若要控制定期计划的分钟，请指定小时分钟和开始时间，或使用创建时间。 例如，如果开始时间或创建时间为 8:25 AM，则此计划在 8:25 AM、9:25 AM、10:25 AM 等有规律的时间运行。 |
|||||||||

<a name="run-once"></a>

## <a name="run-one-time-only"></a>只运行一次

如果你想要仅一次以后，可以使用运行逻辑应用**计划程序：** 运行一次作业”模板。 创建新的逻辑应用后但在打开逻辑应用设计器中前,**模板**部分中，从**类别**列表中，选择**计划**，然后选择此模板：

![选择“计划程序:运行一次作业”模板](./media/concepts-schedule-automated-recurring-tasks-workflows/choose-run-once-template.png)

或者，如果可以启动与逻辑应用**收到时 HTTP 请求-请求**触发器，并作为触发器参数传递的开始时间。 对于第一个操作，使用**延迟截止时间-安排**操作，并提供下一步操作开始运行时的时间。

## <a name="next-steps"></a>后续步骤

* [创建、 安排和使用重复触发器运行重复任务和工作流](../connectors/connectors-native-recurrence.md)
* [创建、 安排和滑动窗口触发器与运行重复任务和工作流](../connectors/connectors-native-sliding-window.md)
* [暂停工作流使用延迟操作](../connectors/connectors-native-delay.md)