---
title: Azure Stack 的容量规划 |Microsoft Docs
description: 了解有关 Azure Stack 部署容量规划。
services: azure-stack
documentationcenter: ''
author: jeffgilb
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/18/2018
ms.author: jeffgilb
ms.reviewer: prchint
ms.openlocfilehash: ad76e19e324c29c277e72f1e93d2b505984b50ba
ms.sourcegitcommit: ce526d13cd826b6f3e2d80558ea2e289d034d48f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/19/2018
ms.locfileid: "46369049"
---
# <a name="azure-stack-capacity-planning"></a>Azure Stack 容量规划
评估 Azure Stack 解决方案，有直接影响总容量的 Azure Stack 云的硬件配置选择。 这些是 CPU、 内存密度、 存储配置，以及总体解决方案规模或的服务器数量的一般选择。 不同于传统的虚拟化解决方案，简单地评估这些组件并不能很好地确定可用的容量。 这样做的第一个原因是 Azure Stack 构建为承载在解决方案自身内部的基础结构或管理组件。 第二个原因是容量的某些解决方案容量的保留用于支持复原;一种方法来最大程度减少中断的租户工作负荷解决方案的软件更新。

> [!IMPORTANT]
> 提供的容量规划信息，并随附电子表格，旨在仅作为指南可帮助你做出 Azure Stack 规划和配置决策。 它们不旨在取代你自己的调查和分析。 

## <a name="compute-and-storage-capacity-planning"></a>计算和存储容量规划
Azure Stack 解决方案旨在作为超聚合群集的计算、 网络和存储。 这允许有效地使用或在群集中共享的所有硬件容量称为缩放单位适用于 Azure Stack 中提供可用性和可伸缩性的方式。 所有基础结构软件集中的虚拟机 (Vm) 托管，并共享为租户 Vm 相同的物理服务器。 然后由缩放单位的 Windows Server 群集技术和单独的 HYPER-V 实例管理的所有 Vm。 此方法简化了采购和管理 Azure Stack 解决方案，并到整个缩放单位可用于移动和所有服务 （租户和基础结构） 的可伸缩性的。

不过度预配以在 Azure Stack 解决方案中的唯一一个物理资源是服务器内存。 其他资源、 CPU 核心数、 网络带宽和存储容量将过度预配以便充分利用可用资源。 在计算解决方案的可用容量时，物理服务器的内存是主要参与者。 其他资源的使用率是然后了解的过度预配的比率可能和什么是可以接受的预期工作负荷。

大约 28 Vm 用于托管 Azure Stack 的基础结构，并且总共使用大约 208 GB 的内存和 124 虚拟核心数。  此数量的 Vm 的基本原理是满足所需的服务分离，以满足安全性、 可伸缩性，服务和修补的要求。 此内部服务结构允许将来引入新的基础结构服务的开发。

若要支持自动的更新的所有物理服务器和基础结构软件组件或修补程序和更新，基础结构和用户虚拟机放置不会占用所有的内存资源的缩放单位。 将支持解决方案的可恢复性要求而未分配的缩放单位的所有服务器之间的总内存量。 例如，当更新物理服务器的 Windows Server 映像时，在服务器上托管的 Vm 会移动到其他位置缩放单位内更新服务器的 Windows Server 映像时。 更新完成后，服务器重新启动，并返回到服务的工作负荷。 修补程序和更新 Azure Stack 解决方案的目标是避免需要停止托管的 Vm。 努力满足该目标，一台服务器的内存容量的最小配置未分配，以便允许缩放单位内的 Vm 的运动。 此放置和移动应用到基础结构 Vm 和 Vm 创建的用户或租户的 Azure Stack 解决方案的代表。 最终实现结果可以这样量的内存保留以支持所需的 VM 移动可能会远不止是单个服务器的容量由于放置问题时虚拟机具有不同的内存要求。 类别中的内存使用的额外开销是，Windows Server 实例本身。 每个服务器的基本操作系统实例将会占用内存的操作系统和 HYPER-V 中管理每个托管的 Vm 使用的内存以及其虚拟页表。

在本部分中更高版本介绍更多的容量计算复杂性的说明。 在本简介中，提供了以下示例来帮助了解不同解决方案大小的可用容量。 这是估计值，因此做出有关租户 VM 可能不适用于生产安装的内存使用。 对于此表中，使用标准 D2 Azure VM 大小。 Azure 标准 D2 Vm 是使用 2 个虚拟 Cpu 和 7 GB 内存进行定义。

|     |每个服务器容量|| 缩放单位容量|  |  |||
|-----|-----|-----|-----|-----|-----|-----|-----|
|     | 内存 | CPU 内核 | 服务器数量 | 内存 | CPU 内核 | 租户 Vm<sup>1</sup>     | 内核之比<sup>2</sup>    |
|示例 1|256 GB|28|4|1024 GB| 112 | 54 |4:3|
|示例 2|512 GB|28|4|2024 GB|112|144|4:1|
|示例 3|384 GB|28|12|4608 GB|336|432|3:1|
|     |     |     |     |     |     |     |     |

> <sup>1</sup>标准 D2 Vm。

> <sup>2</sup>虚拟内核与物理内核之比。

如上面所述，VM 容量取决于可用内存。 虚拟核心，对物理核心比率将如何虚拟机密度将更改可用的 CPU 容量，除非使用更多的物理内核数 （选择另一个 CPU） 构建的解决方案。 这同样适用的存储容量和存储缓存容量。

虚拟机的密度的上述示例仅用于说明。 在中支持的计算还有更多复杂。 与 Microsoft 联系或解决方案合作伙伴时需要进一步了解容量规划选择和生成的、 可用容量。

本部分的剩余部分将介绍针对计算和存储的 Azure Stack 部署要求。 使用此信息来了解哪些组件的所需的基础和其最小配置值。 此外提供其他信息来描述该解决方案与可用容量和有关租户的容量和性能功能系统的潜在限制相关的配置方式。

> [!NOTE]
> 仅公共 VIP 的大小是可配置为最小容量规划要求的网络。 有关如何将多个公共 IP 地址添加到 Azure Stack 信息请参阅[添加公共 IP 地址](azure-stack-add-ips.md)。


## <a name="next-steps"></a>后续步骤
[计算容量规划](capacity-planning-compute.md)
