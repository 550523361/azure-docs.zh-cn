---
title: "服务总线定价和计费|Microsoft 文档"
description: "服务总线定价结构概述。"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 7c45b112-e911-45ab-9203-a2e5abccd6e0
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/02/2017
ms.author: sethm
ms.translationtype: Human Translation
ms.sourcegitcommit: be3ac7755934bca00190db6e21b6527c91a77ec2
ms.openlocfilehash: 5161b555db96886f556a4fe96eab4415d8ccf047
ms.contentlocale: zh-cn
ms.lasthandoff: 05/03/2017


---
# <a name="service-bus-pricing-and-billing"></a>服务总线定价和计费
服务总线推出基本、标准和[高级](service-bus-premium-messaging.md)三种层级。 可为创建的每个服务总线服务命名空间选择一个服务层级，且此层级选择会应用到该命名空间内创建的所有实体。

> [!NOTE]
> 有关当前服务总线定价的详细信息，请参阅 [Azure 服务总线定价页](https://azure.microsoft.com/pricing/details/service-bus/)和[服务总线常见问题解答](service-bus-faq.md#pricing)。
>
>

服务总线使用对于队列和主题/订阅使用以下两个计量方式：

1. **消息传送操作**：定义为对队列或主题/订阅服务终结点的 API 调用。 该计费方式将取代发送或接收的消息作为队列和主题/订阅可计费使用情况的主计价单位。
2. **中转连接**：定义为对队列、主题或订阅在特定一小时采样期间持续连接打开的最大数量。 此计费仅适用于标准层，在标准层中打开其他连接（此前，连接限制为每个队列/主题/订阅 100 个）会有名义每个链接费用。

**标准**层对队列和主题/订阅内执行的操纵采用分级定价，从而在最高使用级别产生高达 80% 的基于量的折扣。 此外，每个月只需支付 10 美元的标准层基础费用，便可执行最多 1250 万个操作，无任何其他费用。

**高级**层在 CPU 和内存层提供了资源隔离，以便每个客户工作负荷以隔离方式运行。 此资源容器称为 *消息传送单元*。 每个高级命名空间至少会分配一个消息传送单元。 你可以为每个服务总线高级命名空间购买 1、2 或 4 个消息传送单元。 单一工作负荷或实体可以跨多个消息传送单元，尽管计费以 24 小时或每天的费率收取，但仍然可以随意更改消息传送单元数。 从而为基于服务总线的解决方案提供可预测和稳定的性能。 此性能不仅更易于预测和实现，而且速度更快。

请注意，每个 Azure 订阅每月仅需支付一次标准层基本费用。 这意味着在创建单个标准级别的服务总线命名空间后，你将能够在同一 Azure 订阅下根据需要创建任意数目的其他标准命名空间，而不会产生附加的基本费用。

[服务总线定价](https://azure.microsoft.com/pricing/details/service-bus/)表总结了基本、标准和高级层之间的功能差异。

## <a name="messaging-operations"></a>消息传送操作
作为新的定价模式的一部分，队列和主题/订阅的计费会发生改变。 这些实体从按消息计费转换为按操作计费。 “操作”表示对队列或主题/订阅服务终结点所作的任何 API 调用。 这包括管理、发送/接收和会话状态操作。

| 操作类型 | 说明 |
| --- | --- |
| 管理 |对队列或主题/订阅进行创建、读取、更新、删除 (CRUD) 操作。 |
| 消息传递 |通过队列或主题/订阅发送和接收消息。 |
| 会话状态 |获取或设置队列或主题/订阅的会话状态。 |

有关成本的详细信息，请参阅[服务总线定价](https://azure.microsoft.com/pricing/details/service-bus/)页上列出的价格。

## <a name="brokered-connections"></a>中转连接
*中转连接*允许客户的使用模式涉及对队列、主题或订阅的大量“永久连接”发送方/接收方。 永久连接的发送方/接收方是使用具有非零接收超时（例如，HTTP 长轮询）的 AMQP 或 HTTP 连接的那些。 具有立即超时的 HTTP 发送方和接收方不会生成中转连接。

有关连接配额和其他服务限制，请参阅[服务总线配额](service-bus-quotas.md)一文。

标准层去除了每个命名空间中转连接的限制，并对 Azure 订阅计算聚合中转连接使用量。 有关详细信息，请参阅[中转连接](https://azure.microsoft.com/pricing/details/service-bus/)表。

> [!NOTE]
> 标准消息传送级别（通过基本费用）包括 1,000 个中转连接，可在关联的 Azure 订阅内跨所有队列、主题和订阅共享这些中转连接。
>
>

<br />

> [!NOTE]
> 根据并发连接的峰值数量计费，按照每月 744 小时，每小时按比例分配费用。
>
>

| 高级层 |
| --- |
| 在“高级”层中，中转连接不计费。 |

有关中转连接的详细信息，请参阅本主题后面的[常见问题解答](#faq)部分。

## <a name="faq"></a>常见问题

### <a name="what-are-brokered-connections-and-how-do-i-get-charged-for-them"></a>什么是中转连接，它的计费方式是怎样的？
中转连接定义为下列其中一项：

1. 从客户端到服务总线队列或主题/订阅的 AMQP 连接。
2. 从接收超时值大于零的服务总线主题或队列接收消息的 HTTP 调用。

超出附送数量（标准层为 1,000）的峰值并发中转连接数的服务总线收费。 峰值将每小时计量一次，按照每月 744 小时按比例分配费用，并在每月计费周期内累加。 在计费周期结束时，将会针对按比例分配的小时峰值的总和应用附送数量（每月 1,000 个中转连接）。

例如：

1. 每个设备（共 10000 个）通过单个 AMQP 连接进行连接，并从服务总线主题中接收命令。 设备将遥测事件发送至事件中心。 如果所有设备每天连接 12 小时，则需支付以下连接费用（未包括任何其他服务总线主题费用）：10,000 个连接 * 12 小时 * 31 天/744 = 5,000 个中转连接。 在扣除每月 1,000 个中转连接的限额后，你需要按每个中转连接 0.03 美元的费率支付 4,000 个中转连接的费用，总共 120 美元。
2. 10,000 台设备通过 HTTP 从服务总线队列接收消息，超时不为零。 如果所有设备每天连接 12 小时，则需要支付以下连接费用（未包括任何其他服务总线费用）：10,000 个 HTTP 接收连接 * 12 小时/天 * 31 天/744 小时 = 5,000 个中转连接。

### <a name="do-brokered-connection-charges-apply-to-queues-and-topicssubscriptions"></a>中转连接费用是否适用于队列和主题/订阅？
是的。 使用 HTTP 发送事件没有连接费用，无论发送系统或设备的数量是多少。 使用超时值大于零的 HTTP 接收事件（有时称为“长轮询”）会产生中转连接费用。 无论连接是用于发送还是接收，AMQP 连接都会产生中转连接费用。 请注意，100 个中转连接在基本命名空间中免费。 这也是 Azure 订阅允许的中转连接的最大数量。 在 Azure 订阅中，所有“标准”命名空间内的前 1,000 个中转连接都是免费提供的（不包括在基础费用内）。 由于这些限额足以涵盖许多服务到服务方案，因此通常仅当你打算对大量客户端使用 AMQP 或 HTTP 长轮询时，即，想要实现更高效的事件流或者启用许多设备或应用程序实例的双向通信时，中转连接费用才会变得可观。

## <a name="next-steps"></a>后续步骤
* 有关服务总线定价的完整详细信息，请参阅[服务总线定价页](https://azure.microsoft.com/pricing/details/service-bus/)。
* 有关服务总线定价和计费的一些常见问题解答，请参阅[服务总线常见问题解答](service-bus-faq.md#pricing)。

[Azure portal]: https://portal.azure.com

