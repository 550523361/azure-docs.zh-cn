---
title: 内置&自定义警报列表
description: 使用 Azure 安全中心了解安全警报和建议的修复功能。
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: a5c25cba-59a4-488b-abbe-c37ff9b151f9
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/04/2020
ms.author: mlottner
ms.openlocfilehash: 74a6adbd2415cfcf7d5d48cff01d189cfd8b73a5
ms.sourcegitcommit: 7e04a51363de29322de08d2c5024d97506937a60
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81311488"
---
# <a name="azure-security-center-for-iot-security-alerts"></a>用于 IoT 安全警报的 Azure 安全中心

IoT Azure 安全中心使用高级分析和威胁情报持续分析 IoT 解决方案，以提醒您注意恶意活动。
此外，您可以根据您对预期设备行为的了解创建自定义警报。
警报充当潜在危害的指示器，应进行调查和修正。

在本文中，您将找到可在 IoT 中心和/或 IoT 设备上触发的内置警报的列表。
除了内置警报外，IoT Azure 安全中心还允许您根据预期的 IoT 中心和/或设备行为定义自定义警报。
有关详细信息，请参阅[可自定义的警报](concept-customizable-security-alerts.md)。

## <a name="built-in-alerts-for-iot-devices"></a>IoT 设备的内置警报

| 名称 | 严重性 | 数据源 | 描述 | 建议的补救步骤|
|----------|---------------|-------------|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|**高度**严重性|  |  |  |
|   二进制命令行   | 高 | 代理 | 检测到从命令行调用/执行的 LA Linux 二进制文件。 此过程可能是合法活动，或表示您的设备已受到威胁。|   与运行该命令的用户一起查看该命令，并检查此命令是否合法预期在设备上运行。 如果没有，请将警报上报给信息安全团队。 |
|   禁用防火墙   | 高                                      | 代理       | 检测到主机上防火墙的可能操作。 恶意参与者经常禁用主机上的防火墙，以尝试泄露数据。|  与运行该命令的用户一起查看，以确认这是否是合法的设备上的预期活动。 如果没有，请将警报上报给信息安全团队。 |
|   端口转发检测   | 高| 代理  | 启动端口转发到检测到的外部 IP 地址。|  如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。 |
|   可能尝试禁用检测到的已审核日志记录   | 高 | 代理       | Linux 审核系统提供了一种跟踪系统上安全相关信息的方法。 系统记录尽可能多的有关系统上发生的事件的信息。 此信息对于任务关键型环境至关重要，无法确定谁违反了安全策略及其执行的操作。 禁用审核日志记录可能会阻止您发现违反系统上使用的安全策略。 |如果出于业务原因，请与设备所有者核实这是否是合法的活动。 如果不是，此事件可能是恶意参与者隐藏活动。 立即将事件上报给信息安全团队。|
|   反向壳   | 高 | 代理 | 分析设备上的主机数据检测到潜在的反向外壳。 反向外壳通常用于让受攻击的计算机回调到由恶意参与者控制的机器中。|  如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。  |
|  成功进行布鲁斯特尝试   | 高  | 代理       | 已识别多个不成功的登录尝试，然后成功登录。 尝试的布鲁特部队攻击可能在设备上成功。 | 查看 SSH 布鲁特力警报和设备上的活动。 <br>如果活动是恶意的：<br> 为受攻击帐户推出密码重置。<br> 调查并修复（如果找到）恶意软件的设备。  |
|  成功本地登录   |   高                           | 代理       | 检测到设备的本地登录成功 | 确保登录用户是授权方。  |
|   Web 外壳   | 高 | 代理 | 检测到可能的 Web 外壳。 恶意参与者通常会将 Web shell 上载到受攻击的计算机，以获得持久性或进一步利用。|  如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。 |
|**中等**严重性|  |  |  |
|   检测到的行为与常见的 Linux 机器人类似 | 中型| 代理 | 检测到通常与常见 Linux 僵尸网络关联的进程的执行。| 如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。 |
|  检测到的行为类似于公平软件勒索软件  | 中型 | 代理       | 使用分析主机数据检测到的对可疑位置的 rm-rf 命令的执行。 由于 rm-rf 递归删除文件，因此通常仅在离散文件夹中使用。 在这种情况下，它用于可以删除大量数据的位置。 众所周知，公平软件勒索软件可以在此文件夹中执行 rm-rf 命令。 |与运行命令的用户一起查看这是您希望在设备上看到的合法活动。 如果没有，请将警报上报给信息安全团队。
|  检测到与勒索软件类似的行为  | 中型 | 代理       | 执行类似于已知勒索软件的文件，这些文件可能会阻止用户访问其系统或个人文件，并可能要求支付赎金以重新获得访问权限。|如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|   检测到隐硬币矿工容器图像 | 中型                   | 代理       | 容器检测正在运行的已知数字货币挖掘图像。 |  1. 如果此行为不是有意的，请删除相关的容器映像。<br> 2. 确保 Docker 守护进程无法通过不安全的 TCP 插槽访问。<br> 3. 将警报上报给信息安全团队。|
|  加密硬币矿工图像  | 中型| 代理       | 检测到通常与数字货币挖掘关联的进程的执行。| 与运行该命令的用户确认这是设备上的合法活动。 如果没有，请将警报上报给信息安全团队。|
|   检测到可疑使用 nohup 命令 | 中型 | 代理       | 检测到主机上的 nohup 命令的可疑使用。 恶意参与者通常从临时目录中运行 nohup 命令，从而有效地允许其可执行文件在后台运行。 看到此命令在位于临时目录中的文件上运行是预料之中的，也不是通常的行为。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|   检测到用户添加命令的可疑使用  | 中型      | 代理       | 在设备上检测到的用户添加命令的可疑使用。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  通过 TCP 套接字公开 Docker 守护进程  | 中型 | 代理 | 计算机日志指示 Docker 守护进程 （dockerd） 公开 TCP 套接字。 默认情况下，Docker 配置在启用 TCP 套接字时不使用加密或身份验证。 默认 Docker 配置允许有权访问相关端口的任何人完全访问 Docker 守护进程。|如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  本地登录失败  | 中型 | 代理       | 检测到设备的本地登录尝试失败。 |确保没有未经授权的方对设备具有物理访问权限。|
|  检测到从已知恶意源下载文件   | 中型  | 代理       |  从检测到的已知恶意软件源下载文件。|如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|   检测到 htaccess 文件访问 | 中型                       | 代理       | 分析主机数据检测到可能操作 htaccess 文件。 Htaccess 是一个强大的配置文件，允许您对运行 Apache Web 软件的 Web 服务器进行多次更改，包括基本的重定向功能和更高级的功能，如基本密码保护。 恶意参与者经常修改受攻击计算机上的 htaccess 文件以获得持久性。 |确认这是主机上的合法预期活动。 如果没有，请将警报上报给信息安全团队。|
|  已知攻击工具  | 中型                                   | 代理       | 检测到通常与恶意用户以某种方式攻击其他计算机相关的工具。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。|
|  IoT 代理尝试分析模块孪生配置，但失败 | 中型  | 代理       | 由于配置对象中的类型不匹配，IoT 安全代理的 Azure 安全中心未能解析模块孪生配置|根据 IoT 代理配置架构验证模块孪生配置，修复所有不匹配。
|  检测到本地主机侦察  | 中型 | 代理       | 执行通常与检测到的常见 Linux 机器人侦察关联的命令。 |检查可疑命令行以确认该命令行是由合法用户执行的。 如果没有，请将警报上报给信息安全团队。
|  脚本解释器和文件扩展名不匹配  | 中型 | 代理       | 脚本解释器与检测到输入时提供的脚本文件的扩展名不匹配。 这种类型的不匹配通常与攻击者脚本执行相关联。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  检测到可能的后门  | 中型 | 代理 |下载了可疑文件，然后在订阅中的主机上运行。 这种类型的活动通常与后门的安装相关联。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
| 检测到的潜在数据丢失  | 中型 | 代理 | 使用分析主机数据检测到的可能数据出口条件。 恶意参与者经常从受攻击的计算机中获取数据。|如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  公共文件的潜在重写 | 中型  | 代理 | 在设备上覆盖的常见可执行文件。 众所周知，恶意参与者会覆盖公共文件，以隐藏其操作或获取持久性。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|   检测到特权容器 | 中型 | 代理       | 计算机日志指示特权 Docker 容器正在运行。 特权容器具有对主机资源的完全访问权限。 如果受到攻击，恶意参与者可以使用特权容器访问主机。|如果容器不需要在特权模式下运行，请从容器中删除权限。
| 删除检测到的系统日志文件  | 中型 | 代理       | 检测到主机上日志文件的可疑删除。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  文件名后的空间  | 中型| 代理 | 使用分析主机数据检测到可疑扩展的进程的执行。 可疑的扩展可能会诱使用户认为文件是安全的打开，并可能指示系统上存在恶意软件。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  检测到可疑的恶意凭据访问工具  | 中型 | 代理       | 检测通常与恶意尝试访问凭据关联的工具的使用情况。 |  如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。|
|   检测到可疑编译 | 中型  | 代理       | 检测到可疑编译。 恶意参与者通常会在受攻击的计算机上编译漏洞，以升级特权。  |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。
|  可疑文件下载后跟文件运行活动  | 中型| 代理| 对主机数据的分析检测到在同一命令中下载和运行的文件。 恶意参与者通常使用此技术将受感染的文件连接到受害者计算机。 |如果这是您希望在设备上看到的合法活动，则与运行该命令的用户一起查看。 如果没有，请将警报上报给信息安全团队。|
|  可疑的 IP 地址通信 | 中型  | 代理       | 检测到与可疑 IP 地址的通信。 |验证连接是否合法。 请考虑阻止与可疑 IP 的通信。 |
|**低**严重性|  |  |  |
|    Bash 历史记录已清除   | 低                                  | 代理       | 已清除 Bash 历史记录日志。 恶意参与者通常擦除 bash 历史记录，以隐藏自己的命令，防止它们出现在日志中。 |与运行该命令的用户一起查看此警报中的活动，以查看您是否认识到这是合法的管理活动。 如果没有，请将警报上报给信息安全团队。
|   设备静音    | 低 | 代理       | 设备在过去 72 小时内未发送任何遥测数据。|确保设备处于联机状态并发送数据。 检查 Azure 安全代理是否在设备上运行。|
|  失败的布鲁斯特强制尝试 | 低 | 代理       | 已识别多个不成功的登录尝试。 设备上的潜在暴力攻击尝试失败。 |查看 SSH 布鲁特力警报和设备上的活动。 无需进一步的操作。|
|  本地用户添加到一个或多个组 | 低                            | 代理     | 添加到此设备上的组的新本地用户。 对用户组的更改并不常见，并且可能表示恶意参与者可能正在收集其他权限。|  验证更改是否符合受影响用户所需的权限。 如果更改不一致，请上报至您的信息安全团队。  |
|  从一个或多个组中删除的本地用户 | 低                            | 代理     | 本地用户从一个或多个组中删除。 已知恶意参与者使用此方法试图拒绝对合法用户的访问或删除其操作的历史记录。|  验证更改是否符合受影响用户所需的权限。 如果更改不一致，请上报至您的信息安全团队。  |
|  检测到本地用户删除 | 低                            | 代理     | 检测到本地用户的删除。 本地用户删除并不常见，恶意参与者可能试图拒绝访问合法用户或删除其操作的历史记录。|  验证更改是否符合受影响用户所需的权限。 如果更改不一致，请上报至您的信息安全团队。  |

## <a name="built-in-alerts-for-iot-hub"></a>IoT 中心内置警报

| 严重性 | 名称                                                                         | 说明 | 建议的补救措施|
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
|**中等**严重性|  |  |  |
|  添加到 IoT 中心的新证书  | 中型                                     |名为\'%[证书证书名称]\'的证书已添加到 IoT\'中心 %[DescIoTHubName]\'。 如果此操作是由未经授权的方进行的，则可能表示存在恶意活动。| 1. 确保证书是由授权方添加的。 <br> 2. 如果授权方未添加证书，请删除证书并将警报上报给组织安全团队。  |
|  从 IoT 中心中删除的证书  | 中型                             | 名为\'%[Desc 证书名称]\'的证书从 IoT\'中心 %[DescIoTHubName]\'中删除。 如果此操作是由未经授权的方进行的，则可能表示存在恶意活动。| 1. 确保证书已被授权方删除。 <br> 2. 如果授权方未删除证书，请重新添加证书，并将警报上报给组织安全团队。 |
| 检测到将证书添加到 IoT 中心的尝试失败   | 中型    | 尝试将\'证书 %[Desc 证书名称\'] 添加到 IoT 中心\'%[DescIoTHubName]\'时，尝试失败。 如果此操作是由未经授权的方进行的，则可能表示存在恶意活动。|   确保仅向授权方授予更改证书的权限。  |
|  检测到从 IoT 中心中删除证书的尝试失败 | 中型  | 尝试从\'IoT 中心\'\'%[DescIoTHubName] 中删除证书 %[Desc 证书名称\']未成功。 如果此操作是由未经授权的方进行的，则可能表示存在恶意活动。 |确保仅向授权方授予更改证书的权限。|
|  x.509 设备证书指纹不匹配  | 中型           | x.509 设备证书指纹与配置不匹配。 |查看设备上的警报。 无需进一步的操作。 |
| x.509 证书过期  | 中型 |X.509 设备证书已过期。 |  这可能是具有过期证书或尝试模拟合法设备的合法设备。 如果合法设备当前通信正确，则可能是模拟尝试。 |
|**低**严重性|  |  |  |
|   尝试添加或编辑检测到的 IoT 中心诊断设置   | 低     | 已尝试添加或编辑 IoT 中心的诊断设置。 诊断设置使您能够在发生安全事件或网络受到威胁时重新创建活动跟踪以进行调查。 如果此操作不是由授权方进行的，则可能表示存在恶意活动。  |1. 确保证书已被授权方删除。<br> 2. 如果授权方未删除证书，请重新添加证书并将警报上报给信息安全团队。
|   尝试从检测到的 IoT 中心中删除诊断设置        | 低      | 有 %[Desc尝试状态消息]\'尝试添加或编辑 IoT\'中心 %[Desc\'诊断设置名称]\'的 IoT 中心 %[DescIoTHubName]\'。 通过诊断设置，在发生安全事件或网络受到威胁时，您可以重新创建活动跟踪以进行调查。 如果此操作不是由授权方进行的，则可能表示存在恶意活动。 |确保仅向授权方授予更改诊断设置的权限。|
|   过期的 SAS 令牌    | 低  |  设备使用的过期 SAS 令牌 |可能是具有过期令牌的合法设备，或尝试模拟合法设备。 如果合法设备当前通信正确，则可能是模拟尝试。|
|  无效的 SAS 令牌签名 | 低 | 设备使用的 SAS 令牌具有无效的签名。 签名与主键或辅助键不匹配。|  查看设备上的警报。 无需进一步的操作。  |
|

## <a name="next-steps"></a>后续步骤

- 用于 IoT 服务[概述](overview.md)的 Azure 安全中心
- 了解如何[访问安全数据](how-to-security-data-access.md)
- 了解有关[调查设备的信息](how-to-investigate-device.md)
