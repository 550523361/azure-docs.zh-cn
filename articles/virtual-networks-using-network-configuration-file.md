<properties 
	pageTitle="使用网络配置文件配置虚拟网络" 
	description="有关通过 Azure 管理门户导出和导入网络配置文件以创建或修改虚拟网络的说明。 " 
	services="virtual-network" 
	documentationCenter="" 
	authors="cherylmc" 
	manager="adinah" 
	editor="tysonn"/>
	
<tags ms.service="virtual-network" ms.date="02/18/2015" wacn.date="04/11/2015"/>


# 使用网络配置文件配置虚拟网络

## 概述

若要配置虚拟网络，你可以使用管理门户向导，也可以创建并导入网络配置文件。Azure 使用网络配置文件来定义你的虚拟网络设置。 

你可能更愿意使用管理门户向导来开始创建虚拟网络配置，然后通过直接编辑配置文件进行后续更改。例如，如果你要为不同的订阅配置多个虚拟网络，则可能需要先使用管理门户向导创建网络配置文件。然后，你就可以导出该文件，将其用作模板，对其进行编辑以指定不同的设置，最后再将该文件导回管理门户。当你有多个订阅时，可以使用这种方法来有效地创建多个虚拟网络。 

或者，如果你想要先对网络配置设置进行更改，然后再将云服务或虚拟机部署到网络中，你可以导出该文件，对其进行编辑，然后再将其导回 Azure。网络配置文件还可用于备份网络配置设置，如果你想要重新创建虚拟网络的话。

## 创建和修改网络配置文件 
编写网络配置文件的最简单方法是将网络设置从现有虚拟网络配置中导出，然后修改该文件，使之包含需要为你的虚拟网络配置的设置。你也可以获取一个示例文件，然后对其进行修改。

若要编辑网络配置文件，只需直接打开该文件，对其进行相应的更改，然后保存即可。你可以使用任何 *xml* 编辑器来更改网络配置文件。 

应严格遵循网络配置文件架构设置指南。编写网络配置文件时，文件中的设置将覆盖你当前拥有的该订阅在 Azure 中的设置。如果更改文件中不符合设置准则的值，则你虚拟网络的配置方式可能不是你想要的，而且在某些情况下，Azure 将不允许你导入该文件。有关网络配置文件中包含的特定设置的信息，请参阅 [Azure 虚拟网络配置架构](https://msdn.microsoft.com/zh-CN/library/azure/jj157100.aspx)。 

Azure 会将其上部署有项目的子网视为"已使用"。当某个子网处于已使用中时，不能对其进行修改。在修改之前，请将已部署到子网的任何内容移动到不会进行修改的其他子网。   请参阅[将 VM 或角色实例移到其他子网](https://msdn.microsoft.com/zh-CN/library/azure/dn643636.aspx)。



## 使用管理门户导出和导入虚拟网络设置  
你可以使用 PowerShell 或管理门户导入和导出包含在网络配置文件中的网络配置设置。下面的说明将帮助你使用管理门户进行导出和导入。 

### 导出你的网络设置
在导出时，你订阅中虚拟网络的所有设置都将写入一个 .xml 文件。 

1. 登录到**管理门户**。
2. 在管理门户的**"网络"**页的底部，单击**"导出"**。 
3. 在**"导出网络配置"**窗口中，验证是否已选中需要为其导出你的网络设置的订阅。然后，单击右下角的复选标记。 
4. 遇到提示时，将 *NetworkConfig.xml* 文件保存到所选位置。
### 导入你的网络设置


1. 在**"管理门户"**左下的导航窗格中，单击**"新建"**。
2. 单击**"网络服务"**->**"虚拟网络"**->**"导入配置"**。
3. 在**"导入网络配置文件"**页上，浏览到你的网络配置文件，然后单击**"下一步"**箭头。
4. 在**"构建你的网络"**页上，你会在屏幕上看到相关信息，显示将更改或创建你网络配置的哪些部分。如果所做的更改在你看来是正确的，请单击复选标记以继续更新或创建你的虚拟网络。 


## 其他资源
有关虚拟网络的详细信息，请参阅：

-  [虚拟网络概述](https://msdn.microsoft.com/zh-CN/library/windowsazure/jj156007.aspx)
-  [网络配置架构 - 云服务的可选设置](https://msdn.microsoft.com/zh-CN/library/azure/jj156091.aspx)
-  [关于管理门户中的虚拟网络设置](https://msdn.microsoft.com/zh-CN/library/azure/jj156074.aspx)
-  [虚拟网络常见问题解答](https://msdn.microsoft.com/zh-CN/library/azure/dn133803.aspx)
-  [虚拟网络配置任务](https://msdn.microsoft.com/zh-CN/library/azure/jj156206.aspx)
-  [配置多站点 VPN](https://msdn.microsoft.com/zh-CN/library/azure/dn690124.aspx)
-  [配置 VNet 到 VNet 连接](https://msdn.microsoft.com/zh-CN/library/azure/dn690122.aspx)





<!--HONumber=51-->