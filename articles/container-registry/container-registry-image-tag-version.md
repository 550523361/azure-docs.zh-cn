---
title: Azure 容器注册表中的标记和版本映像
description: 用于标记和版本管理 Docker 容器映像的最佳做法
services: container-registry
author: stevelasker
ms.service: container-registry
ms.topic: article
ms.date: 07/10/2019
ms.author: steve.lasker
ms.openlocfilehash: bd00fd4f8dd247c766eb34849ecf9de603c5171b
ms.sourcegitcommit: 66237bcd9b08359a6cce8d671f846b0c93ee6a82
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/11/2019
ms.locfileid: "67800388"
---
# <a name="recommendations-for-tagging-and-versioning-container-images"></a>建议用于标记和版本控制容器映像

当将部署容器映像推送到容器注册表并再将其部署，您将需要一个策略，为图像标记和版本控制。 本文介绍了两种方法和每个容器生命周期内适当的位置：

* **稳定的标记**的标记的重复使用，例如，若要指示主要或次要版本，如*mycontainerimage:1.0*。
* **唯一的标记**-每个映像推送到注册表，如不同的标记*mycontainerimage:abc123*。

## <a name="stable-tags"></a>稳定的标记

**建议**：使用稳定的标记来维护**基本映像**为容器版本。 避免具有稳定的标记，部署，因为这些标记继续接收更新，并且可能会引入生产环境中的存在不一致。

*稳定的标记*意味着开发人员或生成系统，可以继续提取特定的标记，它将继续以获取更新。 稳定并不意味着内容均已冻结。 而是稳定意味着图像应是稳定的该版本的意图。 若要保持"稳定"，它可能会提供服务来应用安全修补程序或框架更新。

### <a name="example"></a>示例

Framework 团队提供版本 1.0。 他们知道它们将提供更新，包括次要更新。 若要支持给定的主版本号和次版本的稳定的标记，它们具有两个集的稳定的标记。

* `:1` – 主版本的稳定标记。 `1` 表示"最新"或"最新"1.* 版本。
* `:1.0`-版本 1.0，允许开发人员将绑定到值为 1.0，更新并不进行前滚到 1.1 发布的稳定标记。

该团队还使用`:latest`标记，它指向最新稳定标记，无论什么是当前主版本。

当有基本映像更新，或任何类型的服务的框架，使用稳定的标记的映像的发布更新为表示该版本的最新稳定版本的最新摘要。

在这种情况下，主版本号和次标记是不断正在提供服务。 从基本映像的情况下，这允许要提供服务的图像的图像所有者。

## <a name="unique-tags"></a>唯一的标记

**建议**：使用特定的标记**部署**，尤其是在一个环境，可以缩放多个节点上。 你可能想有意部署的组件的一致版本。 如果容器将重新启动或业务流程协调程序横向扩展更多实例，您的主机不会意外地拉较新版本，与其他节点不一致。

唯一标记只是意味着每个图像推送到注册表具有唯一的标记。 标记不会重复使用。 有几种模式可以按照生成唯一的标记，包括：

* **日期时间戳**-由于可以清楚地告知生成映像时，这种方法是相当常见。 但是，如何将它返回到您的生成系统相关联？ 你是否要查找的已完成在同一时间生成？ 您在哪个时区？ 为校准为 UTC 的所有生成系统？
* **Git 提交**– 这种方法有效，直到您开始支持基本映像更新。 基本映像更新发生时，如果您的生成系统启动了与作为上一个生成相同的 Git 提交。 但是，基本映像包含新内容。 一般情况下，提供了 Git 提交*semi*-稳定的标记。
* **清单摘要**-每个容器映像推送到容器注册表是关联具有一个清单，标识由唯一的 SHA-256 哈希或摘要。 唯一的而摘要很长，难以阅读，且不与你的生成环境相关。
* **生成 ID** -由于有可能，此选项可能是最佳增量，并且可以用于关联回特定生成来查找所有项目和日志。 但是，如清单摘要中，可能很难读。

  如果你的组织有多个生成系统，前缀的标记与生成系统名称是此选项的变体： `<build-system>-<build-id>`。 例如，您无法区分生成 API 团队的 Jenkins 生成系统和 web 团队的 Azure 管道生成系统。

## <a name="next-steps"></a>后续步骤

在本文中的概念的更多详细讨论，请参阅博客文章[Docker 标记：标记和版本控制的 docker 映像的最佳做法](https://stevelasker.blog/2018/03/01/docker-tagging-best-practices-for-tagging-and-versioning-docker-images/)。

若要帮助最大化性能和经济高效地利用 Azure 容器注册表，请参阅[为 Azure 容器注册表的最佳做法](container-registry-best-practices.md)。

<!-- IMAGES -->


<!-- LINKS - Internal -->

