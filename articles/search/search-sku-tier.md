---
title: 选择 Azure 搜索服务的定价层或 SKU - Azure 搜索
description: 这些 Sku 中，可以预配 azure 搜索：免费、 基本和标准版和标准是在各种资源配置和容量级别中可用。
services: search
author: HeidiSteen
manager: cgronlun
tags: azure-portal
ms.service: search
ms.topic: conceptual
ms.date: 05/08/2019
ms.author: heidist
ms.custom: seodec2018
ms.openlocfilehash: 00422209302bbcc2139be4f6b490f0bb2816c051
ms.sourcegitcommit: f6c85922b9e70bb83879e52c2aec6307c99a0cac
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/11/2019
ms.locfileid: "65539293"
---
# <a name="choose-a-pricing-tier-for-azure-search"></a>选择 Azure 搜索的定价层

当你将创建 Azure 搜索服务[创建资源](search-create-service-portal.md)在定价层或 SKU 的服务的生存期内固定的。 层包括免费、 基本、 标准和存储优化。 标准和存储优化了可在多个配置和容量。

大多数客户开始使用免费层，因此它们可以评估该服务。 然后升级到更高的层用于开发和生产部署之一。 可以使用免费层，包括为占用大量资源的认知搜索的完成所有快速入门和教程。

> [!NOTE]
> Microsoft 当前提供的测试和试验，其目的是收集反馈折扣价格在预览中的存储优化服务层。 确定最终定价将在以后宣布这些层通常不可用时。 建议不要对生产应用程序使用这些层。

层反映托管服务（而不是功能）的硬件的特征，并按以下标准进行区分：

+ 您可以创建的索引数。
+ 大小和速度的分区 （物理存储）。

虽然所有层，包括免费层中，通常都提供功能奇偶一致性，但更大工作负荷可以决定需要更高的层。 例如， [AI 索引使用认知服务](cognitive-search-concept-intro.md)只有在运行时间较长的技能时超时上一项免费服务的数据集很小。

> [!NOTE] 
> 功能奇偶校验的例外是[索引器](search-indexer-overview.md)，这不是在 S3 HD 上可用。
>

在层中，你可以[调整副本和分区资源](search-capacity-planning.md)来增大或减小规模。 无法开始使用一个或两个每个，则暂时提出繁重的索引工作负荷对计算能力。 在层中优化资源级别的功能可以增大灵活性，但也会略微增大分析的复杂性。 您可能需要试验，看看包含更多的资源副本的较低层提供更好的值和性能更高的层较少的资源。 若要详细了解何时以及为何调整容量，请参阅[性能和优化注意事项](search-performance-optimization.md)。

## <a name="tiers-for-azure-search"></a>Azure 搜索的层

下表列出了可用的层。 您可以找出有关各层的详细信息上[定价页](https://azure.microsoft.com/pricing/details/search/)，在[Azure 搜索中的服务限制](search-limits-quotas-capacity.md)文章，并在门户页上，当正在预配服务。

|层 | 容量 |
|-----|-------------|
|免费 | 与其他订阅者共享。 不可扩展。 限制为三个索引和 50MB 的存储空间。 |
|基本 | 对于规模较小的生产工作负荷的专用计算资源。 一个 2 GB 的分区和最多三个副本。 |
|标准 1 (S1) | 适用于 S1 和更高版本的专用机具有的每个级别的更多存储和处理容量。 适用于 S1，分区大小是 25 GB/分区 （含有最多 300 GB 的每个服务）。 |
|标准 2 (S2) | 类似于 S1，但对 100 GB 分区 （和每个服务最多 1.2 TB）。 |
|标准 3 (S3) | 200 GB （与每个服务最多 2.4 tb） 的分区。 |
|标准 3 高密度 (S3 HD) | 高密度就*托管模式下*适用于 S3。 基础硬件的大量较小索引的优化，并且适用于多租户方案。 S3 HD 具有相同的每个单位费用，因为 S3，但在硬件上大量的较小索引的文件快速读取针对进行了优化。|
|存储优化 1 (L1) | 1 TB （与每个服务最多为 12 TB） 的分区。 |
|存储优化 2 (L2) | 2 TB （与每个服务最多为 24 TB） 的分区。 |

> [!NOTE] 
> 存储优化层还提供更大的存储容量，以更低价格每 TB 比标准层。 主要弊端是更高的查询延迟，应验证的特定应用程序的要求。  若要了解有关此层的性能注意事项的详细信息，请参阅[性能和优化注意事项](search-performance-optimization.md)。
>

## <a name="how-billing-works"></a>计费原理

有三种方法产生费用在 Azure 搜索中，并且没有固定和可变的组件。 本部分介绍三个计费组件： 核心服务成本，数据传出费用和 AI 丰富的索引。

### <a name="core-service-costs-fixed-and-variable"></a>核心服务成本 （固定和可变）

服务本身，最小的费用是第一个搜索单位 （1 个副本 x 1 分区）。 因为服务无法运行任何小于此配置，此最小值被固定的服务的生命周期。

超出最小值，您可以添加副本和分区独立。 例如，您可以只添加副本或仅分区。 通过副本和分区的容量中的增量增加对可变成本组件组成。

计费基于[公式 (副本分区 x 速率)](#search-units)。 你支付的费率取决于您选择的定价层。

在以下屏幕截图中，免费、 基本版和 S1 中为指定的单位定价。 （S2、 S3、 L1 和 L2 不会显示。）如果您创建一个基本的服务，你每月的成本将平均为显示的值*价格 1*。 对于标准服务，你每月的成本将平均为显示的值*价格 2*。 每个层的单位成本增加，因为计算能力和存储容量大于在每个连续层。 Azure 搜索的费率是可在上找到[Azure 搜索定价页](https://azure.microsoft.com/pricing/details/search/)。

![每个单元定价](./media/search-sku-tier/per-unit-pricing.png "每个单元定价")

在估计搜索解决方案的成本时，请记住，定价和容量不是线性。 （双倍的容量超过两倍，成本。）有关如何使用公式的工作原理的示例，请参阅[如何分配副本和分区](search-capacity-planning.md#how-to-allocate-replicas-and-partitions)。

#### <a name="billing-based-on-search-units"></a>计费基于搜索单位

若要了解有关 Azure 搜索操作的最重要的计费概念是*搜索单位*(SU)。 由于 Azure 搜索必须同时使用副本和分区进行索引编制和查询，因此无法按其中的一个进行计费。 相反，应基于两者的组合来计费。

SU 是乘积*副本*并*分区*由服务：**(R x P = SU)**.

每个服务至少从 1 个 SU（1 个分区乘以 1 个副本）开始。 任何服务的最大值为 36 个 Su。 可以通过多种方式达到此最大值：6 分区 x 6 副本或 3 个分区 x 12 副本。 它是通常使用小于总容量 （例如，3 副本、 3 分区服务按 9 个 Su 计费）。 请参阅[分区和副本组合](search-capacity-planning.md#chart)有关有效的组合的图表。

每个 SU 计费费率为每小时。 每个层都有逐步提高的速率。 更高的层附带更大和速度分区，这可能会导致针对该等级的整体较高的小时费率。 您可以为每个层的费率[定价详细信息](https://azure.microsoft.com/pricing/details/search/)页。

大多数客户只是联机使用一部分总容量，将剩余的容器保持预留状态。 对于帐单、 分区和副本联机，自带的数通过 SU 计算公式，确定按小时付费。

### <a name="data-egress-charges-during-indexing"></a>在索引期间的数据传出费用

使用[Azure 搜索索引器](search-indexer-overview.md)可能会影响计费，具体取决于你的服务位置。 如果在你的数据所在的同一区域中创建 Azure 搜索服务，则可以消除数据传出费用。 下面是一些信息从[带宽定价页](https://azure.microsoft.com/pricing/details/bandwidth/):

+ Microsoft 不会收取任何入站数据传输到 Azure 上的任何服务的任何出站数据; 二是从 Azure 搜索。

+ 在多业务解决方案中，是免费的跨网络传输时的所有服务都都在同一区域中的数据。

如果服务是在不同区域中，对出站数据收取费用。 这些费用不是实际的 Azure 搜索帐单的一部分。 因为如果您使用的数据或 AI 丰富索引器提取数据从不同的区域，您将看到反映在总费用的成本，它们是此处提及。

### <a name="ai-enriched-indexing-with-cognitive-services"></a>AI 强化索引使用认知服务

有关[AI 索引使用认知服务](cognitive-search-concept-intro.md)，您应计划要附加 Azure 搜索中，与即用即付处理的 S0 定价层位于同一区域中的可计费的 Azure 认知服务资源。 没有固定的成本与附加认知服务相关联。 仅为所需的处理付费。

图像提取中的，在文档破解是 Azure 搜索费用。 这将根据从文档中提取的映像数进行收费。 文本提取目前是免费的。

基于自然语言处理等其他正[内置认知技能](cognitive-search-predefined-skills.md)和收费所依据的认知服务资源。 这些相同的费率计费像已直接使用认知服务来执行该任务。 有关详细信息，请参阅[将附加具有技能组合的认知服务资源](cognitive-search-attach-cognitive-services.md)。

<a name="search-units"></a>

#### <a name="billing-for-image-extraction-in-cognitive-search"></a>认知搜索中图像提取的计费

如果您从认知搜索索引管道中的文件中提取映像，将你收取该操作在你的 Azure 搜索账单。 在中[索引器配置](https://docs.microsoft.com/rest/api/searchservice/create-indexer#indexer-parameters)， **imageAction**是触发图像提取的参数。 如果**imageAction**设置为"none"（默认值），则不会收取图像提取。

定价可能会发生更改。 上记录[定价详细信息](https://azure.microsoft.com/pricing/details/search/)Azure 搜索的页。

#### <a name="billing-for-built-in-skills-in-cognitive-search"></a>认知搜索中内置技能的计费

设置扩充管道时，该管道中使用的任何[内置技能](cognitive-search-predefined-skills.md)基于机器学习模型。 认知服务提供这些模型。 如果在索引期间使用这些模型，则将收费相同的费率而这是如果直接请求了资源。

例如，假设有针对扫描的 JPEG 文件使用光学字符识别 (OCR) 的管道，并且生成的文本自由的搜索查询推送到 Azure 搜索索引。 索引管道将包含一个带有 [OCR 技能](cognitive-search-skill-ocr.md)的索引器，而该技能将[附加到认知服务资源](cognitive-search-attach-cognitive-services.md)。 当您运行索引器时，OCR 执行的费用将显示在认知资源帐单上。

## <a name="tips-for-reducing-costs"></a>有关降低成本的提示

无法关闭服务以缩短你的帐单。 专用的资源始终处于正常运行，供您使用您的服务的生存期内已分配。 降低你的帐单的唯一方法是减少到仍提供了可接受的性能级别的副本和分区并[SLA 的遵从性](https://azure.microsoft.com/support/legal/sla/search/v1_0/)。

降低成本的一种方法是选择较低的每小时速率层。 S1 的每小时费率低于 S2 或 S3 的费率。 假设你设置你的服务的负载投影较低的末尾，如果无限的服务，你可以创建第二个更大分层服务、 重建索引上的第二个服务，然后删除第一个。

如果您曾经在本地服务器的容量规划，您知道很常见"购买"以便你可处理预期的增长。 与云服务，您可以主动详细的成本节约追踪因为您可以随时更改的特定购买的。 如果当前不理想时，始终可以切换到更高的分层服务。

### <a name="capacity"></a>容量

在 Azure 搜索中，容量的结构包括副本和分区。

+ 副本是搜索服务的实例。 每个副本托管索引的一个负载平衡的副本。 例如，具有六个副本的服务具有在服务中加载每个索引的六个副本。

+ 分区存储索引和自动拆分可搜索的数据。 两个分区拆分下半部分中的索引、 三个分区将其拆分为折，依次类推。 在容量方面*分区大小*是在层之间的主要区别性功能。

> [!NOTE]
> 所有标准和存储优化层都支持[副本和分区的弹性组合](search-capacity-planning.md#chart)以便可以[优化您的系统的速度或存储](search-performance-optimization.md)通过更改余额。 基本级别提供最多三个副本以实现高可用性，但只有一个分区。 免费层不提供专用的资源： 计算资源由多个订阅者共享。

### <a name="more-about-service-limits"></a>有关服务限制的详细信息

服务主机资源，如索引和索引器。 每个层施加[的服务限制](search-limits-quotas-capacity.md)上可以创建的资源数量。 因此，索引 （和其他对象） 的最大数目是在层之间的第二个区别性功能。 查看门户中的每个选项，请注意上的索引数限制。 其他资源，例如索引器、 数据源和技术问题，即被附加到的索引限制。

## <a name="consumption-patterns"></a>消费模式

大多数客户开始使用免费服务，无限期地保留，并选择一个严重的开发或生产工作负荷的标准或存储优化层。

![Azure 搜索定价层](./media/search-sku-tier/tiers.png "Azure 搜索定价层")

两端下限和上限，基本和 S3 HD 是针对重要但非典型消耗模式。 Basic 是适用于小型生产工作负荷。 它提供 Sla，专用的资源和高可用性，但它提供了有限的存储，列在最在 2 GB 总大小。 此层被能够一致地无法充分利用可用容量的客户。 在高端，S3 HD 是适用于工作负荷的 Isv，典型的合作伙伴[多租户解决方案](search-modeling-multitenant-saas-applications.md)，或调用大量小索引的任何配置。 它通常是基本清除或 S3 HD 是合适的层。 如果你想确认，您可以发布到[堆栈溢出](https://stackoverflow.com/questions/tagged/azure-search)或[联系 Azure 支持人员](https://azure.microsoft.com/support/options/)有关的指南。

更常使用的标准层 S1 到 S3，构成了一系列级别逐渐提高的容量。 有折点上的分区大小和数量的索引、 索引器和必然资源的限制：

|  | S1 | S2 | S3 |  |  |  |  |
|--|----|----|----|--|--|--|--|
| 分区大小|  25 GB | 100 GB | 200 GB |  |  |  |  |
| 索引和索引器限制| 50 | 200 | 200 |  |  |  |  |

S1 是常见的客户而言，需要专用的资源和多个分区的选择。 S1 提供分区 25 gb 和最多 12 个分区，如果您最大限度地分区通过副本提供的每个服务限制为 300 GB。 (请参阅[分配分区和副本](search-capacity-planning.md#chart)的详细信息平衡分配。)

门户和定价页将焦点置于分区大小和存储，但对于每个层中，所有计算功能 （磁盘容量、 速度、 Cpu） 通常会在增加而呈线性增长的价格。 S2 副本是比 S1，更快地和 S3 的速度快于 S2。 S3 层使用带来不成比例更快的 I/O 中断线性计算定价模式。 如果您希望成为瓶颈的 I/O，请注意，可以获取更多 IOPS s3 不是使用较低层可以获得。

S3 和 S3 HD 受相同高容量基础结构，但在不同的方式达到其最大限制。 S3 面向较小数目的非常大的索引，因此其最大限制是资源限制型 (每个服务 2.4 TB)。 S3 HD 面向较大数目的非常小的索引。 在 1,000 个索引的情况下，S3 HD 达到其索引约束形式的限制。 如果 S3 HD 客户需要超过 1,000 个索引，请联系 Microsoft 支持获取有关如何继续的信息。

> [!NOTE]
> 文档限制是一个考虑因素，一次，但它们不再适用于新的服务。 文档限制仍适用的条件有关的信息，请参阅[记录限制](search-limits-quotas-capacity.md#document-limits)。
>

存储优化层，L1 和 L2，非常适用于具有较大的数据要求，但最终用户数相对较少的应用程序时最大程度减少查询延迟不是最高优先级。  

|  | L1 | L2 |  |  |  |  |  |
|--|----|----|--|--|--|--|--|
| 分区大小|  1 TB | 2 TB |  |  |  |  |  |
| 索引和索引器限制| 10 | 10 |  |  |  |  |  |

L2 提供了两次的总存储容量的 L1。  选择层基于最大您认为索引需要的数据量。 L1 层分区纵向扩展到最多为 12 TB 按 1 TB 的增量。 L2 分区增加每个分区最多 24 TB 的 2 Tb。

## <a name="evaluating-capacity"></a>评估容量

直接相关的容量和运行服务的成本。 层会施加限制在两个级别： 存储和资源。 您应该将有关这两因为首先达到的达到为准是有效的限制。

业务要求通常指示你将需要的索引数。 例如，可能会为文档的大型存储库需要全局索引。 或者，您可能需要根据区域、 应用程序或业务间隙的多个索引。

若要确定索引大小，必须[生成一个索引](search-create-index-portal.md)。 Azure 搜索中的数据结构是主要[倒排索引](https://en.wikipedia.org/wiki/Inverted_index)结构，它具有比源数据的不同特征。 对于倒排索引，大小和复杂性的内容，不一定由确定源到其中的数据量。 带有高冗余的大型数据源可能会导致比包含很大的变化内容的较小数据集较小索引。 因此很少可能推断出索引大小基于原始数据集的大小。

> [!NOTE] 
> 即使估计的索引和存储的未来需求可以感觉就像猜测，值得这样做。 如果层容量经证实过低，你将需要设置新的服务在更高的层，然后[重新加载索引](search-howto-reindex.md)。 从一个 SKU 的服务到另一个没有就地升级。
>

### <a name="step-1-develop-rough-estimates-by-using-the-free-tier"></a>步骤 1：使用免费层开发粗略的估计值

用于估计容量的一种方法是使用免费层开始。 请记住，免费服务提供了最多三个索引，50 MB 的存储，并创建索引时的 2 分钟。 极具挑战性的估计具有这些约束的预计的索引大小。 下面是可能需要一种方法：

+ [创建一项免费服务](search-create-service-portal.md)。
+ 准备的少量、 代表性数据集 （例如，5,000 文档和 10%的样本大小）。
+ [生成初始索引](search-create-index-portal.md)并记下其大小在门户中 (例如，30 MB)。

如果该示例是代表和整个数据源的 10%，30 MB 索引将成为大约 300 MB，如果所有文档编制都索引。 借助此初步的数字，可能会 double 预算以两个索引 （开发和生产） 的数量。 这使你总计的 600 MB 的存储要求。 因此您将从这里开始，基本层，轻松地满足此要求。

### <a name="step-2-develop-refined-estimates-by-using-a-billable-tier"></a>步骤 2：使用可计费级别开发改进的估算

有些客户更喜欢可以容纳更大的采样和处理时间且无需在开发过程中开发实际的索引数量、 大小和查询卷的估计值的专用资源开始。 最初，根据最佳猜测估计设置了服务。 然后，随着开发项目的逐渐成熟，团队通常可了解现有服务是否已过度或不足预计的生产工作负荷的容量。

1. [查看每个层的服务限制](https://docs.microsoft.com/azure/search/search-limits-quotas-capacity#index-limits)以确定较低层是否可以支持所需的索引数。 在基本、 S1 和 S2 层中，索引限制 15、 50 和 200，分别为。 存储优化层具有十个索引的限制，因为它旨在支持较低数目的非常大的索引。

1. [在可计费层中创建服务](search-create-service-portal.md)：

    + 启动较低，基本或 S1，如果您在学习曲线的开始处。
    + 启动高，在 S2 或 S3 甚至，如果知道想要大规模索引和查询负载也有不同。
    + 开始优化存储，在 L1 或 L2，如果索引大量的数据和查询负载是相对较低，为与内部业务应用程序。

1. [生成初始索引](search-create-index-portal.md)以确定将源数据转换为索引的方式。 这是估计索引大小的唯一方法。

1. 在门户中[监视存储、服务限制、查询量和延迟](search-monitor-usage.md)。 门户会显示每个第二个、 限制查询和搜索延迟查询。 所有这些值可以帮助您决定是否您选择合适的层。 此外可以配置的深层监视的值，如点击链接型分析，从而[搜索流量分析](search-traffic-analytics.md)。

索引数量和大小都同等重要向您的分析。 这是存储的因为最大限制，达到通过充分利用 （分区） 或资源 （索引、 索引器和等） 的最大限制为准。 门户可帮助你跟踪两者，并在“概述”页面上并排显示当前使用情况和最大限制。

> [!NOTE]
> 如果文档包含无关数据，可以使存储要求。 理想情况下，文档只包含的数据所需的搜索体验。 二进制数据不是可搜索，而应单独存储 （可能在 Azure 表或 blob 存储中）。 然后应保存到外部数据的 URL 引用的索引中添加字段。 单个文档的最大大小为 16 MB （或更低，如果你是批量上传了一个请求中的多个文档）。 有关详细信息，请参阅 [Azure 搜索中的服务限制](search-limits-quotas-capacity.md)。
>

**查询量注意事项**

每秒查询 (次数 QPS) 在性能优化，过程是一个重要度量标准，但如果在一开始就希望高查询量通常是一个层考虑因素。

标准层可以提供一种平衡的副本和分区。 你可以通过添加负载均衡副本增加查询周转时间，或添加并行处理的分区。 预配服务后，然后可以优化性能。

如果希望从一开始的高持续的查询卷，则应考虑更高的标准层，由更强大的硬件提供支持。 你可以然后使分区和副本脱机，或甚至切换到较低层服务，这些查询卷不会发生。 有关如何计算查询吞吐量的详细信息，请参阅 [Azure 搜索性能和优化](search-performance-optimization.md)。

存储优化层可用于大数据工作负荷，支持更多的总体的可用索引存储空间时查询延迟要求，这不太重要。 对于并行处理的负载平衡和其他分区，您还是应该使用额外的副本。 预配服务后，然后可以优化性能。

**服务级别协议**

未提供免费层和预览功能[服务级别协议 (Sla)](https://azure.microsoft.com/support/legal/sla/search/v1_0/)。 对于所有可计费的层，SLA 将在用户为服务提供足够冗余时生效。 您需要的查询 （读取） Sla 有两个或多个副本。 需要具有三个或多个副本用于查询和索引 （读-写） Sla。 分区数不会影响服务级别协议。

## <a name="tips-for-tier-evaluation"></a>层级评估提示

+ 了解如何生成高效的索引，并了解哪些刷新方法具有最小影响。 使用[搜索流量分析](search-traffic-analytics.md)若要深入了解查询活动。

+ 允许要围绕查询，生成的度量值，并收集有关使用模式 （查询在营业时间内，在非高峰时间索引） 的数据。 使用此数据来确定服务置备的决策。 尽管这不可行时每小时或每日频率，你可以动态调整分区和资源，以容纳查询卷中的计划内的更改。 如果级别保留足够长，以保证执行操作，还可以适应计划外，但持续更改。

+ 请记住 underprovisioning 的唯一缺点是，您可能需要关闭服务，如果实际要求大于预测。 为避免服务中断，可以在更高层级的相同订阅中创建新服务，并将其并行运行，直到所有应用和请求都指向新的终结点。

## <a name="next-steps"></a>后续步骤

开始免费层，通过使用你的数据的子集来了解其特征生成初始索引。 Azure 搜索中的数据结构是一个倒排的索引结构。 大小和复杂性的倒排索引的内容确定。 请记住，高度冗余的内容往往会导致比高度不规则的内容更小的索引。 因此内容特性而不是数据集的大小确定索引存储要求。

有的索引大小，初始估测后[预配计费服务](search-create-service-portal.md)上一个级别，这篇文章中所述：基本、 标准或存储优化。 放松任何人为限制对数据大小调整和[重新生成索引](search-howto-reindex.md)以包含你想要进行搜索的所有数据。

根据需要[分配分区和副本](search-capacity-planning.md)以获取所需性能和规模。

如果性能和容量是没问题，即已完成。 否则，请在与你的需求更接近的不同层级上重新创建搜索服务。

> [!NOTE]
> 如果有疑问，请将发布到[堆栈溢出](https://stackoverflow.com/questions/tagged/azure-search)或[联系 Azure 支持人员](https://azure.microsoft.com/support/options/)。
