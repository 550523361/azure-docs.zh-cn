---
title: Azure 实验室服务-管理员指南 |Microsoft Docs
description: 本指南可帮助使用 Azure 实验室服务创建和管理实验室帐户的管理员。
services: lab-services
documentationcenter: na
author: spelluru
manager: ''
editor: ''
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2019
ms.author: spelluru
ms.openlocfilehash: 638a90615d248b3c2829770432dd6a08eb4bb2fb
ms.sourcegitcommit: aee08b05a4e72b192a6e62a8fb581a7b08b9c02a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/09/2020
ms.locfileid: "75771728"
---
# <a name="azure-lab-services---administrator-guide"></a>Azure 实验室服务-管理员指南
管理组织的云资源的信息技术（IT）管理员通常还负责为其组织设置实验室帐户。 管理员或教师在实验室帐户中创建教室实验室。 本文详细介绍了所涉及的 Azure 资源以及创建这些资源的指南。

![实验室帐户中 Azure 资源的高级视图](../media/administrator-guide/high-level-view.png)

- 课堂实验室托管在 Azure 实验室服务拥有的 Azure 订阅中
- 实验室帐户、共享映像库和映像版本托管在你的订阅中
- 你可以在同一资源组中包含实验室帐户和分片映像库。 在此图中，它们位于不同的资源组中。 

## <a name="subscription"></a>订阅
你的组织有一个或多个 Azure 订阅。 订阅用于管理在其中使用的所有 Azure resources\services （包括实验室帐户）的计费和安全性。

实验室帐户与其订阅之间的关系非常重要，因为：

- 计费通过包含实验室帐户的订阅进行报告。
- 可以在与订阅关联的 Azure Active Directory （AD）租户中为用户提供对 Azure 实验室服务的访问权限。 你可以将用户添加为实验室帐户 owner\contributor 或课堂实验室创建者。

只为你管理教室实验室及其虚拟机（Vm）。 具体来说，它们托管在 Azure 实验室服务拥有的专用订阅中。

## <a name="resource-group"></a>资源组
订阅包含一个或多个资源组。 资源组用于创建在同一解决方案中一起使用的 Azure 资源的逻辑分组。  

创建实验室帐户时，必须配置包含实验室帐户的资源组。 

创建[共享映像库](#shared-image-gallery)时，还需要资源组。 你可以选择将实验室帐户和共享映像库放在两个不同的资源组中，这在你计划跨不同解决方案共享映像库时很常见。 或者，你可以选择将它们放在同一资源组中。

创建实验室帐户并同时自动创建并附加共享映像库时，默认情况下，将在单独的资源组中创建实验室帐户和共享映像库。 使用本教程中所述的步骤时，你将看到此行为：[在创建实验室帐户时配置共享映像库](how-to-attach-detach-shared-image-gallery.md#configure-at-the-time-of-lab-account-creation)。 本文顶部的图像还使用此配置。 

建议提前投入时间来计划资源组的结构，因为创建实验室帐户或共享映像库的资源组后，不能对其进行更改。 如果需要更改这些资源的资源组，则需要删除并重新创建实验室帐户和/或共享映像库。

## <a name="lab-account"></a>实验室帐户
实验室帐户充当一个或多个教室实验室的容器。 开始使用 Azure 实验室服务时，通常只有一个实验室帐户。 随着实验室使用情况的扩展，稍后可以选择创建更多实验室帐户。

以下列表突出显示了多个实验室帐户可能有用的方案：

- **跨教室实验室管理不同的策略要求** 

    设置实验室帐户时，将设置适用于实验室帐户下所有教室实验室的策略，例如：
    - 具有教室实验室可以访问的共享资源的 Azure 虚拟网络。 例如，你可能有一组教室实验室需要访问虚拟网络中的共享数据集。
    - 教室实验室可用于创建 Vm 的虚拟机（VM）映像。 例如，你可能有一组教室实验室需要访问[适用于 Linux](https://azuremarketplace.microsoft.com/marketplace/apps/microsoft-dsvm.linux-data-science-vm-ubuntu) Marketplace 映像的 Data Science VM。  

    如果您的课堂实验室具有独特的策略要求，则创建单独的实验室帐户以单独管理这些教室实验室可能会有好处。
- **限制实验室创建者访问特定教室实验室**  

    当用户作为实验室创建者添加时，他们将获得实验室帐户内所有教室实验室的访问权限，包括由其他实验室创建者创建的实验室。 若要限制实验室创建者管理特定实验室，你可以创建单独的实验室帐户来限制其访问范围。 例如，可以为大学中的每个部门创建单独的实验室帐户。 例如：一个实验室帐户用于科学部门，另一个用于数学部门，依此类推。   
- **按实验室帐户区分预算**

    你可能需要更加清晰地分隔预算，而不是为单个实验室帐户报告所有教室实验室成本。 继续执行上述项目符号中的示例，你可以为每个大学部门创建实验室帐户，以便相应地分离预算。 使用 Azure 成本管理，可以查看每个单独实验室帐户的费用。
- **将试验实验室与活动实验室隔离**

    在某些情况下，你可能想要对实验室帐户进行策略更改试验，而不会影响活动实验室。 在这种情况下，为试验目的创建单独的实验室帐户允许隔离更改。 

## <a name="classroom-lab"></a>课堂实验室
教室实验室包含一个或多个虚拟机（Vm），每个虚拟机都分配给特定的学生。 通常，您可以：

- 每个类都有一个教室实验室。
- 创建一组新的教室实验室，每个学期（或为你的类提供的每个时间范围）。通常，对于具有相同映像需求的类，可以使用[共享映像库](#shared-image-gallery)跨实验室和学期共享图像。

确定如何构造教室实验室时，请注意以下几点：

- **使用已发布的同一映像部署教室实验室内的所有 vm**。 因此，如果你有一个需要同时发布不同实验室映像的类，则必须为每个用户创建单独的教室实验室。
- **使用配额在实验室级别设置，适用于实验室中的所有用户**。 例如，你可能有一组教师需要访问某个类的 Vm 来准备教学，但教师只需要10小时配额，而在类中注册的学生需要40小时的配额。 若要为用户设置不同的配额，必须创建单独的教室实验室。 但是，在设置配额后，可以将更多的时间添加到特定用户。
- **启动或关闭计划在实验室级别设置，适用于实验室中的所有 vm**。 与上一点类似，如果需要为用户设置不同的计划，则需要创建单独的教室实验室。 

## <a name="shared-image-gallery"></a>共享映像库
共享映像库附加到实验室帐户，用作存储图像的中央存储库。 当教师从课堂实验室模板虚拟机（VM）中选择保存时，图像将保存在库中。 当教师每次更改模板 VM 并保存时，会保存新版本的映像，同时保留以前的版本。

当教师创建新的教室实验室时，教师可以从共享映像库发布映像版本。 尽管库可以存储图像的多个版本，但在创建实验室时，教师只能选择最新版本。

共享映像库是一种可选资源，如果仅从几个教室实验室开始，你可能不需要此资源。 然而，使用共享图像库有很多好处，因为缩放以获得更多的课堂实验室：

- **使你能够保存和管理模板 VM 映像的版本**。

    在创建自定义映像或从公共 Marketplace 库对映像进行更改（软件、配置等）时，此方法非常有用。  例如，教师通常需要安装不同的 software\tooling。 可以将模板 VM 映像的不同版本保存到共享映像库，而不是要求学生手动安装这些必备组件。 然后，可以在创建新的教室实验室时使用这些映像版本。
- **跨教室实验室启用模板 VM 映像的 sharing\reuse**。

    它可让你在每次创建新的教室实验室时，无需从头开始配置映像。 例如，如果提供了需要同一映像的多个类，则此映像只需创建一次并保存在共享映像库中，以便可以跨教室实验室共享。
- **通过复制确保映像的可用性**。

    从教室实验室保存到共享映像库时，图像会自动复制到同一地域中的其他区域。 如果某个区域发生服务中断，则在您的教室实验室中发布模板 VM 不会受到使用其他区域中的映像副本的影响。 此外，通过分散到使用不同的副本，有助于在多 VM 发布方案中提高性能。

若要对共享映像进行逻辑分组，可以使用以下几个选项：

- 创建多个共享映像库。 每个实验室帐户只能连接到一个共享映像库，因此此选项还将要求你创建多个实验室帐户。
- 或者，可以使用由多个实验室帐户共享的单个共享映像库。 在这种情况下，每个实验室帐户只能启用适用于其包含的教室实验室的映像。

## <a name="naming"></a>命名
在 Azure 实验室服务入门中，我们建议你为资源组、实验室帐户、教室实验室和共享映像库建立命名约定。 尽管你建立的命名约定对于组织的需求是唯一的，但下表概述了一般准则。

| 资源类型 | 角色 | 建议的模式 | 示例 |
| ------------- | ---- | ----------------- | -------- | 
| 资源组 | 包含一个或多个实验室帐户以及一个或多个共享映像库 | \<组织短名称\>-\<环境\>-rg<ul><li>**组织短名称**标识资源组支持的组织的名称</li><li>**环境**标识资源的环境，如测试或生产</li><li>**Rg**代表资源类型：资源组。</li></ul> | contosouniversitylabs-rg<br/>contosouniversitylabs-rg<br/>contosouniversitylabs |
| 实验室帐户 | 包含一个或多个实验室 | \<组织短名称\>-\<环境\>-la<ul><li>**组织短名称**标识资源组支持的组织的名称</li><li>**环境**标识资源的环境，如测试或生产</li><li>**La**代表资源类型：实验室帐户。</li></ul> | contosouniversitylabs-la<br/>mathdeptlabs-la<br/>sciencedeptlabs-测试中心<br/>sciencedeptlabs-照 |
| 课堂实验室 | 包含一个或多个 Vm |\<类名称\>-\<时间范围\>-\<教师标识符\><ul><li>**类名称**标识实验室支持的类的名称。</li><li>**时间范围**确定提供类的时间范围。</li>**教育标识符**标识拥有实验室的教师。</li></ul> | CS1234-fall2019-johndoe<br/>CS1234-spring2019-johndoe | 
| 共享映像库 | 包含一个或多个 VM 映像版本 | \<组织\>库的短名称 | contosouniversitylabsgallery |

有关命名其他 Azure 资源的详细信息，请参阅[Azure 资源的命名约定](/azure/architecture/best-practices/naming-conventions)。

## <a name="regions-or-locations"></a>区域或位置
设置 Azure 实验室服务的资源时，需要提供将托管资源的数据中心的区域或位置。 下面更详细地介绍了 region\location 如何影响实验室服务部署中使用的以下每个资源：

- **资源组**

    区域指定数据中心，其中存储了有关资源组的信息。 资源组中包含的 Azure 资源可以位于其父组中的不同区域。
- **实验室帐户或教室实验室**

    实验室帐户的位置指示该资源的区域。 在实验室帐户中创建的教室实验室可部署到同一地域内的任何区域。 实验室的 Vm 部署到的特定区域会根据该时间区域内可用的容量自动选择。  
    如果管理员允许 lab 创建者选择其教室实验室的位置，则在创建实验室时，可供选择的位置基于可用的区域容量。

    教室实验室的位置还确定哪些 VM 计算大小可供选择。 某些计算大小仅在特定位置内可用。
- **共享映像库**

    区域指示存储第一个映像版本的源区域，然后将其自动复制到目标区域。
    
一般规则是将资源的 region\location 设置为与其用户最接近的资源。 对于课堂实验室，这意味着创建离学生最近的教室实验室。 对于学生遍布世界各地的在线课程，你需要使用最佳判断来创建一个集中定位的教室实验室。 或者，将一个类拆分为多个基于学生区域的教室实验室。

## <a name="vm-sizing"></a>VM 大小调整
当管理员或实验室创建者创建教室实验室时，他们可以根据教室的需要从以下 VM 大小中进行选择。 请记住，可用的计算大小取决于实验室帐户所在的区域：

| 大小 | 规格 | 建议使用 |
| ---- | ----- | ------------- |
| 小型| <ul><li>双核</li><li>3.5 GB RAM</li></ul> | 此大小最适用于命令行、打开 web 浏览器、低流量 web 服务器、小到中型数据库。 |
| 中型 | <ul><li>4核</li><li>7 GB RAM</li></ul> | 此大小最适合用于关系数据库、内存中缓存和分析。 |
| 中（嵌套虚拟化） | <ul><li>4核</li><li>16 GB 内存</li></ul> | 此大小最适合用于关系数据库、内存中缓存和分析。  此大小还支持嵌套虚拟化。 |
| 大 | <ul><li>8 核</li><li>32 GB RAM</li></ul> | 此大小最适用于需要更快的 Cpu、更好的本地磁盘性能、大型数据库、大内存缓存的应用程序。  此大小还支持嵌套虚拟化。 |
| 小型 GPU （可视化效果） | <ul><li>6核</li><li>56 GB RAM</li> | 此大小最适合用于使用框架（如 OpenGL 和 DirectX）进行远程可视化、流式处理、游戏、编码。 |
| 小型 GPU （计算） | <ul><li>6核</li><li>56 GB RAM</li></ul> |此大小最适用于计算机密集型应用程序，如人工智能和深度学习。 |
| 中等 GPU （可视化效果） | <ul><li>12核</li><li>112 GB RAM</li></ul> | 此大小最适合用于使用框架（如 OpenGL 和 DirectX）进行远程可视化、流式处理、游戏、编码。 |

## <a name="manage-identity"></a>管理标识
实验室帐户管理员可能有两种类型的角色：

- **所有者**

    被分配了 "**所有者**" 角色的管理员拥有对实验室帐户的完全访问权限，包括向其他用户授予对实验室帐户的访问权限以及添加实验室创建者的权限。 默认情况下，创建实验室帐户的管理员作为所有者添加。
- **参与者**

    分配有 "参与者" 角色的管理员可以更改实验室帐户设置，但不能向其他用户授予访问权限;也可以添加实验室创建者。

将共享映像库附加到实验室帐户时，会自动为管理员和实验室创建者提供访问权限，以便他们可以在库中查看和保存图像。 

## <a name="pricing"></a>价格

### <a name="azure-lab-services"></a>Azure 实验室服务
以下文章中介绍了 Azure 实验室服务的定价： [Azure 实验室服务定价](https://azure.microsoft.com/pricing/details/lab-services/)。

如果你打算使用共享映像库来存储和管理映像版本，还需要考虑它的定价。 

### <a name="shared-image-gallery"></a>共享映像库
创建共享映像库并将其附加到实验室帐户是免费的。 在将图像版本保存到库中之前，不会产生成本。 通常，使用共享图像库的价格相当不多，但要了解它是如何计算的，因为它不包括在 Azure 实验室服务的定价中。  

### <a name="storage-charges"></a>存储费用
为了存储映像版本，共享映像库使用标准 HDD 托管磁盘。 所使用的 HDD 托管磁盘的大小取决于所存储的映像版本大小。 请参阅以下文章，查看定价：[托管磁盘定价](https://azure.microsoft.com/pricing/details/managed-disks/)。


### <a name="replication-and-network-egress-charges"></a>复制和网络出口费用
使用课堂实验室模板虚拟机（VM）保存映像版本时，实验室服务首先将它存储在源区域中，然后自动将源映像版本复制到一个或多个目标区域。 请务必注意，Azure 实验室服务会自动将源映像版本复制到教室实验室所在的地理位置中的所有目标区域。 例如，如果你的教室实验室在美国地理位置，则会将映像版本复制到美国境内每个

将映像版本从源区域复制到其他目标区域时，会产生网络出口费用。 根据映像的数据最初从源区域传输出站时的图像版本大小，计费量。  有关定价的详细信息，请参阅以下文章：[带宽定价详细信息](https://azure.microsoft.com/pricing/details/bandwidth/)。

[教育解决方案](https://www.microsoft.com/licensing/licensing-programs/licensing-for-industries?rtc=1&activetab=licensing-for-industries-pivot:primaryr3)客户可能会因支付出口费用而停征。 请与帐户管理员联系以了解详细信息。  有关详细信息，请参阅链接文档中**的 "常见问题解答**" 部分，特别是 "学术客户存在哪些数据传输程序以及如何实现资格？" 这一问题。

### <a name="pricing-example"></a>定价示例
为了概述上述定价，我们来看一个将模板 VM 映像保存到共享映像库的示例。 假设以下方案：

- 你有一个自定义 VM 映像。
- 正在保存图像的两个版本。
- 你的实验室在美国，共8个区域。
- 每个映像版本大小为 32 GB;因此，HDD 托管的磁盘价格是每月 $1.54。

总体成本估算为：

映像数×版本数×副本数×托管磁盘价格

在此示例中，成本为：

1个自定义映像（32 GB） x 2 版本 x 8 个美国区域 x $1.54 = $24.64/月

### <a name="cost-management"></a>成本管理
实验室帐户管理员可以通过定期从库中删除不需要的映像版本来管理成本。 

不应删除到特定区域的复制，因为这样可以降低成本（此选项存在于共享映像库中）。 复制更改可能会对 Azure 实验室服务从共享映像库中保存的映像发布 Vm 的能力产生负面影响。

## <a name="next-steps"></a>后续步骤
请参阅教程，了解如何创建实验室帐户和实验室：[教程：设置实验室帐户](tutorial-setup-lab-account.md)
