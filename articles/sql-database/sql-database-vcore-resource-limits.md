---
title: Azure SQL 数据库基于 vCore 的资源限制 | Microsoft Docs
description: 本页介绍 Azure SQL 数据库的一些常见基于 vCore 的资源限制。
services: sql-database
author: CarlRabeler
manager: craigg
ms.service: sql-database
ms.custom: DBs & servers
ms.topic: conceptual
ms.date: 05/31/2018
ms.author: carlrab
ms.openlocfilehash: 324f9f35de37c717d57e46413cd881dce785f4fd
ms.sourcegitcommit: c722760331294bc8532f8ddc01ed5aa8b9778dec
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/04/2018
ms.locfileid: "34737657"
---
# <a name="azure-sql-database-vcore-based-purchasing-model-limits-preview"></a>Azure SQL 数据库基于 vCore 的新购买模型的限制（预览版）

> [!IMPORTANT]
> 有关基于 DTU 的购买模型的限制，请参阅 [SQL 数据库基于 DTU 的资源限制](sql-database-dtu-resource-limits.md)。

## <a name="single-database-storage-sizes-and-performance-levels"></a>单一数据库：存储大小和性能级别

对于单一数据库，下表显示了可用于每个服务层和性能级别的单一数据库的资源。 可通过 [Azure 门户](sql-database-single-database-resources.md#manage-single-database-resources-using-the-azure-portal)、[Transact-SQL](sql-database-single-database-resources.md#manage-single-database-resources-using-transact-sql)、[PowerShell](sql-database-single-database-resources.md#manage-single-database-resources-using-powershell)、[Azure CLI](sql-database-single-database-resources.md#manage-single-database-resources-using-the-azure-cli) 或 [REST API](sql-database-single-database-resources.md#manage-single-database-resources-using-the-rest-api) 为单一数据库设置服务层、性能级别和存储量。

### <a name="general-purpose-service-tier"></a>常规用途服务层

#### <a name="generation-4-compute-platform"></a>第 4 代计算平台
|性能级别|GP_Gen4_1|GP_Gen4_2|GP_Gen4_4|GP_Gen4_8|GP_Gen4_16|GP_Gen4_24
|:--- | --: |--: |--: |--: |--: |--: |
|硬件代次|4|4|4|4|4|4|
|vCore 数|1|2|4|8|16|24|
|内存 (GB)|7|14|28|56|112|168|
|列存储支持|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|不适用|不适用|不适用|不适用|不适用|不适用|
|存储类型|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|
|IO 延迟（近似）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|
|最大数据大小 (GB)|1024|1024|1536|3072|4096|4096|
|最大日志大小|307|307|461|922|1229|1229|
|TempDB 大小 (DB)|32|64|128|256|384|384|
|目标 IOPS (64 KB)|500|1000|2000|4000|7000|7000|
|最大并发工作线程数（请求数）|200|400|800|1600|3200|4800|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|
|副本数|1|1|1|1|1|1|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|000
|读取横向扩展|不适用|不适用|不适用|不适用|不适用|不适用|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

#### <a name="generation-5-compute-platform"></a>第 5 代计算平台
|性能级别|GP_Gen5_2|GP_Gen5_4|GP_Gen5_8|GP_Gen5_16|GP_Gen5_24|GP_Gen5_32|GP_Gen5_40| GP_Gen5_80|
|:--- | --: |--: |--: |--: |---: | --: |--: |--: |--: |
|硬件代次|5|5|5|5|5|5|5|
|vCore 数|2|4|8|16|24|32|40|80|
|内存 (GB)|11|22|44|88|132|176|220|440|
|列存储支持|是|是|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|存储类型|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|
|IO 延迟（近似）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|
|最大数据大小 (GB)|1024|1024|1536|3072|4096|4096|4096|4096|
|最大日志大小|307|307|461|614|1229|1229|1229|1229|
|TempDB 大小 (DB)|64|128|256|384|384|384|384|384|
|目标 IOPS (64 KB)|500|1000|2000|4000|6000|7000|7000|7000|
|最大并发工作线程数（请求数）|200|400|800|1600|2400|3200|4000|8000|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|30000|30000|
|副本数|1|1|1|1|1|1|1|1|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

### <a name="business-critical-service-tier"></a>“业务关键”服务层

#### <a name="generation-4-compute-platform"></a>第 4 代计算平台
|性能级别|BC_Gen4_1|BC_Gen4_2|BC_Gen4_4|BC_Gen4_8|BC_Gen4_16|BC_Gen4_24|
|:--- | --: |--: |--: |--: |--: |--: |
|硬件代次|4|4|4|4|4|4|
|vCore 数|1|2|4|8|16|24|
|内存 (GB)|7|14|28|56|112|168|
|列存储支持|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|1|2|4|8|20|36|
|存储类型|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|
|最大数据大小 (GB)|1024|1024|1024|1024|1024|1024|
|最大日志大小|307|307|307|307|307|307|
|TempDB 大小 (DB)|32|64|128|256|384|384|
|目标 IOPS (64 KB)|5000|10000|20000|40000|80000|120000|
|IO 延迟（近似）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|
|最大并发工作线程数（请求数）|200|400|800|1600|3200|4800|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|
|副本数|3|3|3|3|3|3|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|是|是|是|是|是|是|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

#### <a name="generation-5-compute-platform"></a>第 5 代计算平台
|性能级别|BC_Gen5_2|BC_Gen5_4|BC_Gen5_8|BC_Gen5_16|BC_Gen5_24|BC_Gen5_32|BC_Gen5_40|BC_Gen5_80|
|:--- | --: |--: |--: |--: |---: | --: |--: |--: |--: |--: |--: |--: |--: |
|硬件代次|5|5|5|5|5|5|5|5|
|vCore 数|2|4|8|16|24|32|40|80|
|内存 (GB)|11|22|44|88|132|176|220|440|
|列存储支持|是|是|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|1.571|3.142|6.284|15.768|25.252|37.936|52.22|131.64|
|存储类型|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|
|IO 延迟（近似）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|
|最大数据大小 (GB)|1024|1024|1024|1024|2048|4096|4096|4096|
|最大日志大小|307|307|307|307|614|1229|1229|1229|
|TempDB 大小 (DB)|64|128|256|384|384|384|384|384|
|目标 IOPS (64 KB)|5000|10000|20000|40000|60000|80000|100000|200000
|最大并发工作线程数（请求数）|200|400|800|1600|2400|3200|4000|8000|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|30000|30000|
|副本数|3|3|3|3|3|3|3|3|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

## <a name="single-database-change-storage-size"></a>单一数据库：更改存储大小

- 可以使用 1GB 作为增量，将存储预配到最大大小限制。 最小可配置数据存储为 5GB 
- 可通过 [Azure 门户](sql-database-single-database-resources.md#manage-single-database-resources-using-the-azure-portal)、[Transact-SQL](/sql/t-sql/statements/alter-database-azure-sql-database#examples)、[PowerShell](/powershell/module/azurerm.sql/set-azurermsqldatabase)、[Azure CLI](/cli/azure/sql/db#az_sql_db_update) 或 [REST API](/rest/api/sql/databases/update) 为单一数据库增加或减少大小上限，以预配存储。
- SQL 数据库会自动为日志文件额外分配 30% 的存储，并为 TempDB 的每个 vCore 分配 32GB，但不会超过 384GB。 TempDB 位于所有服务层中的附加 SSD 上。
- 单一数据库的存储价格等于数据存储与日志存储量之和乘以服务层的存储单价。 vCore 价格已包括 TempDB 费用。 有关额外存储价格的详细信息，请参阅 [SQL 数据库定价](https://azure.microsoft.com/pricing/details/sql-database/)。

## <a name="single-database-change-vcores"></a>单一数据库：更改 vCore

最初选择 vCore 数量后，可以使用 [Azure 门户](sql-database-single-database-resources.md#manage-single-database-resources-using-the-azure-portal)、[Transact-SQL](/sql/t-sql/statements/alter-database-azure-sql-database#examples)、 [PowerShell](/powershell/module/azurerm.sql/set-azurermsqldatabase)、[Azure CLI](/cli/azure/sql/db#az_sql_db_update) 或 [REST API](/rest/api/sql/databases/update)，根据实际体验动态扩展或缩减单一数据库。 

更改数据库的服务层和/或性能级别将在新的性能级别创建原始数据库的副本，并将连接切换到副本。 当我们切换到副本时，在此过程中不会丢失任何数据，但在短暂的瞬间，将禁用与数据库的连接，因此可能回滚某些处于进行状态的事务。 用于切换的时间长度因情况而异，但通常为 4 秒以下，并且 99% 的情况下少于 30 秒。 如果在禁用连接的那一刻有大量的事务正在进行，则用于切换的时间长度可能会更长。 

整个扩展过程的持续时间同时取决于更改前后数据库的大小和服务层。 例如，一个正在更改到标准服务层、从“常规用途”服务层更改或在标准服务层内更改的 250 GB 的数据库应在六小时内完成。 如果数据库与正在“业务关键”服务层内更改性能级别的大小相同，应在三小时内完成扩展。

> [!TIP]
> 若要监视正在进行的操作，请参阅：[使用 SQL REST API 管理操作](/rest/api/sql/Operations/List)、[使用 CLI 管理操作](/cli/azure/sql/db/op)、[使用 T-SQL 管理操作](/sql/relational-databases/system-dynamic-management-views/sys-dm-operation-status-azure-sql-database)及以下两个 PowerShell 命令：[Get-AzureRmSqlDatabaseActivity](/powershell/module/azurerm.sql/get-azurermsqldatabaseactivity) 和 [Stop-AzureRmSqlDatabaseActivity](/powershell/module/azurerm.sql/stop-azurermsqldatabaseactivity)。

* 如果要升级到更高的服务层或性能级别，除非显式指定了更大的大小（最大），否则，最大数据库大小不会增大。
* 若要对数据库进行降级，数据库所用空间必须小于目标服务层和性能级别允许的最大大小。 
* 在启用了[异地复制](sql-database-geo-replication-portal.md)的情况下升级数据库时，请先将辅助数据库升级到所需的性能层，然后再升级主数据库（为获得最佳性能的常规指南）。 在升级到另一版本时，必须首先升级辅助数据库。
* 在启用了[异地复制](sql-database-geo-replication-portal.md)的情况下降级数据库时，请先将主数据库降级到所需的性能层，然后再降级辅助数据库（为获得最佳性能的常规指南）。 在降级到另一版本时，必须首先降级主数据库。
* 所做的更改完成之前不会应用数据库的新属性。

## <a name="elastic-pool-storage-sizes-and-performance-levels"></a>弹性池：存储大小和性能级别

对于 SQL 数据库弹性池，下表显示了在每个服务层和性能级别可用的资源。 可通过 [Azure 门户](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-the-azure-portal)、[PowerShell](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-powershell)、[Azure CLI](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-the-azure-cli) 或 [REST API](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-the-rest-api) 设置服务层、性能级别和存储量。

> [!NOTE]
> 弹性池中各个数据库的资源限制通常与池外部具有相同性能级别的各个数据库相同。 例如，GP_Gen4_1 数据库的最大并发工作进程数为 200 个。 因此，GP_Gen4_1 池中数据库的最大并发工作进程数也是 200 个。 请注意，GP_Gen4_1 池中的并发工作进程总数为 210 个。

### <a name="general-purpose-service-tier"></a>常规用途服务层

#### <a name="generation-4-compute-platform"></a>第 4 代计算平台
|性能级别|GP_Gen4_1|GP_Gen4_2|GP_Gen4_4|GP_Gen4_8|GP_Gen4_16|GP_Gen4_24|
|:--- | --: |--: |--: |--: |--: |--: |
|硬件代次|4|4|4|4|4|4|
|vCore 数|1|2|4|8|16|24|
|内存 (GB)|7|14|28|56|112|168|
|列存储支持|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|不适用|不适用|不适用|不适用|不适用|不适用|
|存储类型|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|
|最大数据大小 (GB)|512|756|1536|2048|3584|4096|
|最大日志大小|154|227|461|614|1075|1229|
|TempDB 大小 (DB)|32|64|128|256|384|384|
|目标 IOPS (64 KB)|500|1000|2000|4000|7000|7000|
|IO 延迟（近似）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|
|最大并发工作线程数（请求数）|210|420|840|1680|3360|5040|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|
|最大池密度|100|200|500|500|500|500|
|最小/最大弹性池点击停止次数|0, 0.25, 0.5, 1|0, 0.25, 0.5, 1, 2|0, 0.25, 0.5, 1, 2, 4|0, 0.25, 0.5, 1, 2, 4, 8|0, 0.25, 0.5, 1, 2, 4, 8, 16|0, 0.25, 0.5, 1, 2, 4, 8, 16, 24|
|副本数|1|1|1|1|1|1|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|不适用|不适用|不适用|不适用|不适用|不适用|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

#### <a name="generation-5-compute-platform"></a>第 5 代计算平台
|性能级别|GP_Gen5_2|GP_Gen5_4|GP_Gen5_8|GP_Gen5_16|GP_Gen5_24|GP_Gen5_32|GP_Gen5_40|GP_Gen5_80|
|:--- | --: |--: |--: |--: |--: |--: |--: |--: |
|硬件代次|5|5|5|5|5|5|5|5|
|vCore 数|2|4|8|16|24|32|40|80|
|内存 (GB)|11|22|44|88|132|176|220|440|
|列存储支持|是|是|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|存储类型|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|高级（远程）存储|
|最大数据大小 (GB)|512|756|1536|2048|3072|4096|4096|4096|
|最大日志大小|154|227|461|614|922|1229|1229|1229|
|TempDB 大小 (DB)|64|128|256|384|384|384|384|384|
|目标 IOPS (64 KB)|500|1000|2000|4000|6000|7000|7000|7000|
|IO 延迟（近似）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|5-7 毫秒（写入）<br>5-10 毫秒（读取）|
|最大并发工作线程数（请求数）|210|420|840|1680|2520|3360|4200|8400
|允许的最大会话数|30000|30000|30000|30000|30000|30000|30000|30000|
|最大池密度|100|200|500|500|500|500|500|500|
|最小/最大弹性池点击停止次数|0, 0.25, 0.5, 1, 2|0, 0.25, 0.5, 1, 2, 4|0, 0.25, 0.5, 1, 2, 4, 8|0, 0.25, 0.5, 1, 2, 4, 8, 16|0, 0.25, 0.5, 1, 2, 4, 8, 16, 24|0, 0.5, 1, 2, 4, 8, 16, 24, 32|0, 0.5, 1, 2, 4, 8, 16, 24, 32, 40|0, 0.5, 1, 2, 4, 8, 16, 24, 32, 40, 80|
|副本数|1|1|1|1|1|1|1|1|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

### <a name="business-critical-service-tier"></a>“业务关键”服务层

#### <a name="generation-4-compute-platform"></a>第 4 代计算平台
|性能级别|BC_Gen4_1|BC_Gen4_2|BC_Gen4_4|BC_Gen4_8|BC_Gen4_16|BC_Gen4_24|
|:--- | --: |--: |--: |--: |--: |--: |
|硬件代次|4|4|4|4|4|4|
|vCore 数|1|2|4|8|16|24|
|内存 (GB)|7|14|28|56|112|168|
|列存储支持|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|1|2|4|8|20|36|
|存储类型|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|
|最大数据大小 (GB)|1024|1024|1024|1024|1024|1024|
|最大日志大小|307|307|307|307|307|307|
|TempDB 大小 (DB)|32|64|128|256|384|384|
|目标 IOPS (64 KB)|5000|10000|20000|40000|80000|120000|
|IO 延迟（近似）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|
|最大并发工作线程数（请求数）|210|420|840|1680|3360|5040|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|
|最大池密度|不适用|50|100|100|100|100|
|最小/最大弹性池点击停止次数|不适用|0, 0.25, 0.5, 1, 2|0, 0.25, 0.5, 1, 2, 4|0, 0.25, 0.5, 1, 2, 4, 8|0, 0.25, 0.5, 1, 2, 4, 8, 16|0, 0.25, 0.5, 1, 2, 4, 8, 16, 24|
|副本数|3|3|3|3|3|3|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|是|是|是|是|是|是|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

#### <a name="generation-5-compute-platform"></a>第 5 代计算平台
|性能级别|BC_Gen5_2|BC_Gen5_4|BC_Gen5_8|BC_Gen5_16|BC_Gen5_24|BC_Gen5_32|BC_Gen5_40|BC_Gen5_80|
|:--- | --: |--: |--: |--: |--: |--: |--: |--: |
|硬件代次|5|5|5|5|5|5|5|5|
|vCore 数|2|4|8|16|24|32|40|80|
|内存 (GB)|11|22|44|88|132|176|220|440|
|列存储支持|是|是|是|是|是|是|是|是|
|内存中 OLTP 存储 (GB)|1.571|3.142|6.284|15.768|25.252|37.936|52.22|131.64|
|存储类型|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|本地 SSD|
|IO 延迟（近似）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|1-2 毫秒（写入）<br>1-2 毫秒（读取）|
|最大数据大小 (GB)|1024|1024|1024|1024|2048|4096|4096|4096|
|最大日志大小|307|307|307|307|614|1229|1229|1229|
|TempDB 大小 (DB)|64|128|256|384|384|384|384|384|
|目标 IOPS (64 KB)|5000|10000|20000|40000|60000|80000|100000|200000
|最大并发工作线程数（请求数）|210|420|840|1680|2520|3360|5040|8400|
|允许的最大会话数|30000|30000|30000|30000|30000|30000|30000|30000|
|最大池密度|不适用|50|100|100|100|100|100|100|
|最小/最大弹性池点击停止次数|不适用|0, 0.25, 0.5, 1, 2, 4|0, 0.25, 0.5, 1, 2, 4, 8|0, 0.25, 0.5, 1, 2, 4, 8, 16|0, 0.25, 0.5, 1, 2, 4, 8, 16, 24|0, 0.5, 1, 2, 4, 8, 16, 24, 32|0, 0.5, 1, 2, 4, 8, 16, 24, 32, 40|0, 0.5, 1, 2, 4, 8, 16, 24, 32, 40, 80|
|副本数|3|3|3|3|3|3|3|3|
|Multi-AZ|不适用|不适用|不适用|不适用|不适用|不适用|不适用|不适用|
|读取横向扩展|是|是|是|是|是|是|是|是|
|随附的备份存储|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|1 倍数据库大小|
|||

如果弹性池的所有 vCore 繁忙，则池中的每个数据库将接收相同数量的计算资源来处理查询。 SQL 数据库服务通过确保相等的计算时间片，在数据库之间提供资源共享的公平性。 弹性池资源共享公平性是在将每个数据库的 vCore 最小值设为非零值时，对另外为每个数据库保证的任意资源量的补充。

### <a name="database-properties-for-pooled-databases"></a>入池数据库的数据库属性

下表介绍了入池数据库的属性。

| 属性 | 说明 |
|:--- |:--- |
| 每个数据库的最大 vCore 数 |根据池中其他数据库的 vCore 使用率，池中任何数据库可以使用的 vCore 的最大数目。 每个数据库的 vCore 上限并不是数据库的资源保障。 此设置是应用于池中所有数据库的全局设置。 将每个数据库的最大 vCore 数设置得足够高，以处理数据库使用高峰情况。 因为池通常会假定数据库存在热使用模式和冷使用模式，在这些模式中并非所有数据库同时处于高峰使用状态，所以预期会存在某种程度的过量使用情况。|
| 每个数据库的最小 vCore 数 |池中任何数据库可以保证的 vCore 最小数目。 此设置是应用于池中所有数据库的全局设置。 每个数据库的最小 vCore 可能设为 0，这也是默认值。 该属性值可以设置为介于 0 和每个数据库的平均 vCore 使用量之间的任意值。 池中数据库数目和每个数据库的 vCore 下限的积不能超过每个池的 vCore 数。|
| 每个数据库的最大存储 |用户为池中的数据库设置的最大数据库大小。 入池数据库共享分配的池存储，因此数据库可以访问的大小限制为剩余的池存储与数据库大小中的较小者。 最大数据库大小是指数据文件的最大大小，不包括日志文件使用的空间。 |
|||
 
## <a name="elastic-pool-change-storage-size"></a>弹性池：更改存储大小

- 可将存储预配到最大大小限制。 
 - 对于标准存储，可以 10 GB 为增量增加或减少大小
 - 对于高级存储，可以 250 GB 为增量增加或减少大小
- 可通过 [Azure 门户](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-the-azure-portal)、[PowerShell](/powershell/module/azurerm.sql/set-azurermsqlelasticpool)、[Azure CLI](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_update) 或 [REST API](/rest/api/sql/elasticpools/update) 为弹性池增加或减少大小上限，以预配存储。
- 弹性池的存储价格等于存储量乘以服务层的存储单价。 有关额外存储价格的详细信息，请参阅 [SQL 数据库定价](https://azure.microsoft.com/pricing/details/sql-database/)。

## <a name="elastic-pool-change-vcores"></a>弹性池：更改 vCore

可按资源需求，通过 [Azure 门户](sql-database-elastic-pool.md#manage-elastic-pools-and-databases-using-the-azure-portal)、[PowerShell](/powershell/module/azurerm.sql/set-azurermsqlelasticpool)、[Azure CLI](/cli/azure/sql/elastic-pool#az_sql_elastic_pool_update) 或 [REST API](/rest/api/sql/elasticpools/update) 提高或降低弹性池的性能级别。

- 重新缩放池 vCore 时，将暂时停止数据库连接。 此行为与重新缩放单一数据库（而非在池中）的 DTU 时的行为相同。 有关在重新缩放操作执行期间，停止数据库连接的持续时间和影响的详细信息，请参阅[重新缩放单一数据库的 DTU](#single-database-change-storage-size)。 
- 重新缩放池 vCore 的持续时间取决于池中所有数据库使用的总存储空间量。 一般而言，每 100 GB 重新缩放的平均延迟时间不超过 90 分钟。 例如，如果池中所有数据库使用的总空间为 200 GB，则重新缩放池的预计延迟时间将不超过 3 小时。 对标准层或基本层中的某些事例而言，重新缩放延迟时间可能不超过五分钟，不考虑所用空间量的影响。
- 一般而言，更改每个数据库的最小 vCore 或最大 vCore 的持续时间将不超过五分钟。
- 当缩小池 vCore 时，池所用空间必须小于目标服务层和池 vCore 所允许的最大大小。

## <a name="what-is-the-maximum-number-of-servers-and-databases"></a>服务器和数据库的最大数目是多少？

| 最大值 | 值 |
| :--- | :--- |
| 每个服务器的数据库数 | 5000 |
| 每个区域每个订阅的服务器数 | 20 |
|||

> [!IMPORTANT]
> 随着数据库的数量接近每个服务器的限制，可能出现以下情况：
> <br> •    针对主数据库运行查询的延迟增加。  这包括资源利用率统计信息的视图，如 sys.resource_stats。
> <br> •    管理操作和呈现涉及枚举服务器中的数据库的门户视点方面的延迟增加。

## <a name="what-happens-when-database-and-elastic-pool-resource-limits-are-reached"></a>当数据库和弹性池资源到达限制时会如何？

### <a name="compute-vcores"></a>计算 (vCore)

当数据库计算使用率（根据 vCore 利用率计量）变高时，查询延迟也会增加，甚至可能超时。在上述情况下，服务可能对查询排队，并在资源可用时向查询提供资源以用于执行。
计算使用率变高时，风险缓解选项包括：

- 提升数据库或弹性池的性能级别，向数据库提供更多 vCore。 请参阅[单一数据库：更改 vCore](#single-database-change-vcores) 和[弹性池：更改 vCore](#elastic-pool-change-vcores)。
- 优化查询，减少每个查询的资源使用率。 有关详细信息，请参阅[查询优化/提示](sql-database-performance-guidance.md#query-tuning-and-hinting)。

### <a name="storage"></a>存储

当使用的数据库空间到达上限时，将无法进行增加数据大小的数据库插入和更新操作，客户端会收到[错误消息](sql-database-develop-error-messages.md)。 数据库的选择和删除操作不受影响。

空间使用率变高时，风险缓解选项包括：

- 增加数据库或弹性池的大小上限或更改性能级别，以增加最大存储。 请参阅 [Azure SQL 数据库基于 vCore 的资源限制](sql-database-vcore-resource-limits.md)。
- 如果数据库在弹性池内，那么可选择将数据库移出弹性池，从而避免与其他数据库共享存储空间。

### <a name="sessions-and-workers-requests"></a>会话和辅助角色（请求） 

会话和辅助角色的数目上限由服务层和性能级别决定。 当到达会话或辅助角色上限时，新的请求将被拒绝，客户端将收到错误消息。 虽然应用程序可以轻松地控制可用的连接数，但并行辅助角色数通常更难以估计和控制。 在负荷高峰期，当数据库资源达到上限，辅助角色由于较长时间运行查询而堆积时，这种情况尤其突出。 

会话或辅助角色使用率变高时，风险缓解选项包括：
- 增加数据库或弹性池的服务层或性能级别。 请参阅[单一数据库：更改存储大小](#single-database-change-storage-size)、[单一数据库：更改 vCore](#single-database-change-vcores)、[弹性池：更改存储大小](#elastic-pool-change-storage-size)和[弹性池：更改 vCore](#elastic-pool-change-vcores)。
- 如果争用计算资源造成了辅助角色使用率上升，请优化查询，以降低每项查询的资源使用率。 有关详细信息，请参阅[查询优化/提示](sql-database-performance-guidance.md#query-tuning-and-hinting)。

## <a name="next-steps"></a>后续步骤

- 有关常见问题的解答，请参阅 [SQL 数据库常见问题解答](sql-database-faq.md)。
- 有关常规 Azure 限制的相关信息，请参阅 [Azure 订阅和服务限制、配额和约束](../azure-subscription-service-limits.md)。
