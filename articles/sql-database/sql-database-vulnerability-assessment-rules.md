---
title: SQL 漏洞评估规则参考指南
description: SQL Server、Azure SQL 数据库、Azure SQL 托管实例和 Azure Synapse Analytics 的规则标题和说明列表
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.topic: reference
author: barmichal
ms.author: mibar
ms.reviewer: vanto
ms.date: 05/08/2020
ms.openlocfilehash: d754e27a889785c029b7bb6c7b537d00f63c066b
ms.sourcegitcommit: 999ccaf74347605e32505cbcfd6121163560a4ae
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/08/2020
ms.locfileid: "82984741"
---
# <a name="sql-vulnerability-assessment-rules-reference-guide"></a>SQL 漏洞评估规则参考指南

本文列出了一组内置规则，这些规则用于标记安全漏洞并突出显示与最佳做法的偏差，如配置错误、权限过多以及未受保护的敏感数据。 这些规则基于 Microsoft 的最佳做法，并专注于对数据库及其重要数据有最大风险的安全问题。 其中涵盖数据库级别的问题以及服务器级别的安全问题，如服务器防火墙设置和服务器级别的权限。 这些规则还体现了各个监管机构提出的许多要求，旨在满足它们的符合性标准。

数据库扫描中显示的规则取决于所扫描的 SQL 版本和平台。 

若要了解如何在 Azure 中实施漏洞评估，请参阅[实施漏洞评估](https://docs.microsoft.com/azure/sql-database/sql-vulnerability-assessment#implement-vulnerability-assessment)。

## <a name="rules"></a>规则

|规则 ID  |规则标题  |规则类别  |规则严重性  |规则说明  |平台  |
|---------|---------|---------|---------|---------|---------|
| VA1017     |应撤消所有用户的 xp_cmdshell 的执行权限（dbo 除外）         |身份验证和授权         |高         |Xp_cmdshell 扩展存储过程生成 Windows 命令行界面         |<nobr>SQL Server 2012 +<sup>1</sup><nobr/>         |
| VA1018     |应安装最新的更新         |安装更新和修补程序         |高         |Microsoft 会定期发布 SQL Server 的每个版本的累积更新（Cu）。 此规则检查是否已为所用 SQL Server 的特定版本安装了最新的 CU，并传入字符串执行。 此规则检查所有用户（dbo 除外）没有执行 xp_cmdshell 扩展存储过程的权限。 |<nobr>SQL Server 2005<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/><nobr>SQL Server 2016<nobr/><br/><br/>SQL Server 2017<br/>|
|VA1020     |数据库用户来宾不应是任何角色的成员         |身份验证和授权         |高         |Guest 用户允许未映射到特定数据库用户的任何登录名访问数据库。 此规则检查是否没有为来宾用户分配数据库角色。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1021     |应删除全局临时存储过程         |数据保护         |高         |全局临时存储过程对所有会话均可见，在创建它的用户的会话结束时，将删除该存储过程。 此规则检查是否没有全局存储过程。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1022     |应禁用即席分布式查询         |面积缩减         |中         |即席分布式查询使用`OPENROWSET`和`OPENDATASOURCE`函数连接到使用 OLE DB 的远程数据源。 此规则检查是否已禁用即席分布式查询。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1023     |应禁用 CLR         |面积缩减         |高         |CLR 允许托管代码由托管代码，并在 Microsoft SQL Server 环境中运行。 此规则检查 CLR 是否已禁用。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1026     |应禁用 CLR         |面积缩减         |中         |CLR 允许托管代码由托管代码，并在 Microsoft SQL Server 环境中运行。 CLR 严格安全性将安全和 EXTERNAL_ACCESS 程序集视为它们被标记为不安全，并要求使用证书或非对称密钥对所有程序集进行签名，并使用在 master 数据库中被授予了 UNSAFE ASSEMBLY 权限的相应登录名。 此规则检查 CLR 是否已禁用。         |<nobr>SQL Server 2017 +<sup>2</sup><nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1027     |应删除未跟踪的受信任程序集         |面积缩减         |高         |标记为不安全的程序集需要使用证书或非对称密钥进行签名，该证书或非对称密钥具有在 master 数据库中被授予了 UNSAFE ASSEMBLY 权限的相应登录名。 受信任的程序集可能会绕过这一要求。          |<nobr>SQL Server 2017 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1042     |对于除`master`、和之外的所有数据库， `msdb`应禁用数据库所有权链接`tempdb`         |身份验证和授权         |高         |跨数据库所有权链接是所有权链接的扩展，只不过它跨越数据库边界。 此规则检查除`master`、 `msdb`和`tempdb`之外的所有数据库是否已禁用此选项。 对于`master`、 `msdb`、和`tempdb`，默认情况下启用跨数据库所有权链接。        |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1043     |主体来宾无权访问任何用户数据库         |身份验证和授权         |中         |Guest 用户允许未映射到特定数据库用户的任何登录名访问数据库。 此规则检查来宾用户是否无法连接到任何数据库。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1044     |应禁用远程管理连接         |面积缩减         |中         |SQL Server 提供了专用管理员连接（DAC）。 DAC 允许管理员访问运行的服务器以执行诊断函数或 Transact-sql 语句，或对服务器上的问题进行故障排除。 此规则检查是否禁用了远程专用管理员连接。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1045     |应启用默认跟踪         |审核和日志记录         |中         |默认跟踪可确保数据库管理员在问题首次出现时即具有诊断该问题所需的日志数据，从而为数据库管理员提供了故障排除帮助。 此规则检查是否已启用默认跟踪。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1046     |应为所有 SQL 登录启用 CHECK_POLICY         |身份验证和授权         |低         |CHECK_POLICY 选项允许根据域策略验证 SQL 登录名。 此规则检查是否已为所有 SQL 登录名启用 CHECK_POLICY 选项。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1047     |应为所有 SQL 登录名启用密码到期检查         |身份验证和授权         |低         |密码过期策略用于管理密码的使用期限。 如果 SQL Server 强制实施密码过期策略，则将提醒用户更改旧密码，并禁用密码过期的帐户。 此规则检查是否为所有 SQL 登录名启用了密码过期策略。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1048     |不应将数据库主体映射到`sa`帐户         |身份验证和授权         |高         |攻击者可以利用映射到`sa`帐户的数据库主体将权限提升到`sysadmin`         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1051     |应在所有数据库上禁用 AUTO_CLOSE         |面积缩减         |中         |AUTO_CLOSE 选项指定在上一个用户退出后数据库是否完全关闭并释放资源。 此规则检查是否对所有数据库禁用了此选项。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1052     |删除作为服务器登录名的 BUILTIN\Administrators         |身份验证和授权         |低         |BUILTIN\Administrators 组包含 Windows 本地管理员组。 在较旧版本的中 Microsoft SQL Server 此组在默认情况下具有管理员权限。 此规则检查是否已从 SQL Server 中删除此组。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1053     |应该重命名或`sa`禁用具有默认名称的帐户         |身份验证和授权         |低         |`sa`是一个名为的帐户，其主体 ID 为1。 此规则验证`sa`帐户是否已重命名或已禁用         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1054     |不应将过多的权限授予对象或列的公共角色         |身份验证和授权         |低         |每个 SQL Server 登录名都属于公共服务器角色。 如果未对某个服务器主体授予或拒绝对某个安全对象的特定权限，该用户将继承授予该对象的 public 权限的权限。 此规则显示所有安全对象的列表，这些对象或可由所有用户通过公共角色访问的列。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1058     |`sa`应禁用登录名         |身份验证和授权         |高         |`sa`是一个名为的帐户，其主体 ID 为1。 此规则验证`sa`帐户是否已禁用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1059     |应禁用 xp_cmdshell         |身份验证和授权         |高         |xp_cmdshell 生成一个 Windows 命令行界面并向其传递一个字符串以执行。 此规则检查是否已禁用 xp_cmdshell。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1066     |应删除未使用的 service broker 终结点         |面积缩减         |低         |Service Broker 提供 SQL Server 的队列和可靠消息传送。 Service Broker 可用于使用单个 SQL Server 实例的应用程序和在多个实例间分发工作的应用程序。 Service Broker 端点为传输安全模式和消息转发提供选项。 此规则枚举所有 service broker 终结点。 删除未使用的那些类型。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1067     |应禁用数据库邮件 XPs         |身份验证和授权         |中         |数据库邮件是一种用于从 SQL Server 发送电子邮件的企业解决方案。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1068     |不应直接向主体授予服务器权限         |身份验证和授权         |低         |服务器级权限与服务器级别对象相关联，用于控制哪些用户可以访问对象。 此规则检查是否没有直接授予登录名的服务器级别权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1069     |应从非 sysadmin 撤消从系统表和视图中进行选择的权限         |身份验证和授权         |低         |从系统表和视图中进行选择的非 sysadmin 权限存在于现成的中，通常由 SSMS 等工具使用。 此规则枚举非 sysadmin 可以访问的系统表和视图。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1070     |数据库用户不应与服务器登录名共享同一名称         |身份验证和授权         |低         |数据库用户可以与服务器登录名共享同一名称。 此规则验证没有此类用户。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1071     |应禁用 "启动时扫描存储过程" 选项         |面积缩减         |中         |启用 "扫描启动过程" 时 SQL Server 扫描并运行在服务器上定义的所有自动运行的存储过程。 如果启用此选项 SQL Server 会扫描并运行在服务器上定义的所有自动运行的存储过程。 此规则检查是否禁用了此选项。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1072     |身份验证模式应该为 Windows 身份验证         |身份验证和授权         |中         |有两种可能的身份验证模式： Windows 身份验证模式和混合模式。 混合模式意味着 SQL Server 同时启用 Windows 身份验证和 SQL Server 身份验证。 此规则检查身份验证模式是否设置为 "Windows 身份验证"。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1091     |当 "登录审核" 设置为跟踪登录名时，应启用成功和失败的登录尝试（默认跟踪）的审核         |审核和日志记录         |低         |SQL Server 登录审核配置，管理员可以跟踪登录 SQL Server 实例的用户。 如果用户选择对 "登录审核" 进行计数以跟踪登录到 SQL Server 实例的用户，则为成功和失败的登录尝试启用该功能非常重要。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1092     |SQL Server Browser 服务不应播发 SQL Server 实例         |面积缩减         |低         |SQL Server 使用 SQL Server Browser 服务枚举安装在计算机上的数据库引擎的实例。 这使客户端应用程序可以浏览服务器，并帮助客户端在同一台计算机上的多个数据库引擎实例之间进行区分。 此规则检查 SQL 实例是否处于隐藏状态。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1093     |错误日志的最大数目应为12或更多         |审核和日志记录         |低         |每个 SQL Server 错误日志将包含自上次重新启动 SQL Server 或自上次回收错误日志以来发生的故障/错误相关的所有信息。 此规则检查最大错误日志数是否为12或更多。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1094     |不应直接向主体授予数据库权限         |身份验证和授权         |低         |权限是与安全对象关联的规则，用于规定哪些用户可以访问对象。 此规则检查是否没有直接向用户授予数据库权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1095     |不应向公共角色授予过多权限         |身份验证和授权         |中         |每个 SQL Server 登录名都属于公共服务器角色。 如果未对某个服务器主体授予或拒绝对某个安全对象的特定权限，该用户将继承授予该对象的 public 权限的权限。 这会显示授予公共角色的所有权限的列表。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1096     |不应在数据库中授予 Principal GUEST 权限         |身份验证和授权         |低         |每个数据库都包含一个名为 GUEST 的用户。 授予来宾的权限由有权访问数据库但在数据库中没有用户帐户的用户继承。 此规则检查是否已从来宾用户吊销所有权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1097     |不应向主体来宾授予对对象或列的权限         |身份验证和授权         |低         |每个数据库都包含一个名为 GUEST 的用户。 授予来宾的权限由有权访问数据库但在数据库中没有用户帐户的用户继承。 此规则检查是否已从来宾用户吊销所有权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1098     |任何现有的 SSB 或镜像终结点都应需要 AES 连接         |数据保护         |高         |Service Broker 和镜像终结点支持不同的加密算法，包括非加密算法。 此规则检查任何现有终结点是否需要 AES 加密。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1099     |不应向来宾用户授予对数据库安全对象的权限         |身份验证和授权         |低         |每个数据库都包含一个名为 GUEST 的用户。 授予来宾的权限由有权访问数据库但在数据库中没有用户帐户的用户继承。 此规则检查是否已从来宾用户吊销所有权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1102     |应在除 MSDB 之外的所有数据库上禁用可信位         |面积缩减         |高         |"可信数据库" 属性用于指示 SQL Server 的实例是否信任该数据库以及其中的内容。 如果启用此选项，则使用模拟上下文的数据库模块（例如用户定义函数或存储过程）可以访问数据库以外的资源。 此规则验证是否在所有数据库（MSDB 除外）上禁用了可信位。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1143     |不应将 "dbo" 用户用于正常服务操作         |面积缩减         |中         |"Dbo" 或数据库所有者是拥有执行数据库中所有活动的暗示权限的用户帐户。 Sysadmin 固定服务器角色的成员自动映射到 dbo。 此规则检查 dbo 是否不是唯一允许访问此数据库的帐户。 请注意，在新创建的干净数据库上，在创建其他角色之前，此规则将失败。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1144     |模型数据库只能由 "dbo" 访问         |面积缩减         |中         |Model 数据库用作在 SQL Server 的实例上创建的所有数据库的模板。 对 model 数据库进行的修改（如数据库大小恢复模式和其他数据库选项）将应用于以后创建的所有数据库。 此规则检查 dbo 是否为唯一允许访问 model 数据库的帐户。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1219     |应启用透明数据加密         |数据保护         |中         |透明数据加密（TDE）通过对数据库的关联备份和事务日志文件执行实时加密和解密，无需对应用程序进行更改，从而帮助防止恶意活动的威胁。 此规则检查是否在数据库上启用了 TDE。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1220     |使用 TDS 的数据库通信应通过 TLS 进行保护         |数据保护         |高         |Microsoft SQL Server 可以使用安全套接字层（SSL）或传输层安全性（TLS）对在 SQL Server 实例与客户端应用程序之间通过网络传输的数据进行加密。 此规则检查到 SQL Server 的所有连接是否通过 TLS 加密。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1221     |数据库加密对称密钥应使用 AES 算法         |数据保护         |高         |SQL Server 使用加密密钥来帮助保护存储在服务器数据库中的数据凭据和连接信息。 SQL Server 有两种类型的密钥：对称和非对称。 此规则检查数据库加密对称密钥是否使用 AES 算法。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1222     |单元级别的加密密钥应使用 AES 算法         |数据保护         |高         |单元格级加密（CLE）允许使用对称密钥和非对称密钥对数据进行加密。 此规则检查单元级加密对称密钥是否使用 AES 算法。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1223     |证书密钥应使用至少2048位         |数据保护         |高         |证书密钥在 RSA 和其他加密算法中用于保护数据。 这些密钥的长度必须足够，以确保用户数据的安全。 此规则检查密钥长度是否为所有证书至少2048位。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1224     |非对称密钥的长度应至少为2048位         |数据保护         |高         |数据库非对称密钥用于许多加密算法这些密钥需要足够的长度才能保护加密的数据。此规则检查数据库中存储的所有非对称密钥的长度是否至少为2048位         |<nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/>SQL 数据库         |
|VA1229     |注册表和中的 Filestream 设置应匹配 SQL Server         |面积缩减         |高         |在注册表中，有两个管理 Filestream 选项的设置：一个是在注册表中（OS 级别），另一个是 SQL Server 配置。 此规则检查两个设置是否匹配。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1230     |应禁用 Filestream         |面积缩减         |高         |FILESTREAM 通过将 varbinary （max）二进制大型对象（BLOB）数据作为文件存储在文件系统上，将 SQL Server 数据库引擎与 NTFS 文件系统集成在一起。 Transact-sql 语句可以插入更新查询搜索和备份 FILESTREAM 数据。 此规则检查 Filestream 是否处于禁用状态。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1231     |应禁用 Filestream （SQL）         |面积缩减         |高         |FILESTREAM 通过将 varbinary （max）二进制大型对象（BLOB）数据作为文件存储在文件系统上，将 SQL Server 数据库引擎与 NTFS 文件系统集成在一起。 Transact-sql 语句可以插入更新查询搜索和备份 FILESTREAM 数据。 此规则检查是否禁用了 Filestream SQL 特定选项         |<nobr>SQL Server 2012 +<nobr/>          |
|VA1234     |应启用通用条件设置         |审核和日志记录         |低         |通用标准 "已启用" 设置启用常见标准符合性所需的几个元素和行为。 此规则检查是否已启用此选项。 请注意，此选项在标准版中不可用。 有关完整详细信息，请访问：[已启用通用标准符合性的服务器配置](/sql/database-engine/configure-windows/common-criteria-compliance-enabled-server-configuration-option)和[SQL Server 资源](https://www.microsoft.com/cloud-platform/sql-server-Resources)。        |<nobr>SQL Server 2012 +<nobr/>          |
|VA1235     |应禁用复制 Xp         |面积缩减         |中         |禁用复制 XPs 攻击外围应用         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1244     |应从 SQL server 数据库中删除孤立用户         |面积缩减         |中         |数据库用户在数据库中存在，但在 master 数据库中没有相应的登录名或作为外部资源（例如，Windows 用户）被称为孤立用户，应将其删除或重新映射到有效的登录名。 此规则检查是否没有孤立用户。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1245     |Dbo 信息应在目标数据库和主数据库之间保持一致         |面积缩减         |高         |对于任何数据库，都存在与 dbo 标识有关的冗余信息：存储在数据库本身中的元数据，以及存储在 master 数据库中的元数据。 此规则检查目标 DB 和 master 的此信息是否一致。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1246     |不应使用应用程序角色         |身份验证和授权         |低         |应用程序角色是一个数据库主体，它使应用程序能够使用自己的类似用户的权限运行。 使用应用程序角色，只允许通过特定应用程序连接的用户访问特定数据。 应用程序角色基于密码（通常是硬编码的应用程序），而不是基于权限的权限，该权限通过密码猜测将数据库公开给应用程序角色模拟。 此规则检查数据库中是否未定义任何应用程序角色。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库         |
|VA1247     |不应将 SPs 标记为自动启动         |面积缩减         |高         |将 SQL Server 配置为 "扫描启动过程" 时，服务器将扫描 master 数据库中标记为 "自动启动" 的存储过程。 此规则检查是否没有任何 SPs 标记为自动启动。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1248     |用户定义的数据库角色不应为固定角色的成员         |身份验证和授权         |中         |为了轻松管理数据库中的权限 SQL Server 提供了多个角色，这些角色是对其他主体进行分组的安全主体。 它们类似于 Microsoft Windows 操作系统中的组。 数据库帐户和其他 SQL Server 角色可添加到数据库级角色中。 固定数据库角色的每个成员都可向同一个角色添加其他用户。 此规则检查用户定义的角色是否为固定角色的成员。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1252     |通过服务器审核规范审核和集中管理的事件列表。         |审核和日志记录         |低         |审核 SQL Server 数据库引擎或单个数据库的实例涉及到跟踪和记录数据库引擎中发生的事件。 此规则显示正在审核的事件的列表。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1253     |通过服务器审核规范审核和集中管理的数据库范围事件的列表         |审核和日志记录         |低         |审核 SQL Server 数据库引擎或单个数据库的实例涉及到跟踪和记录数据库引擎中发生的事件。 此规则显示当前正在审核的所有事件（即链接到已启用的审核）的完整列表，该列表是特定于 DB 的托管的。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1256     |不应在数据库中定义用户 CLR 程序集         |面积缩减         |高         |CLR 程序集可用于对 SQL Server 进程执行任意代码。 此规则检查数据库中是否没有用户定义的 CLR 程序集。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1258     |数据库所有者按预期方式         |审核和日志记录         |高         |数据库所有者可以对数据库执行所有配置和维护活动，还可以在 SQL Server 中删除数据库。 跟踪数据库所有者对于避免对某些主体拥有过多的权限很重要。 创建定义数据库的预期数据库所有者的基线。 此规则检查数据库所有者是否是在基线中定义的。         |<nobr>SQL Server 2016 +<sup>3</sup><nobr/><br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1263     |列出系统中的所有活动审核         |审核和日志记录         |低         |审核 SQL Server 数据库引擎或单个数据库的实例涉及到跟踪和记录数据库引擎中发生的事件。 此规则显示当前正在审核的所有事件（例如，链接到已启用的审核）的综合列表。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1264     |应启用成功和失败的登录尝试的审核         |审核和日志记录         |低         |通过 SQL Server 审核配置，管理员可以跟踪登录他们负责的 SQL Server 实例的用户。 此规则检查是否为成功和失败的登录尝试启用了审核。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1265     |应该为包含的 DB 身份验证启用成功和失败的登录尝试审核         |审核和日志记录         |中         |通过 SQL Server 审核配置，管理员可以跟踪向他们负责的 SQL Server 实例的用户日志记录。 此规则检查是否为包含的 DB 身份验证成功和失败的登录尝试启用了审核。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1266     |应在所有 SQL 登录名上设置 "MUST_CHANGE" 选项         |身份验证和授权         |低         |如果在登录 SQL Server 上设置 MUST_CHANGE 选项，则在首次使用该登录名进行身份验证时，需要建立新密码。 此规则检查是否对所有登录名设置了此选项。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1267     |包含的用户应使用 Windows 身份验证         |身份验证和授权         |中         |包含的用户是在数据库中存在的用户，不需要登录映射。 此规则检查包含的用户是否使用 Windows 身份验证。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1276     |应禁用代理 Xp 功能         |审核和日志记录         |中         |SQL Server 代理是一种 Microsoft Windows 服务，它在 SQL Server 中执行计划的管理任务。 代理 Xp 是 SQL Server 代理所使用的扩展存储过程，可提供在 SQL Server 代理服务帐户的安全上下文下，在 DBMS 外部运行的特权操作。 此规则检查代理 Xp 功能是否处于禁用状态。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1277     |应启用 Polybase 网络加密         |面积缩减         |高         |PolyBase 是一种技术，可访问并组合从 SQL Server 中的非关系和关系数据。 Polybase 网络加密选项将 SQL Server 配置为使用 Polybase 时加密控制和数据通道。 此规则验证是否启用了此选项。         |<nobr>SQL Server 2016 +<nobr/>         |
|VA1278     |创建外部密钥管理提供程序的基线         |面积缩减         |中         |SQL Server 可扩展密钥管理（EKM）允许第三方 EKM/硬件安全模块（HSM）供应商在 SQL Server 中注册其模块。 注册后 SQL Server 用户可以使用存储在 EKM 模块上的加密密钥。 此规则显示系统中正在使用的 EKM 提供程序的列表。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1279     |应为 TDS 启用强制加密         |数据保护         |高         |如果启用数据库引擎的 "强制加密" 选项，则不管是否选中 "加密连接" 选项（如从 SSMS），客户端和服务器之间的所有通信都将加密。 此规则检查是否启用了 "强制加密" 选项。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1280     |应最大程度地减少授予公共的服务器权限         |身份验证和授权         |中         |每个 SQL Server 登录名都属于公共服务器角色。 如果未对某个服务器主体授予或拒绝对某个安全对象的特定权限，该用户将继承授予该对象的 public 权限的权限。 此规则检查是否最大程度地减少了授予公共的服务器权限。          |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1281     |应为用户定义的角色的所有成员身份         |审核和日志记录         |中         |用户定义的角色是由用户定义的安全主体，用于对主体进行分组，以便轻松管理权限。 监视这些角色非常重要，因此请务必避免具有过多的权限。 创建定义每个用户定义角色的预期成员身份的基线。 此规则检查用户定义的角色的所有成员身份是否是在基线中定义的。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1282     |应删除孤立角色         |身份验证和授权         |低         |孤立角色是用户定义的不包含成员的角色。 消除系统中不需要的孤立角色。 此规则检查是否有任何孤立角色。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA1283     |系统中至少应有1个活动审核         |审核和日志记录         |低         |审核 SQL Server 数据库引擎或单个数据库的实例涉及到跟踪和记录数据库引擎中发生的事件。 “SQL Server 审核”对象收集单个服务器实例或数据库级操作和操作组以进行监视。 此规则检查系统中是否至少有一个活动的审核。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1286     |不应直接向主体（对象或列）授予数据库权限         |身份验证和授权         |低         |权限是与安全对象关联的规则，用于规定哪些用户可以访问对象。 此规则检查是否没有直接向用户授予数据库权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA1288     |应将敏感数据列分类         |数据保护         |中         |此规则发现并反映数据库中可能敏感的数据。 结果是敏感数据库列的集合，应使用 SQL 数据发现 & 分类来查看和分类。 这允许根据数据库列的敏感性来永久标记数据库列，这允许跟踪（审核）使用分类数据和创建报表。 如果敏感数据库列未受保护，还应考虑应用 SQL 数据库的内置安全功能之一，以限制对敏感数据的访问并对其进行保护。         |<nobr/>SQL 数据库         |
|VA2000     |应授予最小主体集，从而对数据库范围内的权限授予了重大影响         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最少的一组主体授予了数据库范围内的高影响权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2001     |应为最小主体集授予对对象或列的数据库范围内的高影响权限         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最小范围的主体授予对对象或列的高影响数据库范围的权限。        |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2002     |应将最小主体集授予对各种安全对象的数据库范围内的高影响权限         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最小的一组主体授予对各种安全对象的数据库范围内权限的高影响。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2010     |应为最小主体集授予中等影响数据库范围内的权限         |身份验证和授权         |中         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最小的主体集授予了对数据库范围内的影响。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2020     |应授予最小主体集，以更改或更改任何用户数据库范围的权限         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只授予最小的一组主体，以更改或更改任何用户数据库范围内的权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2021     |应为最小主体集授予对对象或列的数据库范围的 ALTER 权限         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对对象或列的 ALTER database 作用域权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2022     |应在各种安全对象上授予最小主体集的数据库范围的 ALTER 权限         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查在各种安全对象上，只授予最小的主体集的数据库范围的 ALTER 权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2030     |应为最小主体集授予数据库范围内的 SELECT 或 EXECUTE 权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最少的一组主体授予数据库范围的选择或执行权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2031     |应为最小主体集授予数据库范围的选择          |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对对象或列的数据库范围的 SELECT 权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2032     |应为最小主体集授予针对架构的数据库范围内的 SELECT 或 EXECUTE 权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最小的一组主体授予对架构的数据库范围的 SELECT 或 EXECUTE 权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2033     |应为最小主体集授予对对象或列的数据库范围的 EXECUTE 权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对对象或列的数据库范围的 EXECUTE 权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2034     |应授予最小主体集对 XML 架构集合的数据库范围的执行权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对 XML 架构集合的数据库范围的 EXECUTE 权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库         |
|VA2040     |应授予最小主体集，从而降低数据库范围内的权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最少的一组主体授予了对数据库范围内的权限的影响。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2041     |应授予最小主体集对对象或列的数据库范围内的最小权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对对象或列的数据库范围内的权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse          |
|VA2042     |应授予最小主体集对架构的数据库范围内的最小权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最少的一组主体授予对架构的数据库范围内的权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse          |
|VA2050     |应为最小主体集授予数据库范围的视图定义权限         |身份验证和授权         |中         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只为最小的主体集授予数据库范围的视图定义权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse          |
|VA2051     |应为最小主体集授予对对象或列的数据库范围的视图定义权限         |身份验证和授权         |中         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对对象或列的数据库范围的视图定义权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse          |
|VA2052     |应为最小的主体集授予对各种安全对象的数据库范围的 VIEW DEFINITION 权限         |身份验证和授权         |中         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向一组最小的主体授予对各种安全对象的数据库范围的 VIEW DEFINITION 权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse          |
|VA2060     |应在服务器级别启用 SQL 威胁检测         |数据保护         |中         |SQL 威胁检测提供了一个安全层，用于检测 SQL 注入攻击和异常行为模式等数据库中的潜在漏洞和异常活动。 检测到潜在威胁时，威胁检测会通过电子邮件和 Azure 安全中心发送可操作的实时警报，其中包括针对特定威胁的明确调查和修正步骤。 有关详细信息，请参阅[配置威胁检测](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection)。 此检查将验证是否已启用 SQL 威胁检测         |<nobr/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2061     |应在服务器级别启用审核         |审核和日志记录         |高         |Azure SQL 数据库审核跟踪数据库事件，并将这些事件写入 Azure 存储帐户中的审核日志。 审核可帮助你了解数据库活动，并深入了解可能指示业务关注点或可疑安全冲突的差异和异常，并帮助你满足法规遵从性。 有关详细信息，请参阅[AZURE SQL 审核](https://docs.microsoft.com/azure/sql-database/sql-database-auditing)。 此规则检查是否启用了审核。         |<nobr/>SQL 数据库<br/><br/>Azure Synapse          |
|VA2062     |数据库级防火墙规则不应授予过多的访问权限         |面积缩减         |高         |Azure SQL 数据库级防火墙通过阻止对数据库的所有访问来帮助保护数据，直到指定了哪些 IP 地址具有权限。 数据库级防火墙规则根据每个请求的起始 IP 地址授予对特定数据库的访问权限。  只能通过 Transact-sql 创建和管理 master 数据库和用户数据库的数据库级防火墙规则（与服务器级防火墙规则不同，后者也可以使用 Azure 门户或 PowerShell 来创建和管理）。 有关详细信息，请参阅[AZURE SQL 数据库和 Azure Synapse ANALYTICS IP 防火墙规则](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。 此检查将验证数据库级防火墙规则是否未授予过多的访问权限。         |<nobr/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2063     |服务器级防火墙规则不应授予过多的访问权限         |面积缩减         |高         |Azure SQL server 级防火墙通过阻止对数据库的所有访问来帮助保护你的服务器，直到指定了哪些 IP 地址具有权限。 服务器级防火墙规则根据每个请求的起始 IP 地址授予对属于该服务器的所有数据库的访问权限。  服务器级防火墙规则只能通过 Transact-sql 以及 Azure 门户或 PowerShell 来创建和管理。 有关详细信息，请参阅[AZURE SQL 数据库和 Azure Synapse ANALYTICS IP 防火墙规则](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。 此检查将验证服务器级防火墙规则是否未授予过多的访问权限。         |<nobr/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2064     |应严格至少跟踪和维护数据库级防火墙规则         |面积缩减         |高         |Azure SQL 数据库级防火墙通过阻止对数据库的所有访问来帮助保护数据，直到指定了哪些 IP 地址具有权限。 数据库级防火墙规则根据每个请求的起始 IP 地址授予对特定数据库的访问权限。 只能通过 Transact-sql 创建和管理 master 数据库和用户数据库的数据库级防火墙规则（与服务器级防火墙规则不同，后者也可以使用 Azure 门户或 PowerShell 来创建和管理）。 有关详细信息，请参阅[AZURE SQL 数据库和 Azure Synapse ANALYTICS IP 防火墙规则](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。 此检查将枚举所有数据库级防火墙规则，以便能够标识并处理对它们所做的任何更改。         |<nobr/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2065     |应严格至少跟踪和维护服务器级防火墙规则         |面积缩减         |高         |Azure SQL server 级防火墙通过阻止对数据库的所有访问来帮助保护数据，直到指定了哪些 IP 地址具有权限。 服务器级防火墙规则根据每个请求的起始 IP 地址授予对属于该服务器的所有数据库的访问权限。  服务器级防火墙规则可以通过 Transact-sql 以及 Azure 门户或 PowerShell 来创建和管理。 有关详细信息，请参阅[AZURE SQL 数据库和 Azure Synapse ANALYTICS IP 防火墙规则](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。  此检查将枚举所有服务器级防火墙规则，以便能够标识并处理对它们所做的任何更改。         |<nobr/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2100     |应将最小主体集授予高影响服务器范围的权限         |身份验证和授权         |高         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只有最小的主体集被授予了服务器范围内的高影响。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2101     |应为最小主体集授予中等影响服务器范围内的权限         |身份验证和授权         |中         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只授予最小的主体集，这是对服务器范围内的影响。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2102     |应授予最小主体集，这是服务器范围内的最小权限         |身份验证和授权         |低         |每个 SQL Server 安全对象都具有与之关联的权限，可授予主体。 权限可以划分为服务器级别（分配给登录名和服务器角色）或数据库级别（分配给数据库用户和数据库角色）。 这些规则检查是否只向最少的一组主体授予对服务器范围内的权限的影响。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2103     |应撤消对扩展存储过程的不必要的执行权限         |身份验证和授权         |中         |扩展存储过程是 SQL Server 的实例可以动态加载和运行的 Dll。 SQL Server 与多个扩展存储过程一起打包，它们允许与系统 Dll 交互。 此规则检查是否已撤消对扩展存储过程的不必要的执行权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2104     |应从 PUBLIC 撤消对扩展存储过程的 Execute 权限         |身份验证和授权         |中         |扩展存储过程是 SQL Server 的实例可以动态加载和运行的 Dll。 SQL Server 与多个扩展存储过程一起打包，它们允许与系统 Dll 交互。 此规则检查是否未将不必要的执行权限授予 PUBLIC 角色。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2105     |不应轻易猜到登录密码         |身份验证和授权         |高         |此规则检查登录密码是否不易猜测。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2107     |最小主体集应为固定 Azure SQL DB master 数据库角色的成员         |身份验证和授权         |高         |SQL 数据库在 master 数据库中提供了两个受限的管理角色，可以将用户帐户添加到这些角色，以授予创建数据库或管理登录名的权限。 此规则检查最小主体集是否为这些管理角色的成员。         |<nobr/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2108     |最小主体集应为固定高影响数据库角色的成员         |身份验证和授权         |高         |SQL Server 提供有助于管理权限的角色。 角色是对其他主体进行分组的安全主体。 数据库级角色在其权限范围内是数据库范围内的。 此规则检查最小主体集是否为固定数据库角色的成员。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2109     |最小主体集应为固定低影响数据库角色的成员         |身份验证和授权         |低         |SQL Server 提供有助于管理权限的角色。 角色是对其他主体进行分组的安全主体。 数据库级角色在其权限范围内是数据库范围内的。 此规则检查最小主体集是否为固定数据库角色的成员。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2110     |应撤销对注册表的 "执行" 权限         |身份验证和授权         |高         |注册表扩展存储过程允许 Microsoft SQL Server 读取注册表中的写入和枚举值和键。 企业管理器使用它们来配置服务器。 此规则检查是否已从所有用户（dbo 除外）撤消对执行注册表扩展存储过程的权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2111     |应删除示例数据库         |面积缩减         |低         |Microsoft SQL Server 附带了几个示例数据库。 此规则检查是否已删除示例数据库。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2112     |应撤消数据转换服务（DTS）的 PUBLIC 权限         |身份验证和授权         |中         |数据转换服务（DTS）是一组对象和实用工具，可让你在数据库中自动提取转换和加载（ETL）操作。 对象是 DTS 包及其组件，而实用工具称为 DTS 工具。 此规则检查公共角色使用 DTS 系统存储过程的权限是否已撤消。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2113     |数据转换服务（DTS）权限只能授予 SSIS 角色         |身份验证和授权         |中         |数据转换服务（DTS）是一组对象和实用工具，可让你在数据库中自动提取转换和加载操作。 对象是 DTS 包及其组件，而实用工具称为 DTS 工具。 此规则检查是否只向 SSIS 角色授予使用 DTS 系统存储过程的权限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2114     |最小主体集应为高影响固定服务器角色的成员         |身份验证和授权         |高         |SQL Server 提供有助于管理权限的角色。 角色是对其他主体进行分组的安全主体。 服务器级角色在其权限范围内是服务器范围内的。 此规则检查最小主体集是否为固定服务器角色的成员。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2115     |最小主体集应为中等影响固定服务器角色的成员         |身份验证和授权         |中         |SQL Server 提供有助于管理权限的角色。 角色是对其他主体进行分组的安全主体。 服务器级角色在其权限范围内是服务器范围内的。 此规则检查最小主体集是否为固定服务器角色的成员。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2120     |应禁用可能影响安全性的功能         |面积缩减         |高         |SQL Server 能够提供多种功能和服务。 默认情况下，可能不需要提供某些功能和服务，并且启用这些功能和服务可能会对系统的安全性产生不利影响。 此规则检查这些功能是否已禁用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2121     | 应禁用 "OLE 自动化过程" 功能        |面积缩减         |高         |SQL Server 能够提供多种功能和服务。 默认情况下，某些功能和服务可能不是必需的，启用它们可能会对系统的安全性产生不利影响。 OLE 自动化过程选项控制是否可以在 Transact-sql 批处理中实例化 OLE 自动化对象。 这些是扩展存储过程，它们允许 SQL Server 用户在 SQL Server 外部执行函数。 不管它的优点如何，它也可用于攻击，也称为一种用于在目标计算机上植物文件的常用机制。 建议使用 PowerShell 作为此工具的替代方法。 此规则检查 "OLE 自动化过程" 功能是否已禁用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2122     |应禁用 "用户选项" 功能         |面积缩减         |中         |SQL Server 能够提供多种功能和服务。 默认情况下，可能不需要提供某些功能和服务，并且启用这些功能和服务可能会对系统的安全性产生不利影响。 用户选项指定所有用户的全局默认值。 将建立一个用户工作会话期间使用的默认查询处理选项的列表。 用户选项允许您更改 SET 选项的默认值（如果服务器的默认设置不合适）。 此规则检查 "用户选项" 功能是否处于禁用状态。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2123     |应禁用 "远程访问" 功能         |面积缩减         |中         |SQL Server 能够提供多种功能和服务。 默认情况下，可能不需要提供某些功能和服务，并且启用这些功能和服务可能会对系统的安全性产生不利影响。 远程访问选项控制本地存储过程在远程服务器上的执行或本地服务器上的远程存储过程。 此规则检查是否禁用了 "远程访问" 功能。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例         |
|VA2126     |应禁用可能影响安全性的功能         |面积缩减         |中         |SQL Server 能够提供多种功能和服务。 默认情况下，可能不需要提供某些功能和服务，并且启用这些功能和服务可能会对系统的安全性产生不利影响。 此规则检查这些功能是否已禁用。         |<nobr>SQL Server 2016 +<nobr/>         |
|VA2127     |应禁用 "外部脚本" 功能         |面积缩减         |高         |SQL Server 能够提供多种功能和服务。 默认情况下，可能不需要提供某些功能和服务，并且启用这些功能和服务可能会对系统的安全性产生不利影响。 "已启用外部脚本" 选项允许执行具有某些远程语言扩展的脚本。 此规则检查 "已启用外部脚本" 功能是否已禁用。         |<nobr>SQL Server 2016 +<nobr/>         |
|VA2128     |对于低于 SQL Server 2012 的 SQL Server 版本，不支持漏洞评估         |安装更新和修补程序         |高         |若要在 SQL Server 上运行漏洞评估扫描，需要将服务器升级到 SQL Server 2012 或更高版本，Microsoft 不再支持 SQL Server 2008 R2 和更高版本。 有关详细信息，请参阅<https://www.microsoft.com/cloud-platform/windows-sql-server-2008>         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 托管 <br/>实例<br/><br/>SQL 数据库<br/><br/>Azure Synapse         |
|VA2129     |应对已签名模块的更改         |身份验证和授权         |高         |您可以使用证书或非对称密钥对存储过程、函数或触发器进行签名。 此设计适用于无法通过所属权链继承权限或所属权链中断的方案，如动态 SQL。 此规则检查对已签名模块所做的更改，这可能表示恶意使用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 数据库         |
|VA2130     |跟踪对数据库具有访问权限的所有用户         |身份验证和授权         |低         |应根据最低权限原则向用户授予权限-应为每个用户授予其角色所需的最小权限集。 此检查将跟踪有权访问数据库的所有用户。 检查这些用户是否已根据其在组织中的当前角色进行了授权。 此检查中的权限信息可支持数据库的用户访问评审流程。         |<nobr>SQL 数据库<nobr/><br/><br/>Azure Synapse         |

<sup>1</sup> **SQL Server 2012 +** 指 SQL Server 2012 及更高版本的所有版本。

<sup>2</sup> **SQL Server 2017 +** 指 SQL Server 2017 及更高版本的所有版本。

<sup>3</sup> **SQL Server 2016 +** 指 SQL Server 2016 及更高版本的所有版本。

## <a name="next-steps"></a>后续步骤

- [漏洞评估](sql-vulnerability-assessment.md)
