---
title: Azure SQL 数据超大规模库概述 | Microsoft Docs
description: 本主题介绍 Azure SQL 数据库中基于 vCore 的采购模型中的超大规模服务层，并说明它与常规用途服务层和业务关键服务层的不同之处。
services: sql-database
author: CarlRabeler
ms.reviewer: carlrab
manager: craigg
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: DBs & servers
ms.topic: conceptual
ms.date: 09/23/2018
ms.author: carlrab
ms.openlocfilehash: b50d049d051a57ba12239d4619572dc0dbd7e32f
ms.sourcegitcommit: 32d218f5bd74f1cd106f4248115985df631d0a8c
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/24/2018
ms.locfileid: "46962958"
---
# <a name="what-is-the-hyperscale-service-tier-preview-in-azure-sql-database"></a>Azure SQL 数据库中的超大规模服务层（预览版）是什么？

Azure SQL 数据库中的超大规模服务层是基于 vCore 的采购模型中的最新服务层。 此服务层是一个高度可缩放的存储和计算性能层，它利用 Azure 体系结构来扩大 Azure SQL 数据库的存储和计算资源，远远超出了常规用途和业务关键服务层的可用限制。

## <a name="what-are-the-capabilities-of-the-hyperscale-service-tier"></a>超大规模服务层有哪些功能

Azure SQL 数据库中的超大规模服务层提供了以下附加功能：

- 支持高达 100 TB 的数据库大小 
- 大型数据库备份更快（基于文件快照）
- 数据库还原更快（基于文件快照） 
- 无论数据卷如何，由于更高的日志吞吐量和更快的事务提交速度，整体性能更高 
- 快速横向扩展 - 可预配一个或多个只读节点，以卸载读取工作负载并用作热备用服务器
- 快速纵向扩展 - 可在不变的时间内纵向扩展计算资源，以在需要时适应繁重的工作负载，然后在不需要时缩减计算资源。 

超大规模服务层消除了传统上云数据库中出现的许多实际限制。 当大多数其他数据库受单个节点中可用资源的限制时，超大规模服务层中的数据库则没有此类限制。 凭借其灵活的存储体系结构，可根据需要扩大存储容量。 实际上，不会使用定义的最大大小创建超大规模数据库。 超大规模数据库会按需扩大，你仅需为所使用的容量付费。 对于读取密集型工作负载，超大规模服务层通过按需预配其他只读副本来卸载读取工作负载，从而实现快速横向扩展。 

此外，创建数据库备份或纵向扩展/横向扩展所需的时间不再与数据库中的数据卷相关。 几乎可以即时备份超大规模数据库。 还可在几分钟内纵向扩展或横向扩展数十 TB 的数据库。 此功能使你无需担心受初始配置选项的约束。 

有关超大规模服务层计算大小的详细信息，请参阅[选择 vCore 服务层、计算、内存、存储和 IO 资源](sql-database-service-tiers-vcore.md)。

## <a name="who-should-consider-the-hyperscale-service-tier"></a>哪些群体应考虑使用超大规模服务层

超大规模服务层主要面向在本地拥有大型数据库并希望通过迁移到云来实现应用程序现代化的客户，或已在云中并受到最大数据库大小限制 (1-4 TB) 的客户。 它也适用于那些寻求存储和计算的高性能和高可伸缩性的客户。

超大规模服务层支持所有 SQL Server 工作负载，但它主要针对 OLTP 进行优化。 超大规模服务层还支持混合和分析（数据市场）工作负载。 

> [!IMPORTANT]
> 弹性池不支持超大规模服务层。

## <a name="architecture-distributing-functions-to-isolate-capabilities"></a>体系结构：分发函数以隔离功能

不同于将所有数据管理功能集中在一个位置/进程中的传统数据库引擎（即便是当今生产中所谓的分布式数据库也有单片数据引擎的多个副本），超大规模数据库将查询处理引擎（其中各种数据引擎的语义不同）与为数据提供长期存储和持久性的组件分隔开来。 通过这种方式，可根据需要顺利地扩大存储容量（初始目标是 100 TB）。 只读副本共享相同的计算组件，因此无需数据副本来启动新的可读副本。

下图说明了超大规模数据库中不同类型的节点：

![体系结构](./media/sql-database-hyperscale/hyperscale-architecture.png)

超大规模数据库包含以下不同类型的节点：
 
### <a name="compute-node"></a>计算节点

计算节点是关系引擎的所在位置，因此会出现所有语言元素、查询处理等。 所有用户与超大规模数据库的交互都通过这些计算节点进行。 计算节点具有基于 SSD 的缓存（在上图中标记为 RBPEX - 可复原缓冲池扩展），可最小化提取一页数据所需的网络往返次数。 其中有一个处理所有读写工作负载和事务的主计算节点。 有一个或多个充当热备用服务器节点的辅助计算节点，用于进行故障转移，也充当用于卸载只读工作负载的只读计算节点（如需此功能）。

### <a name="page-server-node"></a>页面服务器节点

页面服务器是表示横向扩展存储引擎的系统。  每个页面服务器负责数据库中页面的一个子集。  名义上，每个页面服务器控制 1 TB 的数据。 多个页面服务器上不共享任何数据（为冗余和可用性而保留的副本除外）。 页面服务器的任务是按需向计算节点提供数据库页面，并在事务更新数据时持续更新页面。 页面服务器通过从日志服务播放日志记录来保持最新。 页面服务器还保留基于 SSD 的缓存，可提高性能。 数据页的长期存储保存在 Azure 存储中，可提高可靠性。

### <a name="log-service-node"></a>日志服务节点

日志服务节点接受来自主计算节点的日志记录，将其保存在永久缓存中，并将日志记录转发给其余计算节点（以便它们可以更新缓存）以及一个或多个相关页面服务器，以便可在此处更新数据。 通过这种方式，主计算节点中的所有数据更改都通过日志服务传播到所有辅助计算节点和页面服务器中。 最后，日志记录被推送到 Azure 存储的长期存储（无限存储库）中。 此机制消除了频繁截断日志的必要性。 日志服务还具有本地缓存，可加快访问速度。

### <a name="azure-storage-node"></a>Azure 存储节点

Azure 存储节点是页面服务器中数据的最终目标。 此存储用于备份用途以及 Azure 区域之间的复制。 备份包括数据文件的快照。 从这些快照还原操作很快，数据可还原到任何时间点。 

## <a name="backup-and-restore"></a>备份和还原

备份是文件快照库，因此它们几乎是瞬时完成的。 存储和计算分离可将备份/还原操作推送到存储层，以减少主计算节点的处理负担。 因此，大型数据库的备份不会影响主计算节点的性能。 同样，还原是通过复制文件快照完成的，因此不是数据操作的大小。 对于同一存储帐户中的还原，还原操作很快。

## <a name="scale-and-performance-advantages"></a>缩放和性能优势

超大规模体系结构能快速启动/关闭其他只读计算节点，拥有重要的读取扩展功能，还可以释放主计算节点，以满足更多写入请求。 此外，由于超大规模体系结构的共享存储体系结构，可快速纵向扩展/横向扩展计算节点。 


## <a name="next-steps"></a>后续步骤

- 有关服务层的信息，请参阅[服务层](sql-database-service-tiers.md)
- 有关资源限制的详细信息，请参阅 [vCore 资源限制](sql-database-resource-limits.md)
- 有关功能和比较列表，请参阅 [SQL 常用功能](sql-database-features.md)。
