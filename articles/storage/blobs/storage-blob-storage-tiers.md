---
title: 热、 冷或存档访问层的 blob 的 Azure 存储
description: 热、 冷或存档访问层的 Azure 存储帐户。
services: storage
author: mhopkins-msft
ms.service: storage
ms.topic: conceptual
ms.date: 03/23/2019
ms.author: mhopkins
ms.subservice: blobs
ms.openlocfilehash: 78158f49748a8e9e08f3695860d95a2a6eff9fd4
ms.sourcegitcommit: 81fa781f907405c215073c4e0441f9952fe80fe5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/25/2019
ms.locfileid: "58402433"
---
# <a name="azure-blob-storage-hot-cool-and-archive-access-tiers"></a>Azure Blob 存储： 热、 冷和存档访问层

Azure 存储提供不同的访问层，这允许您以最具成本效益的方式存储 blob 对象数据。 可用的访问层包括：

- **热**-已用于存储经常访问的数据进行优化。
- **冷**-已用于存储不常访问且存储时间至少 30 天的数据进行优化。
- **存档**-针对存储的数据进行极少访问、 存储时间至少为 180 天且延迟要求 （几小时） 进行了优化。

以下注意事项适用于不同的访问层：

- 存档访问层是可用的仅在 blob 级别而不是在存储帐户级别。
- 冷访问层中的数据可容许略低的可用性，但仍需要高持续性和像热数据一样的类似访问时间以及吞吐量特征。 对于冷数据，略低的可用性服务级别协议 (SLA) 和更高版本访问热数据相比的成本是可接受的因为存储成本较低。
- 存档存储是脱机的，其存储成本最低，但访问成本最高。
- 可以在帐户级别设置只有热和冷访问层。
- 热层、 冷和存档层中可以设置在对象级别。

存储在云中的数据以指数速度增长。 若要针对不断增加的存储需求来管理成本，可以根据属性（如访问频率和计划保留期）整理数据以优化成本。 在云中存储的数据可能会如何它已生成、 处理和生存期内访问方面不同。 某些数据在其整个生存期中都会受到积极的访问和修改。 某些数据则在生存期早期会受到频繁的访问，随着数据变旧，访问会极大地减少。 某些数据在云中保持空闲状态并且很少，如果它存储后，访问。

每种数据访问方案受益于针对特定访问模式进行了优化的不同的访问层。 与热、 冷和存档访问层中，Azure Blob 存储地址具有不同的访问层的需要单独的定价模型。

## <a name="storage-accounts-that-support-tiering"></a>支持分层的存储帐户

您只能在对象存储将数据分层到热、 冷或存档 Blob 存储和常规用途 v2 (GPv2) 帐户。 常规用途 v1 (GPv1) 帐户不支持分层。 但是，可以轻松地将现有的 GPv1 或 Blob 存储帐户转换为 GPv2 帐户，通过在 Azure 门户中的点击式过程。 GPv2 为 blob、 文件和队列和各种其他新的存储功能的访问权限提供了新的定价结构。 展望未来，将仅在 GPv2 帐户中提供一些新功能和价格折扣。 因此，应使用 GPv2 帐户进行评估，但仅在查看所有服务的都定价后使用它们。 某些工作负荷可能会在 GPv2 比在 GPv1 更昂贵。 有关详细信息，请参阅 [Azure 存储帐户概述](../common/storage-account-overview.md)。

Blob 存储和 GPv2 帐户公开**访问层**在帐户级别的属性。 此属性允许你指定为热层还是冷不具有显式在对象级别设置层的存储帐户中任何 blob 的默认访问层。 对于已在对象级别设置该层的对象，不会应用帐户层。 可以仅在对象级别应用存档层。 可以随时在这些访问层之间进行切换。

## <a name="premium-performance-block-blob-storage"></a>高级性能数据块 blob 存储

高级性能数据块 blob 存储经常访问的数据通过将提供高性能硬件。 此性能层中的数据存储在固态驱动器 (Ssd)，针对低和一致延迟进行了优化。 SSDs 提供更高的事务率和吞吐量，相比传统硬盘驱动器。

高级性能数据块 blob 存储非常适合于需要快速且一致的响应时间的工作负荷。 最好是用于执行许多小事务，例如捕获遥测数据、 消息和数据转换的工作负荷。 涉及最终用户，如交互式视频编辑、 静态 web 内容和在线交易的数据也是很好的候选。

高级性能数据块 blob 存储可仅通过块 blob 存储帐户类型，并且当前不支持分层热、 冷或存档访问层。

## <a name="hot-access-tier"></a>热访问层

热访问层的存储成本高于冷和存档层，但访问成本最低。 热访问层的示例使用方案包括：

- 处于使用中或预期会频繁访问 （读取和写入） 的数据。
- 分阶段进行处理，并最终迁移到冷访问层的数据。

## <a name="cool-access-tier"></a>冷访问层

冷访问层的存储成本较低与热存储相比的访问费用较高。 此层适用于将要保留在冷层中至少 30 天的数据。 冷访问层的示例使用方案包括：

- 短期备份和灾难恢复数据集。
- 不再经常查看、但访问时应立即可用的较旧的媒体内容。
- 在收集更多数据以便将来处理时需要经济高效地存储的大型数据集。 （例如，长期存储的科学数据、来自制造设施的原始遥测数据）

## <a name="archive-access-tier"></a>存档访问层

存档访问层具有最低的存储成本和数据检索费用较高相比热和冷层。 此层适用于可以容忍数小时的检索延迟且会保留在存档层至少 180 天的数据。

存档存储 blob 时，blob 数据处于脱机状态，并且不能读取、 复制、 覆盖或修改。 存档存储中，不能创建的 blob 的快照。 但是，Blob 元数据会保持联机和可用状态，因而可列出 Blob 及其属性。 对于在存档中的 blob，唯一有效的操作是 GetBlobProperties、 GetBlobMetadata、 ListBlobs、 SetBlobTier 和 DeleteBlob。

存档访问层的示例使用方案包括：

- 长期备份、辅助备份和存档数据集
- 必须保留的原始数据，即使它已被处理为最终可用的形式。 （例如，转码为其他格式后的原始媒体文件）
- 需要长时间存储并且几乎不访问的合规性和存档数据。 (*例如*，安全相机数据片段、 旧 X 线 /mri 医疗保健组织、 音频记录、 和的客户脚本调用适用于金融服务)

### <a name="blob-rehydration"></a>Blob 解除冻结

若要读取存档存储中的数据，必须先将 Blob 的层更改为热层或冷层。 此过程称为解除冻结，可能需要长达 15 小时才能完成。 为获得最佳性能，建议使用大型 Blob。 同时解冻多个小型 Blob 可能导致该时间延长。

在解除冻结期间，可以通过查看“存档状态”Blob 属性来确认该层是否已更改。 状态显示为“rehydrate-pending-to-hot”或“rehydrate-pending-to-cool”，具体取决于目标层。 完成后，“存档状态”属性会被删除，“访问层”Blob 属性会反映出新层是热层还是冷层。  

## <a name="blob-level-tiering"></a>Blob 级别分层

使用 Blob 级分层功能即可通过名为[设置 Blob 层](/rest/api/storageservices/set-blob-tier)的单一操作在对象级别更改数据的层。 可以在使用模式更改时轻松地在热、冷或存档层之间更改 Blob 的访问层，不需在帐户之间移动数据。 所有层级更改都会立即执行。 但是，从存档层中解除冻结 blob 可能需要几个小时。

上次 Blob 层更改的时间通过 Blob 属性“访问层更改时间”公开。 如果某个 blob 位于存档层，它不能被覆盖，因此在此方案中不允许上传相同的 blob。 您可以覆盖热层还是冷层，在其中用例的新 blob 将继承被覆盖的 blob 的层中的 blob。

所有三种访问层中的 blob 可以共存于同一帐户内。 如果 Blob 没有显式分配的层，则会从帐户访问层设置推断相应的层。 如果访问层是从帐户推断出来的，则可看到Blob 属性“推断的访问层”已设置为“true”，且 Blob 属性“访问层”与帐户层匹配。 在 Azure 门户中，推断的访问层与 blob 访问层显示属性 (例如，**热 （推断）** 或**冷 （推断）**)。

> [!NOTE]
> 存档存储和 Blob 级别分层仅支持块 Blob。 也不能更改包含快照的块 Blob 的层。

> [!NOTE]
> 当前无法分层块 blob 存储帐户中存储的数据热、 冷或存档使用[设置 Blob 层](/rest/api/storageservices/set-blob-tier)或使用 Azure Blob 存储生命周期管理。
> 若要移动数据，您必须以同步方式将 blob 复制从块 blob 存储帐户到在不同的帐户中使用热访问层[放置 URL API 从块](/rest/api/storageservices/put-block-from-url)或 AzCopy 支持此 API 版本。
> *通过 URL 放置块* API 同步复制服务器上的数据，这意味着只有在所有数据都从原服务器位置移动到目标位置后，调用才会完成。

### <a name="blob-lifecycle-management"></a>Blob 生命周期管理

Blob 存储生命周期管理（预览版）提供丰富的基于规则的策略，用于将数据转移到最适合的访问层，并在数据的生命周期结束时使数据过期。 请参阅[管理 Azure Blob 存储生命周期](storage-lifecycle-management-concepts.md)来了解详细信息。  

### <a name="blob-level-tiering-billing"></a>Blob 级别分层计费

将 blob 移到更冷的层（热->冷、热->存档或冷->存档）时，操作按目标层写入操作计费，具体说来就是按目标层的写入操作次数（以 10,000 次为单位）和数据写入量（以 GB 为单位）收费。

当将 blob 移到更暖的层 （存档-> 冷、 存档-> 热或冷-> 热），其中的读取的操作 （按 10,000 计） 和源层的数据检索量 （以 GB) 收费应用的源层读取计费操作。 下表总结了如何对层更改进行计费。

| | **写入费用（操作 + 访问）** | **读取费用（操作 + 访问）**
| ---- | ----- | ----- |
| **SetBlobTier 方向** | 热-> 冷、 热-> 存档，冷-> 存档 | 存档-> 冷、 存档-> 热、 冷-> 热

如果将帐户层从热切换为冷，则只按 GPv2 帐户中没有设置层的所有 Blob 的写入操作次数（以 10,000 次为单位）收费。 不会在 Blob 存储帐户中对此更改收费。 如果将 Blob 存储或 GPv2 帐户从冷切换为热，则会按读取操作次数（以 10,000 次为单位）和数据检索量（以 GB 为单位）收费。 也可能还会收取从池或存档层移出的任何 Blob 的早期删除费用。

### <a name="cool-and-archive-early-deletion"></a>“冷”层和“存档”层提前删除

除了按 GB 和按月收费，移到冷层（仅限 GPv2 帐户）中的 Blob 会有一个 30 天的冷层早期删除期限，移到存档层中的 Blob 会有一个 180 天的存档层早期删除期限。 此项费用按比例计算。 例如，如果将某个 Blob 移到存档层，然后在 45 天后将其删除或移到热层，则需支付相当于将该 Blob 存储在存档层中 135（180 减 45）天的早期删除费用。

如果没有访问层更改，则可以使用 blob 属性“creation-time”来计算早期删除费用。 否则，你可以使用的访问层上次修改冷或存档到通过查看 blob 属性：**访问层更改时间**。 有关 Blob 属性的详细信息，请参阅[获取 Blob 属性](https://docs.microsoft.com/rest/api/storageservices/get-blob-properties)。

## <a name="comparing-block-blob-storage-options"></a>比较块 blob 存储选项

下表显示了一个比较的高级性能数据块 blob 存储，并在热、 冷和存档访问层。

|                                           | **高级性能** | **热层** | **冷层** | **存档层**
| ----------------------------------------- | ---------------- | ------------ | ----- | ----- |
| **可用性**                          | 99.9%            | 99.9%        | 99% | 不适用 |
| **可用性** <br> （RA-GRS 读取）  | 不适用              | 99.99%       | 99.9% | 不适用 |
| 使用费                         | 存储成本较高、 较低的访问和事务成本 | 存储费用较高，访问和事务费用较低 | 存储费用较低，访问和事务费用较高 | 存储费用最低，访问和事务费用最高 |
| 最小对象大小                   | 不适用 | 不适用 | 不适用 | 不适用 |
| 最短存储持续时间              | 不适用 | 不适用 | 30 天（仅 GPv2） | 180 天
| **延迟** <br> （距第一字节时间） | 个位数毫秒 | 毫秒 | 毫秒 | < 15 小时

> [!NOTE]
> 有关可伸缩性和性能目标，请参阅[的存储帐户的 Azure 存储可伸缩性和性能目标](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

## <a name="quickstart-scenarios"></a>快速入门方案

本部分使用 Azure 门户演示以下方案：

- 如何更改 GPv2 或 Blob 存储帐户的默认帐户访问层。
- 如何更改 GPv2 或 Blob 存储帐户中 Blob 的层。

### <a name="change-the-default-account-access-tier-of-a-gpv2-or-blob-storage-account"></a>更改 GPv2 或 Blob 存储帐户的默认帐户访问层

1. 登录到 [Azure 门户](https://portal.azure.com)。

1. 要导航到存储帐户，请先选择“所有资源”，然后选择存储帐户。

1. 在“设置”边栏选项卡中，单击“ **配置** ”以查看和/或更改帐户配置。

1. 选择你的需求的正确的访问权限层：将“访问层”设置为“冷”或“热”。

1. 单击边栏选项卡顶部的“保存”。

### <a name="change-the-tier-of-a-blob-in-a-gpv2-or-blob-storage-account"></a>更改 GPv2 或 Blob 存储帐户中 blob 的层

1. 登录到 [Azure 门户](https://portal.azure.com)。

1. 若要导航到你的存储帐户中的 blob，请选择**的所有资源**，选择你的存储帐户，选择你的容器，，然后选择你的 blob。

1. 在中**Blob 属性**边栏选项卡，选择**访问层**下拉菜单以选择**热**，**冷**，或**存档**访问层。

1. 单击边栏选项卡顶部的“保存”。

## <a name="pricing-and-billing"></a>定价和计费

所有存储帐户使用的定价模型都适用于 Blob 存储，具体取决于每个 blob 的层。 请紧记以下计费注意事项：

- **存储成本**：除了存储的数据量，存储数据的成本而异的访问层。 层越冷，单 GB 成本越低。
- **数据访问成本**：层越冷，数据访问费用越高。 对于冷和存档访问层中的数据，将会根据读取每个千兆字节的数据访问费用。
- **事务成本**：层越冷，每个层的按事务收费越高。
- **异地复制数据传输成本**：此费用仅适用于配置了异地复制的帐户，包括 GRS 和 RA-GRS。 异地复制数据传输会产生每 GB 费用。
- **出站数据传输成本**：出站数据传输（传出 Azure 区域的数据）会按每 GB 产生带宽使用费，与通用存储帐户一致。
- **更改访问层**:帐户访问层从冷更改为热产生的费用等于读取存储帐户中存在的所有数据。 但是，将帐户访问层从“热”更改为“冷”产生的费用则相当于将所有数据写入冷层（仅限 GPv2 帐户）。

> [!NOTE]
> 有关 Blob 存储帐户的详细定价信息，请参阅 [Azure 存储定价](https://azure.microsoft.com/pricing/details/storage/)页。 有关出站数据传输收费的详细信息，请参阅[数据传输定价详细信息](https://azure.microsoft.com/pricing/details/data-transfers/)页。

## <a name="faq"></a>常见问题解答

**如果要对数据分层，是应该使用 Blob 存储帐户还是 GPv2 帐户？**

建议使用 GPv2 帐户而非 Blob 存储帐户进行分层。 GPv2 支持 Blob 存储帐户支持的所有功能，以及许多其他功能。 Blob 存储和 GPv2 的定价几乎相同，但某些新功能和价格折扣只提供给 GPv2 帐户。 GPv1 帐户不支持分层。

GPv1 和 GPv2 帐户的定价结构不同，客户在决定使用 GPv2 帐户之前，应仔细评估这二者。 只需单击一下，即可轻松地将现有的 Blob 存储或 GPv1 帐户转换为 GPv2 帐户。 有关详细信息，请参阅 [Azure 存储帐户概述](../common/storage-account-overview.md)。

**可以将对象存储在所有这三个 （热、 冷和存档） 访问相同的帐户中的层？**

是的。 在帐户级别设置的“访问层”属性是一个默认层，适用于该帐户中没有显式设置层的所有对象。 但是，Blob 级别分层允许在对象级别设置访问层，不管该帐户上的访问层设置如何。 任何三个访问层中的 blob （热、 冷或存档） 可能存在同一帐户内。

**可以更改我的 Blob 或 GPv2 存储帐户的默认访问层？**

是的可以通过设置更改的默认访问层**访问层**个存储帐户的属性。 更改访问层适用于存储帐户中没有显式设置层的所有对象。 访问层从热切换为冷没有设置层仅限 GPv2 帐户中的所有 blob 产生写入操作 （按 10,000 计），而从冷热切换会产生读取的操作 （按 10,000 计） 和 （按 gb 计） 的数据检索费用为 Blob 存储中的所有 blob帐户和 GPv2 帐户。

**能否将默认帐户访问层设置为存档层？**

不是。 仅可能将热和冷访问层设置为默认帐户访问层。 只能在对象级别设置存档层。

**在其中区域是热、 冷和存档访问层中可用？**

在所有区域均可用的热和冷访问层以及 blob 级别分层。 存档存储一开始只会在选定区域提供。 如需完整列表，请参阅 [Azure 产品（按区域）](https://azure.microsoft.com/regions/services/)。

**冷访问层中的 blob 行为与热访问层中的方式？**

热访问层中的 blob 在 GPv1 和 GPv2，Blob 存储帐户中具有 blob 相同的延迟。 冷访问层中的 blob GPv1 和 GPv2，Blob 存储帐户中有类似的延迟 （以毫秒为单位） 为 blob。 存档访问层中的 blob GPv1 和 GPv2，Blob 存储帐户中有几个小时的延迟。

冷访问层中的 blob 具有比存储在热访问层中的 blob 略低可用性服务级别 (SLA)。 有关详细信息，请参阅[存储的 SLA](https://azure.microsoft.com/support/legal/sla/storage/v1_2/)。

**热层、冷层和存档层中的操作是否相同？**

是的。 热层和冷层中的所有操作 100% 一致。 热层和冷层中所有有效的存档操作（包括删除、列出、获取 Blob 属性/元数据，以及设置 Blob 层）100% 一致。 存档层中的 Blob 无法读取或修改。

**通过解冻方式将 Blob 从存档层移到热层或冷层时，如何确定解除冻结操作何时完成？**

在解除冻结期间，可以使用“获取 Blob 属性”操作来轮询“存档状态”属性，确认层更改的完成时间。 状态显示为“rehydrate-pending-to-hot”或“rehydrate-pending-to-cool”，具体取决于目标层。 完成后，“存档状态”属性会被删除，“访问层”Blob 属性会反映出新层是热层还是冷层。  

**设置 Blob 的层以后，何时开始按相应费率收费？**

每个 blob 始终按其“访问层”属性指示的层收费。 为 blob 设置新层后，“访问层”属性会立即为所有转换显示该新层。 但是，将 blob 从存档层解除冻结到热层或冷层可能需要几个小时。 在这种情况下，仍按存档层费率计费，直至解除冻结操作完成。解冻后“访问层”属性会反映该新层。 那时便按热层或冷层费率对该 blob 收费。

**如何确定在删除或移出冷层或存档层的 Blob 时是否会产生早期删除费用？**

在删除或移出冷层（仅限 GPv2 帐户）或存档层的任何 Blob 时，如果相应的存储时间不足 30 天（冷层）和 180 天（存档层），则会产生按比例计费的早期删除费用。 若要确定 blob 已在冷层或存档层中存储了多长时间，可以查看“访问层更改时间”blob 属性，该属性提供上次进行层更改的戳记。 有关详细信息，请参阅[冷和存档提前删除](#cool-and-archive-early-deletion)。

**哪些 Azure 工具和 SDK 支持 Blob 级别的分层和存档存储？**

Azure 门户、PowerShell 和 CLI 工具以及 .NET、Java、Python 和 Node.js 客户端库都支持 Blob 级别的分层和存档存储。  

**可以在热层、冷层和存档层中存储多少数据？**

在帐户级别而不是每个访问级别设置数据存储和其他限制。 因此，可以选择在一个层中用完所有存储配额，也可以分散用于三个层。 有关详细信息，请参阅 [Azure 存储可伸缩性和性能目标](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)。

## <a name="next-steps"></a>后续步骤

### <a name="evaluate-hot-cool-and-archive-in-gpv2-blob-storage-accounts"></a>评估 GPv2 Blob 存储帐户中的热层、冷层和存档层

[按区域查看热层、冷层和存档层](https://azure.microsoft.com/regions/#services)

[管理 Azure Blob 存储生命周期](storage-lifecycle-management-concepts.md)

[通过启用 Azure 存储度量值来评估当前存储帐户的使用情况](../common/storage-enable-and-view-metrics.md)

[按区域查看 Blob 存储帐户和 GPv2 帐户中的热层、冷层和存档层定价](https://azure.microsoft.com/pricing/details/storage/)

[检查数据传输定价](https://azure.microsoft.com/pricing/details/data-transfers/)