---
title: SMOTE
titleSuffix: Azure Machine Learning
description: 了解如何在 Azure 机器学习中使用 SMOTE 模块，以通过使用过度抽样增加数据集中的低端示例数。
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 10/16/2019
ms.openlocfilehash: 4b6944f7703500a2c3859e8e3111eceefbd5ff10
ms.sourcegitcommit: a9b1f7d5111cb07e3462973eb607ff1e512bc407
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/22/2020
ms.locfileid: "76311404"
---
# <a name="smote"></a>SMOTE

本文介绍如何使用 Azure 机器学习设计器中的 SMOTE 模块增加用于机器学习的数据集中常见事例的数量。 SMOTE 是一种更好的方法来增加不只是复制现有事例的罕见事例的数量。  

将 SMOTE 模块连接到*不均衡*的数据集。 数据集可能不均衡的原因有很多。 例如，要作为目标的类别在总体中可能很少，或者数据可能难于收集。 通常，当要分析的*类*是常见时，可以使用 SMOTE。 
  
该模块将返回包含原始示例的数据集。 它还会返回大量的综合少数示例，具体取决于指定的百分比。  
  
## <a name="more-about-smote"></a>有关 SMOTE 的详细信息

综合少数过度抽样技术（SMOTE）是一种统计方法，用于以均衡的方式增加数据集中的事例数。 该模块的工作原理是从你作为输入提供的现有少数情况生成新的实例。 SMOTE 的这种实现*不会更改多数*情况。

新实例不只是现有少数事例的副本。 相反，该算法将为每个目标类及其最近的相邻项使用*功能空间*的示例。 然后，该算法会生成新的示例，这些示例将目标用例的功能与它的邻居的功能组合在一起。 此方法会增加每个类可用的特征，并使样本更通用。
  
SMOTE 将整个数据集作为输入，但会增加仅限少数事例的百分比。 例如，假设你有一个不均衡数据集，其中只有1% 的事例具有目标值 A （少数类），99% 的事例的值为 B。若要将少数事例的百分比增加到前面的百分比两倍，请在模块的属性中输入**200**作为**SMOTE 百分比**。  
  
## <a name="examples"></a>示例  

建议你尝试对小型数据集使用 SMOTE 以查看它的工作原理。 下面的示例使用 Azure 机器学习设计器中提供的血糖捐赠数据集。
  
如果将数据集添加到管道并在数据集的输出中选择 "**可视化**"，则可以看到数据集中的748行或事例，570事例（76百分比）的类型为0，178事例（24%）为类1。 虽然这种结果并不不均衡，但类1表示捐赠血的人员，因此这些行包含要建模的*功能空间*。
 
若要增加事例数，可以使用100的倍数设置**SMOTE 百分比**的值，如下所示：

||0 类|类1|total|  
|-|-------------|-------------|-----------|  
|原始数据集<br /><br /> （等效于**SMOTE 百分比** = **0**）|570<br /><br /> 76%|178<br /><br /> 随时|748|  
|**100** = **SMOTE 百分比**|570<br /><br /> 62%|356<br /><br /> 38%|926|  
|**200** = **SMOTE 百分比**|570<br /><br /> 52%|534<br /><br /> 48%|1,104|  
|**300** = **SMOTE 百分比**|570<br /><br /> 44%|712<br /><br /> 56%|1282|  
  
> [!WARNING]
> 不保证使用 SMOTE 增加事例数，从而生成更准确的模型。 尝试以不同的百分比、不同的功能集和不同数量的相邻的管道来处理管道，以了解添加事例对模型的影响。  
  
## <a name="how-to-configure-smote"></a>如何配置 SMOTE
  
1.  将 SMOTE 模块添加到管道。 您可以在 "**数据转换" 模块**下的 "**操作**" 类别中找到该模块。

2. 连接要提升的数据集。 如果要使用特定的列或通过排除某些列来指定用于构建新事例的特征空间，请使用 "[选择数据集中的列](select-columns-in-dataset.md)" 模块。 然后，可以在使用 SMOTE 之前隔离要使用的列。
  
    否则，通过 SMOTE 创建新事例基于你作为输入提供的*所有*列。 功能列中至少有一列为数值。
  
3.  确保选择包含标签或目标类的列。 SMOTE 仅接受二进制标签。
  
4.  SMOTE 模块自动标识标签列中的少数类，然后获取该少数类的所有示例。 所有列都不能有 NaN 值。
  
5.  在 " **SMOTE 百分比**" 选项中，输入一个整数，该整数指示输出数据集中的少数事例的目标百分比。 例如：  
  
    - 输入**0**。 SMOTE 模块返回的数据集与您提供的输入完全相同。 它不添加任何新的少数情况。 在此数据集中，类比例尚未更改。  
  
    - 输入**100**。 SMOTE 模块生成新的少数情况。 它添加了与原始数据集中相同数量的少数情况。 由于 SMOTE 不会增加多数情况，因此每个类的事例比例也发生了变化。  
  
    - 输入**200**。 该模块会使与原始数据集相比的少数事例的百分比加倍。 这*并不会*产生两个以上的少数事例。 相反，数据集的大小会增加，这种情况下，多数情况下的数量会保持不变。 少数情况下，将增加少数情况，直到它与所需的百分比值匹配。  
  
    > [!NOTE]
    > 对于 SMOTE 百分比，只使用100的倍数。

6.  使用**最近的邻居选项数**可确定 SMOTE 算法在构建新用例时使用的特征空间大小。 最近的相邻节点是一个类似于目标用例的数据行（事例）。 任何两个用例之间的差距可通过结合所有功能的加权向量来测量。  
  
    + 通过增加最近邻居的数量，你可以获得更多情况下的功能。
    + 通过保持最接近的邻居的数量，你可以使用更类似于原始示例中的功能。  
  
7. 如果要使用相同的数据确保相同的管道运行相同的结果，请在 "**随机种子**" 框中输入一个值。 否则，在部署管道时，模块将基于处理器时钟值生成随机种子。 随机种子的生成可能会导致运行结果略有不同。

8. 运行管道。  
  
   模块的输出是一个数据集，其中包含原始行以及包含少数情况的已添加行。  

## <a name="technical-notes"></a>技术说明

+ 在发布使用**SMOTE**模块的模型时，请从预测管道中删除**SMOTE** ，然后将其作为 web 服务发布。 原因在于，SMOTE 旨在改进培训期间的模型，而不是用于评分。 如果已发布的预测管道包含 SMOTE 模块，则可能会出现错误。

+ 如果在应用 SMOTE 之前清理缺失值或应用其他转换来修复数据，则通常可以获得更好的结果。 

+ 一些研究人员调查了 SMOTE 对三维或稀疏数据的有效性，如用于文本分类或基因组学数据集的数据。 本文提供了在这种情况下应用 SMOTE 的效果和理论有效性的很好摘要： [Blagus 和 Lusa： SMOTE 适用于三维类-不均衡数据](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-106)。

+ 如果 SMOTE 在数据集中无效，则可以考虑的其他方法包括：
  + 用于过度抽样少数事例或 undersampling 的方法。
  + 使用聚类分析、装袋或自适应增强功能直接帮助学习器的系综技术。


## <a name="next-steps"></a>后续步骤

查看可用于 Azure 机器学习[的模块集](module-reference.md)。 

