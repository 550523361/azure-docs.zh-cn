---
title: 锚定关系和寻路
description: 了解锚定关系背后的概念模型。 了解如何在空间内连接锚点，并使用"附近"API 来实现方法查找方案。
author: ramonarguelles
manager: vriveras
services: azure-spatial-anchors
ms.author: rgarcia
ms.date: 02/24/2019
ms.topic: conceptual
ms.service: azure-spatial-anchors
ms.openlocfilehash: f2fd8f4b7d03be8822c3ec12e2be589054942ce3
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/27/2020
ms.locfileid: "74270601"
---
# <a name="anchor-relationships-and-way-finding-in-azure-spatial-anchors"></a>在 Azure 空间锚点中锚点关系和道路查找

通过使用锚点关系，您可以在空间中创建连接的锚点，然后提出以下问题：

* 附近有锚吗？
* 他们有多远？

## <a name="examples"></a>示例

在以下情况下，可以使用连接的锚点：

* 工人需要完成一项任务，即访问工业工厂的各个地点。 工厂在每个位置都有空间锚点。 HoloLens 或移动应用程序可帮助引导工作人员从一个位置到下一个位置。 应用首先询问附近的空间锚点，然后引导工作人员到下一个位置。 应用程序直观地显示到下一个位置的一般方向和距离。

* 博物馆在公共展览中创建空间锚。 这些锚组成一个为期一小时的参观博物馆的基本公共展览。 在公共显示屏上，参观者可以在移动设备上打开博物馆的混合现实应用程序。 然后，他们把手机摄像头对准空间，查看旅游中其他公共显示屏的总体方向和距离。 当用户走向公共显示器时，应用会更新一般方向和距离，以帮助引导用户。

## <a name="set-up-way-finding"></a>设置方法查找

使用视线方向和锚点之间的距离来提供指导的应用程序是使用*寻路*。 寻路方式不同于逐圈导航。 在逐圈导航中，用户被引导绕着墙壁、穿过门和在地板之间。 通过寻路，用户会获得有关目标总方向的提示。 但是，空间的推理或知识也可以帮助用户通过结构导航到目标。

要构建寻路体验，请先为体验准备一个空间，并开发用户将与之交互的应用。 这些是概念步骤：

1. **规划空间**：决定空间内哪些位置将成为寻路体验的一部分。 在我们的场景中，工厂主管或博物馆巡查协调员可能会决定在查找体验中包括哪些地点。
2. **连接锚点**：访问所选位置以创建空间锚点。 您可以在最终用户应用的管理模式下或完全在不同的应用中执行此操作。 您将连接每个锚点或将每个锚点与其他锚点连接。 服务维护这些关系。
3. **开始最终用户体验**：用户运行应用以查找锚点，该锚点可以位于任何选定的位置。 您的整体设计应确定用户可以输入体验的位置。
4. **查找附近的锚点**：用户找到锚点后，应用可以请求附近的锚点。 此过程返回设备和这些锚点之间的姿势。
5. **指导用户**：应用程序可以使用姿势到每个锚点，以指导用户的一般方向和距离。 例如，应用中的相机源可能会显示一个图标和箭头，以表示每个潜在目标，如下图所示。
6. **优化指南**：当用户行走时，应用可以定期计算设备和目标锚点之间的新姿势。 应用继续优化帮助用户到达目的地的指导提示。

    ![应用如何显示道路查找指南的示例](./media/meeting-spot.png)

## <a name="connect-anchors"></a>连接锚点

要构建寻路体验，首先需要将锚点放置在所选位置。 在本节中，我们将假定应用的管理员已完成此工作。

### <a name="connect-anchors-in-a-single-session"></a>在单个会话中连接锚点

要连接锚点：

1. 步行到第一个位置，并使用云空间锚会话创建锚点 A。
2. 步行到第二个位置。 基础 MR/AR 平台跟踪移动。
3. 使用相同的云空间锚会话创建锚点 B。 锚点 A 和 B 现已连接。 空间锚点服务维护此关系。
4. 继续其余锚点的过程。

### <a name="connect-anchors-in-multiple-sessions"></a>在多个会话中连接锚点

您可以在多个会话上连接空间锚点。 使用此方法，可以一次创建和连接一些锚点，然后创建和连接更多锚点。

要在多个会话上连接锚点：

1. 该应用程序在一个云空间锚会话中创建一些锚点。
2. 在不同的时间，应用通过使用新的 CloudSpatialAnchorSession 定位这些锚点之一（例如锚点 A）。
3. 步行到新位置。 底层的混合现实或增强现实平台跟踪运动。
4. 使用相同的云空间锚会话创建锚点 C。 锚点 A、B 和 C 现已连接。 空间锚点服务维护此关系。

随着时间的推移，您可以继续此过程，以执行更多锚点和更多会话。

### <a name="verify-anchor-connections"></a>验证锚点连接

应用可以通过为附近的锚点发出查询来验证两个锚点是否连接。 当查询的结果包含目标锚点时，将验证锚点连接。 如果锚点未连接，应用可以尝试再次连接它们。

以下是锚点可能无法连接的一些原因：

* 底层的混合现实或增强现实平台在连接锚点的过程中失去了跟踪。
* 由于在与空间锚点服务通信过程中出现网络错误，无法持久化锚点连接。

### <a name="find-sample-code"></a>查找示例代码

要查找演示如何连接锚点和进行附近查询的示例代码，请参阅[空间锚点示例应用](https://github.com/Azure/azure-spatial-anchors-samples)。
