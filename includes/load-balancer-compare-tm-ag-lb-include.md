## <a name="load-balancer-differences"></a>负载平衡器差异

有不同的选项，将使用 Microsoft Azure 的网络流量分配。 这些选项工作方式彼此，具有不同的功能设置，支持不同的方案。 他们可以每个隔离，在使用或将它们组合。

* **Azure 负载平衡器**工作在传输层 (OSI 网络引用堆栈中的层 4)。 它可在同一 Azure 数据中心中运行的应用程序实例间的流量进行网络级分布。
* **应用程序网关**工作在应用程序层 (第 7 层 OSI 网络引用堆栈中)。 它充当反向代理服务，终止客户端连接，并将请求转发到后端终结点。
* **流量管理器**在 DNS 级别工作。  它使用 DNS 响应来指示最终用户流量到全球分布的终结点。 客户端然后直接连接到这些终结点。

下表总结了每个服务提供的功能：

| 服务 | Azure 负载平衡器 | 应用程序网关 | 流量管理器 |
| --- | --- | --- | --- |
| 技术 |传输级别 (第 4 层) |应用程序级别 (第 7 层) |DNS 级别 |
| 支持的应用程序协议 |Any |HTTP、 HTTPS 和 Websocket |任何 （HTTP 终结点是必需的终结点监视） |
| 终结点 |Azure Vm 和云服务角色实例 |任何 Azure 内部 IP 地址，公共 internet IP 地址，Azure 虚拟机或 Azure 云服务 |Azure Vm、 云服务、 Azure Web Apps 和外部终结点 |
| Vnet 支持 |可以使用这两个 Internet 面向和内部 (Vnet) 应用程序 |可以使用这两个 Internet 面向和内部 (Vnet) 应用程序 |仅支持面向 Internet 的应用程序 |
| 终结点监视 |支持通过探测 |支持通过探测 |支持通过 HTTP/HTTPS GET |

Azure 负载平衡器和应用程序网关路由网络流量到终结点，但它们具有不同的使用方案对哪些流量来处理。 下表可帮助了解两个负载平衡器之间的区别：

| 类型 | Azure 负载平衡器 | 应用程序网关 |
| --- | --- | --- |
| 协议 |UDP/TCP |HTTP、 HTTPS 和 Websocket |
| IP 保留 |支持 |不支持 |
| 负载平衡模式下 |5 tuple(source IP, source port, destination IP, destination port, protocol type) |轮循机制<br>根据 URL 路由 |
| 负载平衡模式 (源 IP / 粘性会话) |2 元组 （源 IP 和目标 IP），3 元组 （源 IP、 目标 IP 和端口）。 可以扩展或缩减根据虚拟机数 |基于 cookie 的相关性<br>根据 URL 路由 |
| 运行状况探测 |默认值： 探测间隔-15 秒。 从轮转列表： 2 的连续失败。 支持用户定义探测 |空闲探测时间间隔 30 秒。 去掉后 5 连续实时通信故障或处于空闲模式单个探测失败。 支持用户定义探测 |
| SSL 卸载 |不支持 |支持 |
| 基于 Url 的路由 | 不支持 | 支持|
| SSL 策略 | 不支持 | 支持|
